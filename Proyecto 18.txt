

################################################################################
üìÅ Carpeta: C:\Users\kevin\OneDrive\Liceo\Escritorio\Prueba\logistica
################################################################################


===== asgi.py =====
"""
ASGI config for logistica project.

It exposes the ASGI callable as a module-level variable named ``application``.

For more information on this file, see
https://docs.djangoproject.com/en/5.2/howto/deployment/asgi/
"""

import os

from django.core.asgi import get_asgi_application

os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'logistica.settings')

application = get_asgi_application()

============================================================


===== settings.py =====
"""
Django settings for logistica project.

Generated by 'django-admin startproject' using Django 4.2.7.

For more information on this file, see
https://docs.djangoproject.com/en/4.2/topics/settings/

For the full list of settings and their values, see
https://docs.djangoproject.com/en/4.2/ref/settings/
"""

import os
from pathlib import Path

BASE_DIR = Path(__file__).resolve().parent.parent

SECRET_KEY = 'django-insecure-14z+1ojycqu+ktjhrlrl))4g8!^@$+y1j_7a0q(o!^0nam&@lj'
DEBUG = True
ALLOWED_HOSTS = ['*']

INSTALLED_APPS = [
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    'rest_framework',
    'corsheaders',
    'transporte',
]

MIDDLEWARE = [
    'django.middleware.security.SecurityMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'corsheaders.middleware.CorsMiddleware',
    'django.middleware.common.CommonMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
    'django.middleware.clickjacking.XFrameOptionsMiddleware',
    'transporte.middleware.PermisosMiddleware', 
]

ROOT_URLCONF = 'logistica.urls'

TEMPLATES = [
    {
        'BACKEND': 'django.template.backends.django.DjangoTemplates',
        'DIRS': [
            BASE_DIR, 'templates',
            ],
        'APP_DIRS': True,
        'OPTIONS': {
            'context_processors': [
                'django.template.context_processors.debug',
                'django.template.context_processors.request',
                'django.contrib.auth.context_processors.auth',
                'django.contrib.messages.context_processors.messages',
            ],
        },
    },
]

WSGI_APPLICATION = 'logistica.wsgi.application'

DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.postgresql',
        'NAME': 'logistica_db',
        'USER': 'postgres',
        'PASSWORD': '123456',
        'HOST': 'localhost',
        'PORT': '5432',
    }
}

AUTH_PASSWORD_VALIDATORS = [
    {
        'NAME': 'django.contrib.auth.password_validation.UserAttributeSimilarityValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.MinimumLengthValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.CommonPasswordValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.NumericPasswordValidator',
    },
]

LANGUAGE_CODE = 'es-cl'
TIME_ZONE = 'America/Santiago'
USE_I18N = True
USE_TZ = True

STATIC_URL = '/static/'
STATICFILES_DIRS = [os.path.join(BASE_DIR, 'static')]

DEFAULT_AUTO_FIELD = 'django.db.models.BigAutoField'

# Configuraci√≥n de autenticaci√≥n
LOGIN_URL = '/login/'
LOGIN_REDIRECT_URL = '/'
LOGOUT_REDIRECT_URL = '/login/'

# Configuraci√≥n b√°sica de REST Framework
REST_FRAMEWORK = {
    'DEFAULT_PERMISSION_CLASSES': [
        'rest_framework.permissions.AllowAny',
    ]
}

# CORS b√°sico
CORS_ALLOW_ALL_ORIGINS = True
============================================================


===== urls.py =====
"""
URL configuration for logistica project.

The `urlpatterns` list routes URLs to views. For more information please see:
    https://docs.djangoproject.com/en/4.2/topics/http/urls/
Examples:
Function views
    1. Add an import:  from my_app import views
    2. Add a URL to urlpatterns:  path('', views.home, name='home')
Class-based views
    1. Add an import:  from other_app.views import Home
    2. Add a URL to urlpatterns:  path('', Home.as_view(), name='home')
Including another URLconf
    1. Import the include() function: from django.urls import include, path
    2. Add a URL to urlpatterns:  path('blog/', include('blog.urls'))
"""
from django.contrib import admin
from django.urls import path, include
from django.conf import settings
from django.conf.urls.static import static

urlpatterns = [
    path('admin/', admin.site.urls),
    path('', include('transporte.urls')),  # Esto incluye todas las URLs de transporte
]

# Solo en desarrollo para servir archivos est√°ticos
if settings.DEBUG:
    urlpatterns += static(settings.STATIC_URL, document_root=settings.STATIC_ROOT)
============================================================


===== wsgi.py =====
"""
WSGI config for logistica project.

It exposes the WSGI callable as a module-level variable named ``application``.

For more information on this file, see
https://docs.djangoproject.com/en/5.2/howto/deployment/wsgi/
"""

import os

from django.core.wsgi import get_wsgi_application

os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'logistica.settings')

application = get_wsgi_application()

============================================================


===== __init__.py =====

============================================================


################################################################################
üìÅ Carpeta: C:\Users\kevin\OneDrive\Liceo\Escritorio\Prueba\transporte
################################################################################


===== admin.py =====
from django.contrib import admin
from .models import *

@admin.register(Ruta)
class RutaAdmin(admin.ModelAdmin):
    list_display = ['id', 'origen', 'destino', 'tipo_transporte', 'distancia_km']
    list_filter = ['tipo_transporte']
    search_fields = ['origen', 'destino']

@admin.register(Vehiculo)
class VehiculoAdmin(admin.ModelAdmin):
    list_display = ['id', 'patente', 'tipo_vehiculo', 'modelo', 'capacidad_kg', 'conductor_asignado', 'activo']
    list_filter = ['tipo_vehiculo', 'activo']
    search_fields = ['patente', 'modelo']

@admin.register(Aeronave)
class AeronaveAdmin(admin.ModelAdmin):
    list_display = ['id', 'matricula', 'tipo_aeronave', 'modelo', 'capacidad_kg', 'piloto_asignado', 'activo']
    list_filter = ['tipo_aeronave', 'activo']
    search_fields = ['matricula', 'modelo']

@admin.register(Conductor)
class ConductorAdmin(admin.ModelAdmin):
    list_display = ['id', 'nombre', 'rut', 'licencia', 'telefono', 'activo']
    list_filter = ['activo']
    search_fields = ['nombre', 'rut', 'licencia']

@admin.register(Piloto)
class PilotoAdmin(admin.ModelAdmin):
    list_display = ['id', 'nombre', 'rut', 'certificacion', 'horas_vuelo', 'activo']
    list_filter = ['activo']
    search_fields = ['nombre', 'rut', 'certificacion']

@admin.register(Cliente)
class ClienteAdmin(admin.ModelAdmin):
    list_display = ['id', 'razon_social', 'rut', 'persona_contacto', 'telefono', 'activo']
    list_filter = ['activo']
    search_fields = ['razon_social', 'rut', 'persona_contacto']

@admin.register(Carga)
class CargaAdmin(admin.ModelAdmin):
    list_display = ['id', 'descripcion', 'tipo_carga', 'peso_kg', 'cliente', 'valor_declarado']
    list_filter = ['tipo_carga']
    search_fields = ['descripcion', 'cliente__razon_social']

@admin.register(Seguro)
class SeguroAdmin(admin.ModelAdmin):
    list_display = ['id', 'numero_poliza', 'tipo_seguro', 'aseguradora', 'cobertura', 'estado', 'vigencia_desde', 'vigencia_hasta']
    list_filter = ['tipo_seguro', 'estado']
    search_fields = ['numero_poliza', 'aseguradora']

@admin.register(Despacho)
class DespachoAdmin(admin.ModelAdmin):
    list_display = ['id', 'ruta', 'estado', 'costo_envio', 'fecha_despacho', 'cliente']
    list_filter = ['estado', 'fecha_despacho']
    search_fields = ['ruta__origen', 'ruta__destino', 'cliente__razon_social']

# Registrar el modelo de perfil de usuario si existe
@admin.register(PerfilUsuario)
class PerfilUsuarioAdmin(admin.ModelAdmin):
    list_display = ['usuario', 'tipo_usuario', 'conductor_nombre', 'piloto_nombre', 'telefono', 'fecha_creacion']
    list_filter = ['tipo_usuario']
    search_fields = ['usuario__username', 'usuario__first_name', 'usuario__last_name']
    
    # ‚úÖ Agregar estos m√©todos para que funcionen en el admin
    def conductor_nombre(self, obj):
        return obj.conductor_asignado.nombre if obj.conductor_asignado else "-"
    conductor_nombre.short_description = 'Conductor'
    
    def piloto_nombre(self, obj):
        return obj.piloto_asignado.nombre if obj.piloto_asignado else "-"
    piloto_nombre.short_description = 'Piloto'
============================================================


===== apps.py =====
from django.apps import AppConfig


class TransporteConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'transporte'
============================================================


===== decorators.py =====
# transporte/decorators.py
from django.http import HttpResponseForbidden
from functools import wraps
from django.shortcuts import redirect
from django.contrib import messages

def admin_required(view_func):
    @wraps(view_func)
    def _wrapped_view(request, *args, **kwargs):
        if request.user.is_authenticated:
            try:
                if hasattr(request.user, 'perfilusuario') and request.user.perfilusuario.tipo_usuario == 'ADMIN':
                    return view_func(request, *args, **kwargs)
            except:
                pass
        messages.error(request, 'Acceso denegado: Se requiere rol de administrador')
        return redirect('dashboard')
    return _wrapped_view

def solo_lectura(view_func):
    @wraps(view_func)
    def _wrapped_view(request, *args, **kwargs):
        if request.user.is_authenticated and request.method in ['POST', 'PUT', 'DELETE']:
            try:
                if hasattr(request.user, 'perfilusuario') and request.user.perfilusuario.tipo_usuario != 'ADMIN':
                    messages.error(request, 'Acceso denegado: Solo lectura permitida')
                    return redirect(request.path)
            except:
                messages.error(request, 'Acceso denegado')
                return redirect('dashboard')
        return view_func(request, *args, **kwargs)
    return _wrapped_view
============================================================


===== middleware.py =====
from django.shortcuts import redirect
from django.contrib import messages

class PermisosMiddleware:
    def __init__(self, get_response):
        self.get_response = get_response

    def __call__(self, request):
        response = self.get_response(request)
        return response

    def process_view(self, request, view_func, view_args, view_kwargs):
        # Solo aplicar a usuarios autenticados
        if not request.user.is_authenticated:
            return None

        # URLs p√∫blicas para todos los usuarios autenticados
        urls_publicas = ['login', 'logout', 'register', 'dashboard']
        
        if request.resolver_match.url_name in urls_publicas:
            return None

        # Obtener el tipo de usuario
        try:
            # Si es superusuario, dar acceso completo
            if request.user.is_superuser:
                return None
                
            # ‚úÖ MANEJO ROBUSTO DE PERFILES - CORREGIDO
            if hasattr(request.user, 'perfilusuario'):
                tipo_usuario = request.user.perfilusuario.tipo_usuario
            else:
                # Si no tiene perfil, crear uno por defecto
                from .models import PerfilUsuario
                PerfilUsuario.objects.create(
                    usuario=request.user,
                    tipo_usuario='CLIENTE'
                )
                tipo_usuario = 'CLIENTE'
        except Exception as e:
            # En caso de cualquier error, usar CLIENTE como predeterminado
            print(f"Error en middleware de permisos: {e}")
            tipo_usuario = 'CLIENTE'

        # ‚úÖ DEFINIR PERMISOS ACTUALIZADOS - CORREGIDOS
        permisos = {
            'ADMIN': [
                'despachos', 'rutas', 'vehiculos', 'aeronaves', 'conductores', 
                'pilotos', 'clientes', 'cargas', 'seguros', 'reportes', 'api',
                'despacho_crear', 'despacho_editar', 'despacho_eliminar',
                'ruta_create', 'ruta_update', 'ruta_delete', 'ruta_list', 'ruta_detail',
                'vehiculo_editar', 'aeronave_editar', 'conductor_editar',
                'piloto_editar', 'cliente_editar', 'carga_editar', 'seguro_editar',
                'aeronave_eliminar', 'generar_reporte_pdf', 'obtener_datos_reporte',
                'gestion_usuarios', 'editar_usuario', 'asignar_conductor_piloto',
                'vehiculo_crear', 'vehiculo_eliminar', 'aeronave_crear',
                'conductor_crear', 'conductor_eliminar', 'piloto_crear',
                'piloto_eliminar', 'cliente_crear', 'cliente_eliminar',
                'carga_crear', 'carga_eliminar', 'seguro_crear', 'seguro_eliminar'
            ],
            'CLIENTE': [
                # ‚úÖ PERMISOS ACTUALIZADOS PARA VER LAS SECCIONES
                'despachos', 'rutas', 'vehiculos', 'aeronaves', 'conductores', 
                'pilotos', 'clientes', 'cargas', 'seguros', 'api',
                'ruta_list', 'ruta_detail', 'despacho_detail'
            ],
            'CONDUCTOR': [
                'despachos', 'vehiculos', 'rutas', 'cargas', 'ruta_list', 'ruta_detail',
                'despacho_detail', 'conductores', 'clientes', 'api'
            ],
            'PILOTO': [
                'despachos', 'aeronaves', 'rutas', 'cargas', 'ruta_list', 'ruta_detail',
                'despacho_detail', 'pilotos', 'clientes', 'api'
            ]
        }

        url_actual = request.resolver_match.url_name
        
        # Verificar si la URL actual est√° permitida para este usuario
        if url_actual not in permisos.get(tipo_usuario, []):
            messages.error(request, '‚ùå No tiene permiso para acceder a esta funci√≥n')
            return redirect('dashboard')

        return None
============================================================


===== models.py =====
from django.db import models
from django.core.validators import MinValueValidator
from django.contrib.auth.models import User

class TipoTransporte(models.TextChoices):
    TERRESTRE = 'TERRESTRE', 'Terrestre'
    AEREO = 'AEREO', 'A√©reo'

class EstadoDespacho(models.TextChoices):
    PENDIENTE = 'PENDIENTE', 'Pendiente'
    EN_RUTA = 'EN_RUTA', 'En Ruta'
    ENTREGADO = 'ENTREGADO', 'Entregado'
    CANCELADO = 'CANCELADO', 'Cancelado'

class Ruta(models.Model):
    origen = models.CharField(max_length=100)
    destino = models.CharField(max_length=100)
    tipo_transporte = models.CharField(max_length=10, choices=TipoTransporte.choices)
    distancia_km = models.FloatField(validators=[MinValueValidator(0)])
    
    def __str__(self):
        return f"{self.origen} - {self.destino}"

class Vehiculo(models.Model):
    patente = models.CharField(max_length=10, unique=True)
    tipo_vehiculo = models.CharField(max_length=50)
    modelo = models.CharField(max_length=50)
    capacidad_kg = models.IntegerField(validators=[MinValueValidator(0)])
    a√±o = models.IntegerField()
    conductor_asignado = models.ForeignKey('Conductor', on_delete=models.SET_NULL, null=True, blank=True)
    activo = models.BooleanField(default=True)
    
    def __str__(self):
        return f"{self.patente} - {self.modelo}"

class Aeronave(models.Model):
    matricula = models.CharField(max_length=10, unique=True)
    tipo_aeronave = models.CharField(max_length=50)
    modelo = models.CharField(max_length=50)
    capacidad_kg = models.IntegerField(validators=[MinValueValidator(0)])
    piloto_asignado = models.ForeignKey('Piloto', on_delete=models.SET_NULL, null=True, blank=True)
    activo = models.BooleanField(default=True)
    
    def __str__(self):
        return f"{self.matricula} - {self.modelo}"

class Conductor(models.Model):
    nombre = models.CharField(max_length=100)
    rut = models.CharField(max_length=12, unique=True)
    licencia = models.CharField(max_length=10)
    telefono = models.CharField(max_length=15)
    email = models.EmailField()
    activo = models.BooleanField(default=True)
    
    def __str__(self):
        return f"{self.nombre} ({self.licencia})"

class Piloto(models.Model):
    nombre = models.CharField(max_length=100)
    rut = models.CharField(max_length=12, unique=True)
    certificacion = models.CharField(max_length=20)
    telefono = models.CharField(max_length=15)
    email = models.EmailField()
    horas_vuelo = models.IntegerField(default=0)
    activo = models.BooleanField(default=True)
    
    def __str__(self):
        return f"{self.nombre} ({self.certificacion})"

class Cliente(models.Model):
    TIPO_CLIENTE_CHOICES = [
        ('EMPRESA', 'Empresa'),
        ('INDIVIDUAL', 'Individual'),
    ]
    
    tipo_cliente = models.CharField(max_length=10, choices=TIPO_CLIENTE_CHOICES, default='EMPRESA')
    razon_social = models.CharField(max_length=200, blank=True, null=True)
    nombre = models.CharField(max_length=100, blank=True, null=True)
    apellido = models.CharField(max_length=100, blank=True, null=True)
    rut = models.CharField(max_length=12, unique=True)
    persona_contacto = models.CharField(max_length=100)
    telefono = models.CharField(max_length=15)
    email = models.EmailField()
    direccion = models.TextField()
    activo = models.BooleanField(default=True)
    
    def __str__(self):
        if self.tipo_cliente == 'EMPRESA':
            return self.razon_social
        else:
            return f"{self.nombre} {self.apellido}"

class Carga(models.Model):
    descripcion = models.CharField(max_length=200)
    tipo_carga = models.CharField(max_length=50)
    peso_kg = models.FloatField(validators=[MinValueValidator(0)])
    volumen_m3 = models.FloatField(validators=[MinValueValidator(0)])
    valor_declarado = models.DecimalField(max_digits=12, decimal_places=2)
    cliente = models.ForeignKey(Cliente, on_delete=models.CASCADE)
    notas_especiales = models.TextField(blank=True)
    
    def __str__(self):
        return f"{self.descripcion} - {self.cliente}"

class Seguro(models.Model):
    numero_poliza = models.CharField(max_length=50, unique=True)
    tipo_seguro = models.CharField(max_length=50)
    vehiculo = models.ForeignKey(Vehiculo, on_delete=models.CASCADE, null=True, blank=True)
    aeronave = models.ForeignKey(Aeronave, on_delete=models.CASCADE, null=True, blank=True)
    aseguradora = models.CharField(max_length=100)
    cobertura = models.DecimalField(max_digits=12, decimal_places=2)
    vigencia_desde = models.DateField()
    vigencia_hasta = models.DateField()
    estado = models.CharField(max_length=20)
    
    def __str__(self):
        return f"{self.numero_poliza} - {self.aseguradora}"

class Despacho(models.Model):
    fecha_despacho = models.DateTimeField(auto_now_add=True)
    estado = models.CharField(max_length=10, choices=EstadoDespacho.choices, default=EstadoDespacho.PENDIENTE)
    costo_envio = models.DecimalField(max_digits=10, decimal_places=2)
    ruta = models.ForeignKey(Ruta, on_delete=models.CASCADE)
    vehiculo = models.ForeignKey(Vehiculo, on_delete=models.SET_NULL, null=True, blank=True)
    aeronave = models.ForeignKey(Aeronave, on_delete=models.SET_NULL, null=True, blank=True)
    conductor = models.ForeignKey(Conductor, on_delete=models.SET_NULL, null=True, blank=True)
    piloto = models.ForeignKey(Piloto, on_delete=models.SET_NULL, null=True, blank=True)
    carga = models.ForeignKey(Carga, on_delete=models.CASCADE)
    cliente = models.ForeignKey(Cliente, on_delete=models.CASCADE)
    
    def __str__(self):
        return f"Despacho {self.id} - {self.ruta}"

# Modelo adicional para extender el usuario de Django (OPCIONAL)
class TipoUsuario(models.TextChoices):
    ADMIN = 'ADMIN', 'Administrador'
    CLIENTE = 'CLIENTE', 'Cliente'
    CONDUCTOR = 'CONDUCTOR', 'Conductor'
    PILOTO = 'PILOTO', 'Piloto'

class PerfilUsuario(models.Model):
    usuario = models.OneToOneField(User, on_delete=models.CASCADE)
    telefono = models.CharField(max_length=15, blank=True)
    departamento = models.CharField(max_length=50, blank=True)
    tipo_usuario = models.CharField(
        max_length=10, 
        choices=TipoUsuario.choices, 
        default=TipoUsuario.CLIENTE
    )
    
    # ‚úÖ CAMPOS PARA ASIGNACI√ìN
    conductor_asignado = models.OneToOneField(
        'Conductor', 
        on_delete=models.SET_NULL, 
        null=True, 
        blank=True,
        related_name='perfil_usuario'
    )
    piloto_asignado = models.OneToOneField(
        'Piloto', 
        on_delete=models.SET_NULL, 
        null=True, 
        blank=True,
        related_name='perfil_usuario'
    )
    
    fecha_creacion = models.DateTimeField(auto_now_add=True)
    
    def __str__(self):
        return f"Perfil de {self.usuario.username} ({self.tipo_usuario})"
    
    # ‚úÖ M√âTODO PARA MOSTRAR NOMBRE DEL CONDUCTOR EN ADMIN
    def conductor_nombre(self):
        return self.conductor_asignado.nombre if self.conductor_asignado else "-"
    conductor_nombre.short_description = 'Conductor'
    
    # ‚úÖ M√âTODO PARA MOSTRAR NOMBRE DEL PILOTO EN ADMIN
    def piloto_nombre(self):
        return self.piloto_asignado.nombre if self.piloto_asignado else "-"
    piloto_nombre.short_description = 'Piloto'


============================================================


===== serializers.py =====
from rest_framework import serializers
from .models import *

class RutaSerializer(serializers.ModelSerializer):
    class Meta:
        model = Ruta
        fields = '__all__'

class VehiculoSerializer(serializers.ModelSerializer):
    class Meta:
        model = Vehiculo
        fields = '__all__'

class AeronaveSerializer(serializers.ModelSerializer):
    class Meta:
        model = Aeronave
        fields = '__all__'

class ConductorSerializer(serializers.ModelSerializer):
    class Meta:
        model = Conductor
        fields = '__all__'

class PilotoSerializer(serializers.ModelSerializer):
    class Meta:
        model = Piloto
        fields = '__all__'

class ClienteSerializer(serializers.ModelSerializer):
    class Meta:
        model = Cliente
        fields = '__all__'

class CargaSerializer(serializers.ModelSerializer):
    class Meta:
        model = Carga
        fields = '__all__'

class SeguroSerializer(serializers.ModelSerializer):
    class Meta:
        model = Seguro
        fields = '__all__'

class DespachoSerializer(serializers.ModelSerializer):
    class Meta:
        model = Despacho
        fields = '__all__'
============================================================


===== tests.py =====
from django.test import TestCase

# Create your tests here.

============================================================


===== urls.py =====
from django.urls import path, include
from rest_framework.routers import DefaultRouter
from . import views
from .views import (
    RutaListView, RutaDetailView, RutaCreateView, RutaUpdateView, RutaDeleteView,
)
from .decorators import admin_required, solo_lectura  
from .views import (
    api_rutas_list, api_vehiculos_list, api_aeronaves_list, 
    api_conductores_list, api_pilotos_list, api_clientes_list,
    api_cargas_list, api_seguros_list, api_despachos_list
)

router = DefaultRouter()
router.register(r'rutas', views.RutaViewSet)
router.register(r'vehiculos', views.VehiculoViewSet)
router.register(r'aeronaves', views.AeronaveViewSet)
router.register(r'conductores', views.ConductorViewSet)
router.register(r'pilotos', views.PilotoViewSet)
router.register(r'clientes', views.ClienteViewSet)
router.register(r'cargas', views.CargaViewSet)
router.register(r'seguros', views.SeguroViewSet)
router.register(r'despachos', views.DespachoViewSet)

urlpatterns = [
    # URLs de autenticaci√≥n
    path('login/', views.login_view, name='login'),
    path('register/', views.register_view, name='register'),
    path('logout/', views.logout_view, name='logout'),
    
    # API URLs
    path('api/', include(router.urls)),
    
    # ‚úÖ NUEVAS URLs API ESPEC√çFICAS
    path('api/v1/rutas/', api_rutas_list, name='api_rutas_list'),
    path('api/v1/vehiculos/', api_vehiculos_list, name='api_vehiculos_list'),
    path('api/v1/aeronaves/', api_aeronaves_list, name='api_aeronaves_list'),
    path('api/v1/conductores/', api_conductores_list, name='api_conductores_list'),
    path('api/v1/pilotos/', api_pilotos_list, name='api_pilotos_list'),
    path('api/v1/clientes/', api_clientes_list, name='api_clientes_list'),
    path('api/v1/cargas/', api_cargas_list, name='api_cargas_list'),
    path('api/v1/seguros/', api_seguros_list, name='api_seguros_list'),
    path('api/v1/despachos/', api_despachos_list, name='api_despachos_list'),
    
    # Template URLs - Vistas principales
    path('', views.dashboard, name='dashboard'),
    path('despachos/', solo_lectura(views.despachos_view), name='despachos'),
    path('rutas/', solo_lectura(views.rutas_view), name='rutas'),
    path('vehiculos/', solo_lectura(views.vehiculos_view), name='vehiculos'),
    path('aeronaves/', solo_lectura(views.aeronaves_view), name='aeronaves'),
    path('conductores/', solo_lectura(views.conductores_view), name='conductores'),
    path('pilotos/', solo_lectura(views.pilotos_view), name='pilotos'),
    path('clientes/', solo_lectura(views.clientes_view), name='clientes'),
    path('cargas/', solo_lectura(views.cargas_view), name='cargas'),
    path('seguros/', solo_lectura(views.seguros_view), name='seguros'),
    path('reportes/', admin_required(views.reportes_view), name='reportes'),
    path('api-docs/', solo_lectura(views.api_view), name='api'),
    
    # URLs para CRUD de Rutas (solo admin)
    path('rutas/lista/', solo_lectura(RutaListView.as_view()), name='ruta_list'),
    path('rutas/<int:pk>/', solo_lectura(RutaDetailView.as_view()), name='ruta_detail'),
    path('rutas/nueva/', admin_required(RutaCreateView.as_view()), name='ruta_create'),
    path('rutas/<int:pk>/editar/', admin_required(RutaUpdateView.as_view()), name='ruta_update'),
    path('rutas/<int:pk>/eliminar/', admin_required(RutaDeleteView.as_view()), name='ruta_delete'),
    
    # URLs para funcionalidades espec√≠ficas (solo admin para crear/editar/eliminar)
    path('despachos/crear/', admin_required(views.crear_despacho), name='despacho_crear'),
    path('despachos/<int:pk>/editar/', admin_required(views.editar_despacho), name='despacho_editar'),
    path('despachos/<int:pk>/', solo_lectura(views.despacho_detail), name='despacho_detail'),
    path('despachos/<int:pk>/eliminar/', admin_required(views.eliminar_despacho), name='despacho_eliminar'),
    
    # URLs para gesti√≥n de usuarios (solo admin)
    path('usuarios/', admin_required(views.gestion_usuarios), name='gestion_usuarios'),
    path('usuarios/<int:user_id>/editar/', admin_required(views.editar_usuario), name='editar_usuario'),
    path('usuarios/<int:user_id>/asignar/', admin_required(views.asignar_conductor_piloto), name='asignar_conductor_piloto'),
    
    # PDF (solo admin)
    path('reportes/generar-pdf/', admin_required(views.generar_reporte_pdf), name='generar_reporte_pdf'),
    path('api/reportes/datos/', admin_required(views.obtener_datos_reporte), name='obtener_datos_reporte'),
    
    # URLs de edici√≥n (solo admin)
    path('vehiculos/<int:pk>/editar/', admin_required(views.editar_vehiculo), name='vehiculo_editar'),
    path('vehiculos/crear/', admin_required(views.crear_vehiculo), name='vehiculo_crear'),
    path('vehiculos/<int:pk>/eliminar/', admin_required(views.eliminar_vehiculo), name='vehiculo_eliminar'),
    
    path('aeronaves/<int:pk>/editar/', admin_required(views.editar_aeronave), name='aeronave_editar'),
    path('aeronaves/crear/', admin_required(views.crear_aeronave), name='aeronave_crear'),
    path('aeronaves/<int:pk>/eliminar/', admin_required(views.eliminar_aeronave), name='aeronave_eliminar'),
    
    path('conductores/<int:pk>/editar/', admin_required(views.editar_conductor), name='conductor_editar'),
    path('conductores/crear/', admin_required(views.crear_conductor), name='conductor_crear'),
    path('conductores/<int:pk>/eliminar/', admin_required(views.eliminar_conductor), name='conductor_eliminar'),
    
    path('pilotos/<int:pk>/editar/', admin_required(views.editar_piloto), name='piloto_editar'),
    path('pilotos/crear/', admin_required(views.crear_piloto), name='piloto_crear'),
    path('pilotos/<int:pk>/eliminar/', admin_required(views.eliminar_piloto), name='piloto_eliminar'),
    
    path('clientes/<int:pk>/editar/', admin_required(views.editar_cliente), name='cliente_editar'),
    path('clientes/crear/', admin_required(views.crear_cliente), name='cliente_crear'),
    path('clientes/<int:pk>/eliminar/', admin_required(views.eliminar_cliente), name='cliente_eliminar'),
    
    path('cargas/<int:pk>/editar/', admin_required(views.editar_carga), name='carga_editar'),
    path('cargas/crear/', admin_required(views.crear_carga), name='carga_crear'),
    path('cargas/<int:pk>/eliminar/', admin_required(views.eliminar_carga), name='carga_eliminar'),
    
    path('seguros/<int:pk>/editar/', admin_required(views.editar_seguro), name='seguro_editar'),
    path('seguros/crear/', admin_required(views.crear_seguro), name='seguro_crear'),
    path('seguros/<int:pk>/eliminar/', admin_required(views.eliminar_seguro), name='seguro_eliminar'),
]
============================================================


===== views.py =====
from django.shortcuts import render, get_object_or_404, redirect
from django.views.generic import ListView, DetailView, CreateView, UpdateView, DeleteView
from django.urls import reverse_lazy
from django.contrib.auth.mixins import LoginRequiredMixin
from rest_framework import viewsets
from .models import *
from .serializers import *
from django.shortcuts import render, redirect
from django.contrib.auth import authenticate, login, logout
from django.contrib.auth.forms import UserCreationForm
from django.contrib.auth.models import User
from django.contrib import messages
from django.contrib.auth.decorators import login_required
from django.db.models import Count, Sum, Q
from django.utils import timezone
from datetime import timedelta
from django.http import HttpResponse
from reportlab.pdfgen import canvas
from reportlab.lib.pagesizes import letter
from reportlab.lib.styles import getSampleStyleSheet, ParagraphStyle
from reportlab.platypus import SimpleDocTemplate, Table, TableStyle, Paragraph, Spacer
from reportlab.lib import colors
from datetime import datetime
import io
from django.http import JsonResponse
import json
from .decorators import admin_required, solo_lectura
from functools import wraps
from rest_framework import permissions

class PublicReadOnly(permissions.BasePermission):
    """Permite acceso de solo lectura a todos los usuarios, incluidos no autenticados"""
    def has_permission(self, request, view):
        if request.method in permissions.SAFE_METHODS:  # GET, HEAD, OPTIONS
            return True
        return request.user and request.user.is_authenticated

# Vistas para API - ACTUALIZAR CON PERMISOS
class RutaViewSet(viewsets.ModelViewSet):
    queryset = Ruta.objects.all()
    serializer_class = RutaSerializer
    permission_classes = [PublicReadOnly]  # ‚úÖ Permite lectura p√∫blica

class VehiculoViewSet(viewsets.ModelViewSet):
    queryset = Vehiculo.objects.all()
    serializer_class = VehiculoSerializer
    permission_classes = [PublicReadOnly]  # ‚úÖ Permite lectura p√∫blica

class AeronaveViewSet(viewsets.ModelViewSet):
    queryset = Aeronave.objects.all()
    serializer_class = AeronaveSerializer
    permission_classes = [PublicReadOnly]  # ‚úÖ Permite lectura p√∫blica

class ConductorViewSet(viewsets.ModelViewSet):
    queryset = Conductor.objects.all()
    serializer_class = ConductorSerializer
    permission_classes = [PublicReadOnly]  # ‚úÖ Permite lectura p√∫blica

class PilotoViewSet(viewsets.ModelViewSet):
    queryset = Piloto.objects.all()
    serializer_class = PilotoSerializer
    permission_classes = [PublicReadOnly]  # ‚úÖ Permite lectura p√∫blica

class ClienteViewSet(viewsets.ModelViewSet):
    queryset = Cliente.objects.all()
    serializer_class = ClienteSerializer
    permission_classes = [PublicReadOnly]  # ‚úÖ Permite lectura p√∫blica

class CargaViewSet(viewsets.ModelViewSet):
    queryset = Carga.objects.all()
    serializer_class = CargaSerializer
    permission_classes = [PublicReadOnly]  # ‚úÖ Permite lectura p√∫blica

class SeguroViewSet(viewsets.ModelViewSet):
    queryset = Seguro.objects.all()
    serializer_class = SeguroSerializer
    permission_classes = [PublicReadOnly]  # ‚úÖ Permite lectura p√∫blica

class DespachoViewSet(viewsets.ModelViewSet):
    queryset = Despacho.objects.all()
    serializer_class = DespachoSerializer
    permission_classes = [PublicReadOnly]  # ‚úÖ Permite lectura p√∫blica

# Vistas basadas en clases para templates HTML
class RutaListView(LoginRequiredMixin, ListView):
    model = Ruta
    template_name = 'transporte/rutas.html'
    context_object_name = 'rutas'

class RutaDetailView(LoginRequiredMixin, DetailView):
    model = Ruta
    template_name = 'transporte/ruta_detail.html'

class RutaCreateView(LoginRequiredMixin, CreateView):
    model = Ruta
    template_name = 'transporte/ruta_form.html'
    fields = ['origen', 'destino', 'tipo_transporte', 'distancia_km']
    success_url = reverse_lazy('rutas')

class RutaUpdateView(LoginRequiredMixin, UpdateView):
    model = Ruta
    template_name = 'transporte/ruta_form.html'
    fields = ['origen', 'destino', 'tipo_transporte', 'distancia_km']
    success_url = reverse_lazy('rutas')

class RutaDeleteView(LoginRequiredMixin, DeleteView):
    model = Ruta
    template_name = 'transporte/ruta_confirm_delete.html'
    success_url = reverse_lazy('rutas')

@login_required
def generar_reporte_pdf(request):
    """Genera un reporte en PDF con datos reales de la base de datos"""
    
    # Crear el buffer para el PDF
    buffer = io.BytesIO()
    
    # Crear el documento PDF
    doc = SimpleDocTemplate(buffer, pagesize=letter)
    elements = []
    
    # Obtener estilos
    styles = getSampleStyleSheet()
    
    # Estilo personalizado para el t√≠tulo
    title_style = ParagraphStyle(
        'CustomTitle',
        parent=styles['Heading1'],
        fontSize=16,
        spaceAfter=30,
        textColor=colors.HexColor('#6366f1'),
        alignment=1  # Centrado
    )
    
    # Informaci√≥n del usuario que genera el reporte
    usuario = request.user
    fecha_generacion = datetime.now().strftime("%d/%m/%Y %H:%M")
    
    # T√≠tulo del reporte
    elements.append(Paragraph("REPORTE DE LOG√çSTICA GLOBAL", title_style))
    elements.append(Spacer(1, 20))
    
    # Informaci√≥n del generador
    info_style = ParagraphStyle(
        'InfoStyle',
        parent=styles['Normal'],
        fontSize=10,
        textColor=colors.gray
    )
    
    elements.append(Paragraph(f"<b>Generado por:</b> {usuario.get_full_name() or usuario.username}", info_style))
    elements.append(Paragraph(f"<b>Fecha de generaci√≥n:</b> {fecha_generacion}", info_style))
    elements.append(Spacer(1, 30))
    
    # OBTENER DATOS REALES DE LA BASE DE DATOS
    
    # 1. Estad√≠sticas generales
    total_despachos = Despacho.objects.count()
    despachos_pendientes = Despacho.objects.filter(estado='PENDIENTE').count()
    despachos_en_ruta = Despacho.objects.filter(estado='EN_RUTA').count()
    despachos_entregados = Despacho.objects.filter(estado='ENTREGADO').count()
    
    total_vehiculos = Vehiculo.objects.filter(activo=True).count()
    total_aeronaves = Aeronave.objects.filter(activo=True).count()
    total_clientes = Cliente.objects.filter(activo=True).count()
    
    # 2. √öltimos despachos
    ultimos_despachos = Despacho.objects.all().order_by('-fecha_despacho')[:10]
    
    # 3. Cargas por tipo
    cargas_por_tipo = Carga.objects.values('tipo_carga').annotate(total=Count('id'))
    
    # SECCI√ìN 1: ESTAD√çSTICAS GENERALES
    elements.append(Paragraph("ESTAD√çSTICAS GENERALES", styles['Heading2']))
    elements.append(Spacer(1, 15))
    
    # Tabla de estad√≠sticas
    stats_data = [
        ['M√âTRICA', 'VALOR'],
        ['Total Despachos', str(total_despachos)],
        ['Despachos Pendientes', str(despachos_pendientes)],
        ['Despachos en Ruta', str(despachos_en_ruta)],
        ['Despachos Entregados', str(despachos_entregados)],
        ['Veh√≠culos Activos', str(total_vehiculos)],
        ['Aeronaves Activas', str(total_aeronaves)],
        ['Clientes Activos', str(total_clientes)]
    ]
    
    stats_table = Table(stats_data, colWidths=[250, 100])
    stats_table.setStyle(TableStyle([
        ('BACKGROUND', (0, 0), (-1, 0), colors.HexColor('#6366f1')),
        ('TEXTCOLOR', (0, 0), (-1, 0), colors.whitesmoke),
        ('ALIGN', (0, 0), (-1, -1), 'LEFT'),
        ('FONTNAME', (0, 0), (-1, 0), 'Helvetica-Bold'),
        ('FONTSIZE', (0, 0), (-1, 0), 12),
        ('BOTTOMPADDING', (0, 0), (-1, 0), 12),
        ('BACKGROUND', (0, 1), (-1, -1), colors.HexColor('#f8fafc')),
        ('GRID', (0, 0), (-1, -1), 1, colors.gray)
    ]))
    
    elements.append(stats_table)
    elements.append(Spacer(1, 30))
    
    # SECCI√ìN 2: √öLTIMOS DESPACHOS
    elements.append(Paragraph("√öLTIMOS DESPACHOS", styles['Heading2']))
    elements.append(Spacer(1, 15))
    
    if ultimos_despachos:
        despachos_data = [['ID', 'Cliente', 'Ruta', 'Estado', 'Fecha']]
        
        for despacho in ultimos_despachos:
            despachos_data.append([
                str(despacho.id),
                despacho.cliente.razon_social[:20] + '...' if len(despacho.cliente.razon_social) > 20 else despacho.cliente.razon_social,
                f"{despacho.ruta.origen} - {despacho.ruta.destino}",
                despacho.estado,
                despacho.fecha_despacho.strftime("%d/%m/%Y")
            ])
        
        despachos_table = Table(despachos_data, colWidths=[50, 120, 150, 80, 80])
        despachos_table.setStyle(TableStyle([
            ('BACKGROUND', (0, 0), (-1, 0), colors.HexColor('#06b6d4')),
            ('TEXTCOLOR', (0, 0), (-1, 0), colors.whitesmoke),
            ('ALIGN', (0, 0), (-1, -1), 'LEFT'),
            ('FONTNAME', (0, 0), (-1, 0), 'Helvetica-Bold'),
            ('FONTSIZE', (0, 0), (-1, 0), 10),
            ('BACKGROUND', (0, 1), (-1, -1), colors.HexColor('#f8fafc')),
            ('GRID', (0, 0), (-1, -1), 1, colors.gray),
            ('FONTSIZE', (0, 1), (-1, -1), 8)
        ]))
        
        elements.append(despachos_table)
    else:
        elements.append(Paragraph("No hay despachos registrados.", styles['Normal']))
    
    elements.append(Spacer(1, 30))
    
    # SECCI√ìN 3: CARGAS POR TIPO
    elements.append(Paragraph("DISTRIBUCI√ìN DE CARGAS POR TIPO", styles['Heading2']))
    elements.append(Spacer(1, 15))
    
    if cargas_por_tipo:
        cargas_data = [['Tipo de Carga', 'Cantidad']]
        
        for carga_tipo in cargas_por_tipo:
            cargas_data.append([
                carga_tipo['tipo_carga'],
                str(carga_tipo['total'])
            ])
        
        cargas_table = Table(cargas_data, colWidths=[300, 100])
        cargas_table.setStyle(TableStyle([
            ('BACKGROUND', (0, 0), (-1, 0), colors.HexColor('#10b981')),
            ('TEXTCOLOR', (0, 0), (-1, 0), colors.whitesmoke),
            ('ALIGN', (0, 0), (-1, -1), 'LEFT'),
            ('FONTNAME', (0, 0), (-1, 0), 'Helvetica-Bold'),
            ('BACKGROUND', (0, 1), (-1, -1), colors.HexColor('#f8fafc')),
            ('GRID', (0, 0), (-1, -1), 1, colors.gray)
        ]))
        
        elements.append(cargas_table)
    else:
        elements.append(Paragraph("No hay cargas registradas.", styles['Normal']))
    
    # Pie de p√°gina
    elements.append(Spacer(1, 50))
    elements.append(Paragraph(
        f"<i>Reporte generado autom√°ticamente por el Sistema de Gesti√≥n de Transporte - {fecha_generacion}</i>", 
        info_style
    ))
    
    # Construir el PDF
    doc.build(elements)
    
    # Obtener el valor del buffer
    pdf = buffer.getvalue()
    buffer.close()
    
    # Crear la respuesta HTTP
    response = HttpResponse(content_type='application/pdf')
    response['Content-Disposition'] = 'attachment; filename="reporte_logistica.pdf"'
    response.write(pdf)
    
    return response

# Vistas de autenticaci√≥n
def login_view(request):
    if request.method == 'POST':
        username = request.POST.get('username')
        password = request.POST.get('password')
        user = authenticate(request, username=username, password=password)
        
        if user is not None:
            login(request, user)
            messages.success(request, f'¬°Bienvenido {user.username}!')
            return redirect('dashboard')
        else:
            messages.error(request, 'Usuario o contrase√±a incorrectos')
    
    return render(request, 'transporte/login.html')

@login_required
def obtener_datos_reporte(request):
    """Vista para obtener datos reales de la base de datos para reportes"""
    report_type = request.GET.get('type', 'despachos')
    
    try:
        if report_type == 'despachos':
            # Datos reales de despachos
            despachos = Despacho.objects.select_related('cliente', 'ruta').all().order_by('-fecha_despacho')[:50]
            data = []
            for despacho in despachos:
                data.append({
                    'id': f"DESP-{despacho.id}",
                    'cliente': despacho.cliente.razon_social,
                    'fecha': despacho.fecha_despacho.strftime("%Y-%m-%d"),
                    'estado': despacho.estado,
                    'valor': float(despacho.costo_envio) if despacho.costo_envio else 0,
                    'destino': f"{despacho.ruta.origen} - {despacho.ruta.destino}",
                    'tipo_transporte': despacho.ruta.tipo_transporte
                })
                
        elif report_type == 'financiero':
            # Datos financieros reales
            ingresos = Despacho.objects.aggregate(total=Sum('costo_envio'))['total'] or 0
            total_despachos = Despacho.objects.count()
            promedio_ingresos = ingresos / total_despachos if total_despachos > 0 else 0
            
            data = [
                {'concepto': 'Ingresos por despachos', 'monto': float(ingresos), 'tipo': 'Ingreso'},
                {'concepto': 'Total despachos realizados', 'monto': total_despachos, 'tipo': 'Metrica'},
                {'concepto': 'Ingreso promedio por despacho', 'monto': float(promedio_ingresos), 'tipo': 'Metrica'},
            ]
            
        elif report_type == 'flota':
            # Datos reales de flota
            vehiculos = Vehiculo.objects.filter(activo=True)
            aeronaves = Aeronave.objects.filter(activo=True)
            data = []
            
            for vehiculo in vehiculos:
                data.append({
                    'id': f"VH-{vehiculo.id}",
                    'tipo': 'Veh√≠culo',
                    'modelo': vehiculo.modelo,
                    'estado': 'Activo' if vehiculo.activo else 'Inactivo',
                    'mantenimiento': 'Al d√≠a',  # Puedes agregar campo de mantenimiento al modelo
                    'ubicacion': 'Dep√≥sito Central',
                    'capacidad': f"{vehiculo.capacidad_kg} kg"
                })
                
            for aeronave in aeronaves:
                data.append({
                    'id': f"AV-{aeronave.id}",
                    'tipo': 'Aeronave',
                    'modelo': aeronave.modelo,
                    'estado': 'Activo' if aeronave.activo else 'Inactivo',
                    'mantenimiento': 'Al d√≠a',
                    'ubicacion': 'Aeropuerto',
                    'capacidad': f"{aeronave.capacidad_kg} kg"
                })
                
        elif report_type == 'clientes':
            # Datos reales de clientes
            clientes = Cliente.objects.filter(activo=True)
            data = []
            for cliente in clientes:
                total_despachos = Despacho.objects.filter(cliente=cliente).count()
                data.append({
                    'id': f"CLI-{cliente.id}",
                    'nombre': cliente.razon_social,
                    'contacto': cliente.persona_contacto,
                    'telefono': cliente.telefono,
                    'email': cliente.email,
                    'volumen': total_despachos,
                    'direccion': cliente.direccion[:50] + '...' if len(cliente.direccion) > 50 else cliente.direccion
                })
                
        elif report_type == 'seguros':
            # Datos reales de seguros
            seguros = Seguro.objects.all()
            data = []
            for seguro in seguros:
                data.append({
                    'poliza': seguro.numero_poliza,
                    'tipo': seguro.tipo_seguro,
                    'aseguradora': seguro.aseguradora,
                    'vencimiento': seguro.vigencia_hasta.strftime("%Y-%m-%d"),
                    'cobertura': float(seguro.cobertura) if seguro.cobertura else 0,
                    'estado': seguro.estado
                })
                
        elif report_type == 'personal':
            # Datos reales de personal
            conductores = Conductor.objects.filter(activo=True)
            pilotos = Piloto.objects.filter(activo=True)
            data = []
            
            for conductor in conductores:
                data.append({
                    'id': f"EMP-C-{conductor.id}",
                    'nombre': conductor.nombre,
                    'puesto': 'Conductor',
                    'estado': 'Activo' if conductor.activo else 'Inactivo',
                    'certificaciones': conductor.licencia,
                    'contacto': conductor.telefono
                })
                
            for piloto in pilotos:
                data.append({
                    'id': f"EMP-P-{piloto.id}",
                    'nombre': piloto.nombre,
                    'puesto': 'Piloto',
                    'estado': 'Activo' if piloto.activo else 'Inactivo',
                    'certificaciones': f"{piloto.certificacion} - {piloto.horas_vuelo} horas",
                    'contacto': piloto.telefono
                })
        
        else:
            data = []
            
        return JsonResponse({'success': True, 'data': data})
        
    except Exception as e:
        return JsonResponse({'success': False, 'error': str(e)})

def register_view(request):
    if request.method == 'POST':
        username = request.POST.get('username')
        email = request.POST.get('email')
        password1 = request.POST.get('password1')
        password2 = request.POST.get('password2')
        first_name = request.POST.get('first_name')
        last_name = request.POST.get('last_name')
        tipo_usuario = request.POST.get('tipo_usuario', 'CLIENTE')  # Nuevo campo
        
        # Validaciones
        if password1 != password2:
            messages.error(request, 'Las contrase√±as no coinciden')
            return render(request, 'transporte/login.html')
        
        if User.objects.filter(username=username).exists():
            messages.error(request, 'El nombre de usuario ya existe')
            return render(request, 'transporte/login.html')
        
        if User.objects.filter(email=email).exists():
            messages.error(request, 'El email ya est√° registrado')
            return render(request, 'transporte/login.html')
        
        # Crear usuario
        try:
            user = User.objects.create_user(
                username=username,
                email=email,
                password=password1,
                first_name=first_name,
                last_name=last_name
            )
            user.save()
            
            # ‚úÖ CREAR PERFIL AUTOM√ÅTICAMENTE
            from .models import PerfilUsuario
            PerfilUsuario.objects.create(
                usuario=user,
                tipo_usuario=tipo_usuario,
                telefono=request.POST.get('telefono', ''),
                departamento=request.POST.get('departamento', '')
            )
            
            # Autenticar y loguear al usuario
            user = authenticate(username=username, password=password1)
            if user is not None:
                login(request, user)
                messages.success(request, f'¬°Cuenta creada exitosamente! Bienvenido {user.first_name}')
                return redirect('dashboard')
                
        except Exception as e:
            messages.error(request, f'Error al crear la cuenta: {str(e)}')
    
    return render(request, 'transporte/login.html')

def logout_view(request):
    logout(request)
    messages.success(request, 'Has cerrado sesi√≥n exitosamente')
    return redirect('login')

@login_required
@admin_required
def gestion_usuarios(request):
    """Vista para gestionar usuarios y sus roles"""
    usuarios = User.objects.all().order_by('-date_joined')
    
    # Filtrar por b√∫squeda
    search_query = request.GET.get('search', '')
    if search_query:
        usuarios = usuarios.filter(
            Q(username__icontains=search_query) |
            Q(first_name__icontains=search_query) |
            Q(last_name__icontains=search_query) |
            Q(email__icontains=search_query)
        )
    
    # Obtener perfiles para cada usuario
    usuarios_con_perfiles = []
    for usuario in usuarios:
        try:
            perfil = usuario.perfilusuario
        except:
            # Si no tiene perfil, crear uno por defecto
            perfil = PerfilUsuario.objects.create(
                usuario=usuario,
                tipo_usuario='CLIENTE'
            )
        
        usuarios_con_perfiles.append({
            'usuario': usuario,
            'perfil': perfil
        })
    
    context = {
        'usuarios_con_perfiles': usuarios_con_perfiles,
        'search_query': search_query,
        'tipos_usuario': TipoUsuario.choices,
    }
    return render(request, 'transporte/gestion_usuarios.html', context)

@login_required
@admin_required
def editar_usuario(request, user_id):
    """Vista para editar un usuario"""
    usuario = get_object_or_404(User, id=user_id)
    
    try:
        perfil = usuario.perfilusuario
    except:
        perfil = PerfilUsuario.objects.create(usuario=usuario, tipo_usuario='CLIENTE')
    
    if request.method == 'POST':
        try:
            # Actualizar perfil
            perfil.tipo_usuario = request.POST.get('tipo_usuario')
            perfil.telefono = request.POST.get('telefono', '')
            perfil.departamento = request.POST.get('departamento', '')
            perfil.save()
            
            # Actualizar usuario
            usuario.first_name = request.POST.get('first_name', '')
            usuario.last_name = request.POST.get('last_name', '')
            usuario.email = request.POST.get('email', '')
            usuario.is_active = 'is_active' in request.POST
            usuario.save()
            
            messages.success(request, 'Usuario actualizado exitosamente')
            return redirect('gestion_usuarios')
            
        except Exception as e:
            messages.error(request, f'Error al actualizar el usuario: {str(e)}')
    
    # Obtener conductores y pilotos para asignaci√≥n
    conductores = Conductor.objects.filter(activo=True)
    pilotos = Piloto.objects.filter(activo=True)
    
    context = {
        'usuario_editar': usuario,
        'perfil': perfil,
        'conductores': conductores,
        'pilotos': pilotos,
        'tipos_usuario': TipoUsuario.choices,
    }
    return render(request, 'transporte/editar_usuario.html', context)

@login_required
@admin_required
def asignar_conductor_piloto(request, user_id):
    """Vista para asignar conductor/piloto a un usuario"""
    usuario = get_object_or_404(User, id=user_id)
    
    try:
        perfil = usuario.perfilusuario
    except:
        perfil = PerfilUsuario.objects.create(usuario=usuario, tipo_usuario='CLIENTE')
    
    if request.method == 'POST':
        try:
            conductor_id = request.POST.get('conductor_asignado')
            piloto_id = request.POST.get('piloto_asignado')
            
            if conductor_id:
                perfil.conductor_asignado_id = conductor_id
            else:
                perfil.conductor_asignado = None
                
            if piloto_id:
                perfil.piloto_asignado_id = piloto_id
            else:
                perfil.piloto_asignado = None
                
            perfil.save()
            messages.success(request, 'Asignaciones actualizadas exitosamente')
            
        except Exception as e:
            messages.error(request, f'Error al actualizar asignaciones: {str(e)}')
    
    return redirect('editar_usuario', user_id=user_id)

# Vistas para templates HTML (funciones)
@login_required
def dashboard(request):
    try:
        tipo_usuario = request.user.perfilusuario.tipo_usuario
    except:
        tipo_usuario = 'CLIENTE'

    # Si es ADMIN o SUPERUSUARIO, mostrar dashboard completo
    if tipo_usuario == 'ADMIN' or request.user.is_superuser:
        # Estad√≠sticas reales para el dashboard ADMIN
        total_despachos = Despacho.objects.count()
        despachos_pendientes = Despacho.objects.filter(estado='PENDIENTE').count()
        despachos_en_ruta = Despacho.objects.filter(estado='EN_RUTA').count()
        despachos_entregados = Despacho.objects.filter(estado='ENTREGADO').count()
        total_vehiculos = Vehiculo.objects.filter(activo=True).count()
        total_aeronaves = Aeronave.objects.filter(activo=True).count()
        total_clientes = Cliente.objects.filter(activo=True).count()
        total_conductores = Conductor.objects.filter(activo=True).count()
        total_pilotos = Piloto.objects.filter(activo=True).count()
        
        # √öltimos despachos para las alertas
        ultimos_despachos = Despacho.objects.all().order_by('-fecha_despacho')[:6]
        
        # Seguros recientes
        seguros_recientes = Seguro.objects.all().order_by('-vigencia_hasta')[:3]
        
        # C√°lculo de porcentajes
        total_flota = total_vehiculos + total_aeronaves
        porcentaje_vehiculos_activos = round((total_vehiculos / max(total_vehiculos, 1)) * 100) if total_vehiculos > 0 else 0
        porcentaje_aeronaves_activas = round((total_aeronaves / max(total_aeronaves, 1)) * 100) if total_aeronaves > 0 else 0
        porcentaje_personal_activo = round(((total_conductores + total_pilotos) / max(total_conductores + total_pilotos, 1)) * 100)
        
        # Calcular porcentaje de seguros vigentes
        seguros_vigentes = Seguro.objects.filter(vigencia_hasta__gte=timezone.now().date()).count()
        total_seguros = Seguro.objects.count()
        porcentaje_seguros_vigentes = round((seguros_vigentes / max(total_seguros, 1)) * 100) if total_seguros > 0 else 0
        
        context = {
            # Estad√≠sticas principales
            'total_vehiculos': total_vehiculos,
            'total_aeronaves': total_aeronaves,
            'total_despachos': total_despachos,
            'total_clientes': total_clientes,
            'total_conductores': total_conductores,
            'total_pilotos': total_pilotos,
            
            # Datos para las secciones
            'ultimos_despachos': ultimos_despachos,
            'seguros_recientes': seguros_recientes,
            
            # Porcentajes calculados
            'porcentaje_vehiculos_activos': porcentaje_vehiculos_activos,
            'porcentaje_aeronaves_activas': porcentaje_aeronaves_activas,
            'porcentaje_personal_activo': porcentaje_personal_activo,
            'porcentaje_seguros_vigentes': porcentaje_seguros_vigentes,
            
            'tipo_usuario': tipo_usuario,
            'es_admin': True
        }
        return render(request, 'transporte/dashboard.html', context)
    
    else:
        # DASHBOARD PARA USUARIOS NO-ADMIN (CLIENTE, CONDUCTOR, PILOTO)
        return render(request, 'transporte/dashboard_usuario.html', {
            'tipo_usuario': tipo_usuario,
            'es_admin': False,
            'nombre_usuario': request.user.get_full_name() or request.user.username
        })

@login_required
@admin_required
def crear_despacho(request):
    """Vista para crear un nuevo despacho"""
    if request.method == 'POST':
        try:
            # Obtener datos del formulario
            cliente_id = request.POST.get('cliente')
            ruta_id = request.POST.get('ruta')
            carga_id = request.POST.get('carga')
            costo_envio = request.POST.get('costo_envio')
            estado = request.POST.get('estado')
            vehiculo_id = request.POST.get('vehiculo') or None
            aeronave_id = request.POST.get('aeronave') or None
            conductor_id = request.POST.get('conductor') or None
            piloto_id = request.POST.get('piloto') or None
            
            # Crear el despacho
            despacho = Despacho(
                cliente_id=cliente_id,
                ruta_id=ruta_id,
                carga_id=carga_id,
                costo_envio=costo_envio,
                estado=estado,
                vehiculo_id=vehiculo_id,
                aeronave_id=aeronave_id,
                conductor_id=conductor_id,
                piloto_id=piloto_id
            )
            despacho.save()
            
            messages.success(request, 'Despacho creado exitosamente')
            return redirect('despachos')
            
        except Exception as e:
            messages.error(request, f'Error al crear el despacho: {str(e)}')
    
    # Mostrar formulario para crear despacho
    context = {
        'rutas': Ruta.objects.all(),
        'vehiculos': Vehiculo.objects.filter(activo=True),
        'aeronaves': Aeronave.objects.filter(activo=True),
        'conductores': Conductor.objects.filter(activo=True),
        'pilotos': Piloto.objects.filter(activo=True),
        'cargas': Carga.objects.all(),
        'clientes': Cliente.objects.filter(activo=True),
    }
    return render(request, 'transporte/despacho_form.html', context)

@login_required
def eliminar_aeronave(request, pk):
    """Vista para eliminar una aeronave"""
    aeronave = get_object_or_404(Aeronave, pk=pk)
    
    if request.method == 'POST':
        try:
            aeronave.delete()
            messages.success(request, 'Aeronave eliminada exitosamente')
            
            # Si es una solicitud AJAX, devolver JSON
            if request.headers.get('X-Requested-With') == 'XMLHttpRequest':
                return JsonResponse({'success': True, 'message': 'Aeronave eliminada exitosamente'})
            else:
                return redirect('aeronaves')
                
        except Exception as e:
            error_msg = f'Error al eliminar la aeronave: {str(e)}'
            messages.error(request, error_msg)
            
            # Si es una solicitud AJAX, devolver JSON
            if request.headers.get('X-Requested-With') == 'XMLHttpRequest':
                return JsonResponse({'success': False, 'error': error_msg})
            else:
                return redirect('aeronaves')
    
    # Si es GET, mostrar confirmaci√≥n
    context = {
        'aeronave': aeronave,
    }
    return render(request, 'transporte/aeronave_confirm_delete.html', context)

@login_required
def editar_despacho(request, pk):
    """Vista para editar un despacho existente"""
    despacho = get_object_or_404(Despacho, pk=pk)
    
    if request.method == 'POST':
        # L√≥gica para editar despacho
        messages.success(request, 'Despacho actualizado exitosamente')
        return redirect('despachos')
    else:
        # Mostrar formulario para editar despacho
        context = {
            'despacho': despacho,
            'rutas': Ruta.objects.all(),
            'vehiculos': Vehiculo.objects.filter(activo=True),
            'aeronaves': Aeronave.objects.filter(activo=True),
            'conductores': Conductor.objects.filter(activo=True),
            'pilotos': Piloto.objects.filter(activo=True),
            'cargas': Carga.objects.all(),
            'clientes': Cliente.objects.filter(activo=True),
        }
        return render(request, 'transporte/despacho_form.html', context)

@login_required
def despacho_detail(request, pk):
    """Vista para ver los detalles de un despacho"""
    despacho = get_object_or_404(Despacho, pk=pk)
    context = {
        'despacho': despacho,
    }
    return render(request, 'transporte/despacho_detail.html', context)

@login_required
def eliminar_despacho(request, pk):
    """Vista para eliminar un despacho"""
    despacho = get_object_or_404(Despacho, pk=pk)
    
    if request.method == 'POST':
        despacho.delete()
        messages.success(request, 'Despacho eliminado exitosamente')
        return redirect('despachos')
    
    context = {
        'despacho': despacho,
    }
    return render(request, 'transporte/despacho_confirm_delete.html', context)

@login_required
def despachos_view(request):
    # Obtener par√°metros de filtro
    estado_filter = request.GET.get('estado', '')
    tipo_filter = request.GET.get('tipo', '')
    search_query = request.GET.get('search', '')
    
    # Filtrar despachos
    despachos = Despacho.objects.all().order_by('-fecha_despacho')
    
    if estado_filter:
        despachos = despachos.filter(estado=estado_filter)
    
    if tipo_filter:
        if tipo_filter == 'terrestre':
            despachos = despachos.filter(vehiculo__isnull=False)
        elif tipo_filter == 'aereo':
            despachos = despachos.filter(aeronave__isnull=False)
    
    if search_query:
        despachos = despachos.filter(
            Q(cliente__razon_social__icontains=search_query) |
            Q(ruta__origen__icontains=search_query) |
            Q(ruta__destino__icontains=search_query) |
            Q(carga__descripcion__icontains=search_query)
        )
    
    context = {
        'despachos': despachos,
        'estado_filter': estado_filter,
        'tipo_filter': tipo_filter,
        'search_query': search_query,
        'total_despachos': despachos.count(),
    }
    return render(request, 'transporte/despachos.html', context)

@login_required
def rutas_view(request):
    rutas = Ruta.objects.all()
    return render(request, 'transporte/rutas.html', {'rutas': rutas})

@login_required
@solo_lectura
def vehiculos_view(request):
    """Todos pueden ver, pero solo admin puede editar"""
    vehiculos = Vehiculo.objects.all()
    
    # ‚úÖ SOLUCI√ìN PERMANENTE - Manejo robusto de perfiles
    try:
        # Verificar si existe el perfil
        if hasattr(request.user, 'perfilusuario'):
            solo_lectura_flag = request.user.perfilusuario.tipo_usuario != 'ADMIN'
        else:
            # Si no existe perfil, crear uno autom√°ticamente
            from .models import PerfilUsuario
            PerfilUsuario.objects.create(
                usuario=request.user,
                tipo_usuario='CLIENTE'
            )
            solo_lectura_flag = True
    except Exception as e:
        # En caso de cualquier error, asumir solo lectura
        print(f"Error al acceder al perfil: {e}")
        solo_lectura_flag = True
    
    return render(request, 'transporte/vehiculos.html', {
        'vehiculos': vehiculos,
        'solo_lectura': solo_lectura_flag
    })

@login_required
def aeronaves_view(request):
    aeronaves = Aeronave.objects.all()
    
    # ‚úÖ Manejo robusto de permisos
    try:
        if hasattr(request.user, 'perfilusuario'):
            es_admin = request.user.perfilusuario.tipo_usuario == 'ADMIN'
        else:
            es_admin = False
    except:
        es_admin = False
    
    return render(request, 'transporte/aeronaves.html', {
        'aeronaves': aeronaves,
        'es_admin': es_admin
    })

@login_required
def conductores_view(request):
    conductores = Conductor.objects.all()
    return render(request, 'transporte/conductores.html', {'conductores': conductores})

@login_required
def pilotos_view(request):
    pilotos = Piloto.objects.all()
    return render(request, 'transporte/pilotos.html', {'pilotos': pilotos})

@login_required
def clientes_view(request):
    clientes = Cliente.objects.all()
    return render(request, 'transporte/clientes.html', {'clientes': clientes})

@login_required
def cargas_view(request):
    cargas = Carga.objects.all()
    return render(request, 'transporte/cargas.html', {'cargas': cargas})

@login_required
def seguros_view(request):
    seguros = Seguro.objects.all()
    return render(request, 'transporte/seguros.html', {'seguros': seguros})
@login_required
def api_view(request):
    """Vista para la documentaci√≥n de la API"""
    return render(request, 'transporte/api.html')
@login_required
def reportes_view(request):
    # Datos para reportes
    despachos_por_estado = Despacho.objects.values('estado').annotate(total=Count('id'))
    cargas_por_tipo = Carga.objects.values('tipo_carga').annotate(total=Count('id'))
    ingresos_por_mes = Despacho.objects.extra(
        {'mes': "strftime('%%m', fecha_despacho)"}
    ).values('mes').annotate(total=Sum('costo_envio'))
    
    context = {
        'despachos_por_estado': despachos_por_estado,
        'cargas_por_tipo': cargas_por_tipo,
        'ingresos_por_mes': ingresos_por_mes,
    }
    return render(request, 'transporte/reportes.html', context)

@login_required
def editar_vehiculo(request, pk):
    """Vista para editar un veh√≠culo existente"""
    vehiculo = get_object_or_404(Vehiculo, pk=pk)
    
    if request.method == 'POST':
        try:
            # Actualizar campos del veh√≠culo
            vehiculo.patente = request.POST.get('patente')
            vehiculo.tipo_vehiculo = request.POST.get('tipo_vehiculo')
            vehiculo.modelo = request.POST.get('modelo')
            vehiculo.capacidad_kg = request.POST.get('capacidad_kg')
            vehiculo.a√±o = request.POST.get('a√±o')
            conductor_id = request.POST.get('conductor_asignado')
            vehiculo.conductor_asignado = Conductor.objects.get(pk=conductor_id) if conductor_id else None
            vehiculo.activo = 'activo' in request.POST
            
            vehiculo.save()
            messages.success(request, 'Veh√≠culo actualizado exitosamente')
            return redirect('vehiculos')
            
        except Exception as e:
            messages.error(request, f'Error al actualizar el veh√≠culo: {str(e)}')
    
    context = {
        'vehiculo': vehiculo,
        'conductores': Conductor.objects.filter(activo=True),
    }
    return render(request, 'transporte/vehiculo_editar.html', context)

@login_required
def editar_aeronave(request, pk):
    """Vista para editar una aeronave existente"""
    aeronave = get_object_or_404(Aeronave, pk=pk)
    
    if request.method == 'POST':
        try:
            # Actualizar campos de la aeronave
            aeronave.matricula = request.POST.get('matricula')
            aeronave.tipo_aeronave = request.POST.get('tipo_aeronave')
            aeronave.modelo = request.POST.get('modelo')
            aeronave.capacidad_kg = request.POST.get('capacidad_kg')
            piloto_id = request.POST.get('piloto_asignado')
            aeronave.piloto_asignado = Piloto.objects.get(pk=piloto_id) if piloto_id else None
            aeronave.activo = 'activo' in request.POST
            
            aeronave.save()
            messages.success(request, 'Aeronave actualizada exitosamente')
            return redirect('aeronaves')
            
        except Exception as e:
            messages.error(request, f'Error al actualizar la aeronave: {str(e)}')
    
    context = {
        'aeronave': aeronave,
        'pilotos': Piloto.objects.filter(activo=True),
    }
    return render(request, 'transporte/aeronave_editar.html', context)

@login_required
def editar_conductor(request, pk):
    """Vista para editar un conductor existente"""
    conductor = get_object_or_404(Conductor, pk=pk)
    
    if request.method == 'POST':
        try:
            # Actualizar campos del conductor
            conductor.nombre = request.POST.get('nombre')
            conductor.rut = request.POST.get('rut')
            conductor.licencia = request.POST.get('licencia')
            conductor.telefono = request.POST.get('telefono')
            conductor.email = request.POST.get('email')
            conductor.activo = 'activo' in request.POST
            
            conductor.save()
            messages.success(request, 'Conductor actualizado exitosamente')
            return redirect('conductores')
            
        except Exception as e:
            messages.error(request, f'Error al actualizar el conductor: {str(e)}')
    
    context = {
        'conductor': conductor,
    }
    return render(request, 'transporte/conductor_editar.html', context)

@login_required
def editar_piloto(request, pk):
    """Vista para editar un piloto existente"""
    piloto = get_object_or_404(Piloto, pk=pk)
    
    if request.method == 'POST':
        try:
            # Actualizar campos del piloto
            piloto.nombre = request.POST.get('nombre')
            piloto.rut = request.POST.get('rut')
            piloto.certificacion = request.POST.get('certificacion')
            piloto.telefono = request.POST.get('telefono')
            piloto.email = request.POST.get('email')
            piloto.horas_vuelo = request.POST.get('horas_vuelo', 0)
            piloto.activo = 'activo' in request.POST
            
            piloto.save()
            messages.success(request, 'Piloto actualizado exitosamente')
            return redirect('pilotos')
            
        except Exception as e:
            messages.error(request, f'Error al actualizar el piloto: {str(e)}')
    
    context = {
        'piloto': piloto,
    }
    return render(request, 'transporte/piloto_editar.html', context)

@login_required
def editar_cliente(request, pk):
    """Vista para editar un cliente existente"""
    cliente = get_object_or_404(Cliente, pk=pk)
    
    if request.method == 'POST':
        try:
            # Actualizar campos del cliente
            cliente.tipo_cliente = request.POST.get('tipo_cliente')
            cliente.razon_social = request.POST.get('razon_social')
            cliente.nombre = request.POST.get('nombre')
            cliente.apellido = request.POST.get('apellido')
            cliente.rut = request.POST.get('rut')
            cliente.persona_contacto = request.POST.get('persona_contacto')
            cliente.telefono = request.POST.get('telefono')
            cliente.email = request.POST.get('email')
            cliente.direccion = request.POST.get('direccion')
            cliente.activo = 'activo' in request.POST
            
            cliente.save()
            messages.success(request, 'Cliente actualizado exitosamente')
            return redirect('clientes')
            
        except Exception as e:
            messages.error(request, f'Error al actualizar el cliente: {str(e)}')
    
    context = {
        'cliente': cliente,
    }
    return render(request, 'transporte/cliente_editar.html', context)

@login_required
def editar_carga(request, pk):
    """Vista para editar una carga existente"""
    carga = get_object_or_404(Carga, pk=pk)
    
    if request.method == 'POST':
        try:
            # Actualizar campos de la carga
            carga.descripcion = request.POST.get('descripcion')
            carga.tipo_carga = request.POST.get('tipo_carga')
            carga.peso_kg = request.POST.get('peso_kg')
            carga.volumen_m3 = request.POST.get('volumen_m3')
            carga.valor_declarado = request.POST.get('valor_declarado')
            carga.notas_especiales = request.POST.get('notas_especiales')
            cliente_id = request.POST.get('cliente')
            carga.cliente = Cliente.objects.get(pk=cliente_id) if cliente_id else None
            
            carga.save()
            messages.success(request, 'Carga actualizada exitosamente')
            return redirect('cargas')
            
        except Exception as e:
            messages.error(request, f'Error al actualizar la carga: {str(e)}')
    
    context = {
        'carga': carga,
        'clientes': Cliente.objects.filter(activo=True),
    }
    return render(request, 'transporte/carga_editar.html', context)

@login_required
def editar_seguro(request, pk):
    """Vista para editar un seguro existente"""
    seguro = get_object_or_404(Seguro, pk=pk)
    
    if request.method == 'POST':
        try:
            # Actualizar campos del seguro
            seguro.numero_poliza = request.POST.get('numero_poliza')
            seguro.tipo_seguro = request.POST.get('tipo_seguro')
            seguro.aseguradora = request.POST.get('aseguradora')
            seguro.cobertura = request.POST.get('cobertura')
            seguro.vigencia_desde = request.POST.get('vigencia_desde')
            seguro.vigencia_hasta = request.POST.get('vigencia_hasta')
            seguro.estado = request.POST.get('estado')
            
            # Actualizar veh√≠culo o aeronave
            vehiculo_id = request.POST.get('vehiculo')
            aeronave_id = request.POST.get('aeronave')
            
            seguro.vehiculo = Vehiculo.objects.get(pk=vehiculo_id) if vehiculo_id else None
            seguro.aeronave = Aeronave.objects.get(pk=aeronave_id) if aeronave_id else None
            
            seguro.save()
            messages.success(request, 'Seguro actualizado exitosamente')
            return redirect('seguros')
            
        except Exception as e:
            messages.error(request, f'Error al actualizar el seguro: {str(e)}')
    
    context = {
        'seguro': seguro,
        'vehiculos': Vehiculo.objects.filter(activo=True),
        'aeronaves': Aeronave.objects.filter(activo=True),
    }
    return render(request, 'transporte/seguro_editar.html', context)

# Agrega estas vistas al final de tu views.py

@login_required
@admin_required
def crear_vehiculo(request):
    """Vista para crear un nuevo veh√≠culo"""
    if request.method == 'POST':
        try:
            # Obtener datos del formulario
            patente = request.POST.get('patente')
            tipo_vehiculo = request.POST.get('tipo_vehiculo')
            modelo = request.POST.get('modelo')
            capacidad_kg = request.POST.get('capacidad_kg')
            a√±o = request.POST.get('a√±o')
            conductor_id = request.POST.get('conductor_asignado') or None
            activo = 'activo' in request.POST
            
            # Crear el veh√≠culo
            vehiculo = Vehiculo(
                patente=patente,
                tipo_vehiculo=tipo_vehiculo,
                modelo=modelo,
                capacidad_kg=capacidad_kg,
                a√±o=a√±o,
                conductor_asignado_id=conductor_id,
                activo=activo
            )
            vehiculo.save()
            
            messages.success(request, 'Veh√≠culo creado exitosamente')
            return redirect('vehiculos')
            
        except Exception as e:
            messages.error(request, f'Error al crear el veh√≠culo: {str(e)}')
    
    # Mostrar formulario para crear veh√≠culo
    context = {
        'conductores': Conductor.objects.filter(activo=True),
    }
    return render(request, 'transporte/vehiculo_form.html', context)

@login_required
@admin_required
def eliminar_vehiculo(request, pk):
    """Vista para eliminar un veh√≠culo"""
    vehiculo = get_object_or_404(Vehiculo, pk=pk)
    
    if request.method == 'POST':
        try:
            vehiculo.delete()
            messages.success(request, 'Veh√≠culo eliminado exitosamente')
            return redirect('vehiculos')
                
        except Exception as e:
            messages.error(request, f'Error al eliminar el veh√≠culo: {str(e)}')
            return redirect('vehiculos')
    
    # Si es GET, mostrar confirmaci√≥n
    context = {
        'vehiculo': vehiculo,
    }
    return render(request, 'transporte/vehiculo_confirm_delete.html', context)

@login_required
@admin_required
def crear_aeronave(request):
    """Vista para crear una nueva aeronave"""
    if request.method == 'POST':
        try:
            # Obtener datos del formulario
            matricula = request.POST.get('matricula')
            tipo_aeronave = request.POST.get('tipo_aeronave')
            modelo = request.POST.get('modelo')
            capacidad_kg = request.POST.get('capacidad_kg')
            piloto_id = request.POST.get('piloto_asignado') or None
            activo = 'activo' in request.POST
            
            # Crear la aeronave
            aeronave = Aeronave(
                matricula=matricula,
                tipo_aeronave=tipo_aeronave,
                modelo=modelo,
                capacidad_kg=capacidad_kg,
                piloto_asignado_id=piloto_id,
                activo=activo
            )
            aeronave.save()
            
            messages.success(request, 'Aeronave creada exitosamente')
            return redirect('aeronaves')
            
        except Exception as e:
            messages.error(request, f'Error al crear la aeronave: {str(e)}')
    
    # Mostrar formulario para crear aeronave
    context = {
        'pilotos': Piloto.objects.filter(activo=True),
    }
    return render(request, 'transporte/aeronave_form.html', context)

@login_required
@admin_required
def crear_conductor(request):
    """Vista para crear un nuevo conductor"""
    if request.method == 'POST':
        try:
            # Obtener datos del formulario
            nombre = request.POST.get('nombre')
            rut = request.POST.get('rut')
            licencia = request.POST.get('licencia')
            telefono = request.POST.get('telefono')
            email = request.POST.get('email')
            activo = 'activo' in request.POST
            
            # Crear el conductor
            conductor = Conductor(
                nombre=nombre,
                rut=rut,
                licencia=licencia,
                telefono=telefono,
                email=email,
                activo=activo
            )
            conductor.save()
            
            messages.success(request, 'Conductor creado exitosamente')
            return redirect('conductores')
            
        except Exception as e:
            messages.error(request, f'Error al crear el conductor: {str(e)}')
    
    return render(request, 'transporte/conductor_form.html')

@login_required
@admin_required
def eliminar_conductor(request, pk):
    """Vista para eliminar un conductor"""
    conductor = get_object_or_404(Conductor, pk=pk)
    
    if request.method == 'POST':
        try:
            conductor.delete()
            messages.success(request, 'Conductor eliminado exitosamente')
            return redirect('conductores')
                
        except Exception as e:
            messages.error(request, f'Error al eliminar el conductor: {str(e)}')
            return redirect('conductores')
    
    context = {
        'conductor': conductor,
    }
    return render(request, 'transporte/conductor_confirm_delete.html', context)

@login_required
@admin_required
def crear_piloto(request):
    """Vista para crear un nuevo piloto"""
    if request.method == 'POST':
        try:
            # Obtener datos del formulario
            nombre = request.POST.get('nombre')
            rut = request.POST.get('rut')
            certificacion = request.POST.get('certificacion')
            telefono = request.POST.get('telefono')
            email = request.POST.get('email')
            horas_vuelo = request.POST.get('horas_vuelo', 0)
            activo = 'activo' in request.POST
            
            # Crear el piloto
            piloto = Piloto(
                nombre=nombre,
                rut=rut,
                certificacion=certificacion,
                telefono=telefono,
                email=email,
                horas_vuelo=horas_vuelo,
                activo=activo
            )
            piloto.save()
            
            messages.success(request, 'Piloto creado exitosamente')
            return redirect('pilotos')
            
        except Exception as e:
            messages.error(request, f'Error al crear el piloto: {str(e)}')
    
    return render(request, 'transporte/piloto_form.html')

@login_required
@admin_required
def eliminar_piloto(request, pk):
    """Vista para eliminar un piloto"""
    piloto = get_object_or_404(Piloto, pk=pk)
    
    if request.method == 'POST':
        try:
            piloto.delete()
            messages.success(request, 'Piloto eliminado exitosamente')
            return redirect('pilotos')
                
        except Exception as e:
            messages.error(request, f'Error al eliminar el piloto: {str(e)}')
            return redirect('pilotos')
    
    context = {
        'piloto': piloto,
    }
    return render(request, 'transporte/piloto_confirm_delete.html', context)

@login_required
@admin_required
def crear_cliente(request):
    """Vista para crear un nuevo cliente"""
    if request.method == 'POST':
        try:
            # Obtener datos del formulario
            tipo_cliente = request.POST.get('tipo_cliente')
            razon_social = request.POST.get('razon_social')
            nombre = request.POST.get('nombre')
            apellido = request.POST.get('apellido')
            rut = request.POST.get('rut')
            persona_contacto = request.POST.get('persona_contacto')
            telefono = request.POST.get('telefono')
            email = request.POST.get('email')
            direccion = request.POST.get('direccion')
            activo = 'activo' in request.POST
            
            # Crear el cliente
            cliente = Cliente(
                tipo_cliente=tipo_cliente,
                razon_social=razon_social,
                nombre=nombre,
                apellido=apellido,
                rut=rut,
                persona_contacto=persona_contacto,
                telefono=telefono,
                email=email,
                direccion=direccion,
                activo=activo
            )
            cliente.save()
            
            messages.success(request, 'Cliente creado exitosamente')
            return redirect('clientes')
            
        except Exception as e:
            messages.error(request, f'Error al crear el cliente: {str(e)}')
    
    return render(request, 'transporte/cliente_form.html')

@login_required
@admin_required
def eliminar_cliente(request, pk):
    """Vista para eliminar un cliente"""
    cliente = get_object_or_404(Cliente, pk=pk)
    
    if request.method == 'POST':
        try:
            cliente.delete()
            messages.success(request, 'Cliente eliminado exitosamente')
            return redirect('clientes')
                
        except Exception as e:
            messages.error(request, f'Error al eliminar el cliente: {str(e)}')
            return redirect('clientes')
    
    context = {
        'cliente': cliente,
    }
    return render(request, 'transporte/cliente_confirm_delete.html', context)

@login_required
@admin_required
def crear_carga(request):
    """Vista para crear una nueva carga"""
    if request.method == 'POST':
        try:
            # Obtener datos del formulario
            descripcion = request.POST.get('descripcion')
            tipo_carga = request.POST.get('tipo_carga')
            peso_kg = request.POST.get('peso_kg')
            volumen_m3 = request.POST.get('volumen_m3')
            valor_declarado = request.POST.get('valor_declarado')
            cliente_id = request.POST.get('cliente')
            notas_especiales = request.POST.get('notas_especiales', '')
            
            # Crear la carga
            carga = Carga(
                descripcion=descripcion,
                tipo_carga=tipo_carga,
                peso_kg=peso_kg,
                volumen_m3=volumen_m3,
                valor_declarado=valor_declarado,
                cliente_id=cliente_id,
                notas_especiales=notas_especiales
            )
            carga.save()
            
            messages.success(request, 'Carga creada exitosamente')
            return redirect('cargas')
            
        except Exception as e:
            messages.error(request, f'Error al crear la carga: {str(e)}')
    
    # Mostrar formulario para crear carga
    context = {
        'clientes': Cliente.objects.filter(activo=True),
    }
    return render(request, 'transporte/carga_form.html', context)

@login_required
@admin_required
def eliminar_carga(request, pk):
    """Vista para eliminar una carga"""
    carga = get_object_or_404(Carga, pk=pk)
    
    if request.method == 'POST':
        try:
            carga.delete()
            messages.success(request, 'Carga eliminada exitosamente')
            return redirect('cargas')
                
        except Exception as e:
            messages.error(request, f'Error al eliminar la carga: {str(e)}')
            return redirect('cargas')
    
    context = {
        'carga': carga,
    }
    return render(request, 'transporte/carga_confirm_delete.html', context)

@login_required
@admin_required
def crear_seguro(request):
    """Vista para crear un nuevo seguro"""
    if request.method == 'POST':
        try:
            # Obtener datos del formulario
            numero_poliza = request.POST.get('numero_poliza')
            tipo_seguro = request.POST.get('tipo_seguro')
            aseguradora = request.POST.get('aseguradora')
            cobertura = request.POST.get('cobertura')
            vigencia_desde = request.POST.get('vigencia_desde')
            vigencia_hasta = request.POST.get('vigencia_hasta')
            estado = request.POST.get('estado')
            vehiculo_id = request.POST.get('vehiculo') or None
            aeronave_id = request.POST.get('aeronave') or None
            
            # Crear el seguro
            seguro = Seguro(
                numero_poliza=numero_poliza,
                tipo_seguro=tipo_seguro,
                aseguradora=aseguradora,
                cobertura=cobertura,
                vigencia_desde=vigencia_desde,
                vigencia_hasta=vigencia_hasta,
                estado=estado,
                vehiculo_id=vehiculo_id,
                aeronave_id=aeronave_id
            )
            seguro.save()
            
            messages.success(request, 'Seguro creado exitosamente')
            return redirect('seguros')
            
        except Exception as e:
            messages.error(request, f'Error al crear el seguro: {str(e)}')
    
    # Mostrar formulario para crear seguro
    context = {
        'vehiculos': Vehiculo.objects.filter(activo=True),
        'aeronaves': Aeronave.objects.filter(activo=True),
    }
    return render(request, 'transporte/seguro_form.html', context)

def admin_required(view_func):
    @wraps(view_func)
    def _wrapped_view(request, *args, **kwargs):
        if request.user.is_authenticated:
            # Superusuarios tienen acceso completo
            if request.user.is_superuser:
                return view_func(request, *args, **kwargs)
                
            try:
                if hasattr(request.user, 'perfilusuario') and request.user.perfilusuario.tipo_usuario == 'ADMIN':
                    return view_func(request, *args, **kwargs)
            except:
                pass
        messages.error(request, 'Acceso denegado: Se requiere rol de administrador')
        return redirect('dashboard')
    return _wrapped_view

@login_required
@admin_required
def eliminar_seguro(request, pk):
    """Vista para eliminar un seguro"""
    seguro = get_object_or_404(Seguro, pk=pk)
    
    if request.method == 'POST':
        try:
            seguro.delete()
            messages.success(request, 'Seguro eliminado exitosamente')
            return redirect('seguros')
                
        except Exception as e:
            messages.error(request, f'Error al eliminar el seguro: {str(e)}')
            return redirect('seguros')
    
    context = {
        'seguro': seguro,
    }
    return render(request, 'transporte/seguro_confirm_delete.html', context)

# En transporte/views.py - AGREGAR AL FINAL DEL ARCHIVO

from rest_framework.decorators import api_view, permission_classes
from rest_framework.response import Response

# ‚úÖ VISTAS API ESPEC√çFICAS PARA DATOS REALES
@api_view(['GET'])
@permission_classes([permissions.AllowAny])  # Acceso p√∫blico
def api_rutas_list(request):
    """API para obtener lista de rutas"""
    rutas = Ruta.objects.all()
    serializer = RutaSerializer(rutas, many=True)
    return Response(serializer.data)

@api_view(['GET'])
@permission_classes([permissions.AllowAny])  # Acceso p√∫blico
def api_vehiculos_list(request):
    """API para obtener lista de veh√≠culos"""
    vehiculos = Vehiculo.objects.filter(activo=True)
    serializer = VehiculoSerializer(vehiculos, many=True)
    return Response(serializer.data)

@api_view(['GET'])
@permission_classes([permissions.AllowAny])  # Acceso p√∫blico
def api_aeronaves_list(request):
    """API para obtener lista de aeronaves"""
    aeronaves = Aeronave.objects.filter(activo=True)
    serializer = AeronaveSerializer(aeronaves, many=True)
    return Response(serializer.data)

@api_view(['GET'])
@permission_classes([permissions.AllowAny])  # Acceso p√∫blico
def api_conductores_list(request):
    """API para obtener lista de conductores"""
    conductores = Conductor.objects.filter(activo=True)
    serializer = ConductorSerializer(conductores, many=True)
    return Response(serializer.data)

@api_view(['GET'])
@permission_classes([permissions.AllowAny])  # Acceso p√∫blico
def api_pilotos_list(request):
    """API para obtener lista de pilotos"""
    pilotos = Piloto.objects.filter(activo=True)
    serializer = PilotoSerializer(pilotos, many=True)
    return Response(serializer.data)

@api_view(['GET'])
@permission_classes([permissions.AllowAny])  # Acceso p√∫blico
def api_clientes_list(request):
    """API para obtener lista de clientes"""
    clientes = Cliente.objects.filter(activo=True)
    serializer = ClienteSerializer(clientes, many=True)
    return Response(serializer.data)

@api_view(['GET'])
@permission_classes([permissions.AllowAny])  # Acceso p√∫blico
def api_cargas_list(request):
    """API para obtener lista de cargas"""
    cargas = Carga.objects.all()
    serializer = CargaSerializer(cargas, many=True)
    return Response(serializer.data)

@api_view(['GET'])
@permission_classes([permissions.AllowAny])  # Acceso p√∫blico
def api_seguros_list(request):
    """API para obtener lista de seguros"""
    seguros = Seguro.objects.all()
    serializer = SeguroSerializer(seguros, many=True)
    return Response(serializer.data)

@api_view(['GET'])
@permission_classes([permissions.AllowAny])  # Acceso p√∫blico
def api_despachos_list(request):
    """API para obtener lista de despachos"""
    despachos = Despacho.objects.all().order_by('-fecha_despacho')[:50]
    serializer = DespachoSerializer(despachos, many=True)
    return Response(serializer.data)
============================================================


===== __init__.py =====

============================================================


################################################################################
üìÅ Carpeta: C:\Users\kevin\OneDrive\Liceo\Escritorio\Prueba\transporte\templates
################################################################################


===== base.html =====
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Log√≠stica Global{% endblock %}</title>
    <style>
        /* ===== VARIABLES Y RESET ===== */
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #06b6d4;
            --accent: #f59e0b;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --info: #3b82f6;
            --bg-dark: #0f172a;
            --bg-card: #1e293b;
            --bg-hover: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --border: #334155;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* ===== ESTILOS BASE ===== */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--bg-dark) 0%, #1e293b 100%);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            position: relative;
            z-index: 1;
            max-width: 1600px;
            margin: 0 auto;
            padding: 2.5rem 3rem;
        }

        /* ===== ANIMACI√ìN DE FONDO ===== */
        .bg-animation {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 0;
            overflow: hidden;
        }

        .bg-animation span {
            position: absolute;
            display: block;
            width: 20px;
            height: 20px;
            background: rgba(99, 102, 241, 0.1);
            animation: float 25s infinite;
            border-radius: 50%;
        }

        .bg-animation span:nth-child(1) { left: 25%; animation-delay: 0s; }
        .bg-animation span:nth-child(2) { left: 10%; animation-delay: 2s; animation-duration: 30s; }
        .bg-animation span:nth-child(3) { left: 70%; animation-delay: 4s; }
        .bg-animation span:nth-child(4) { left: 40%; animation-delay: 0s; animation-duration: 18s; }
        .bg-animation span:nth-child(5) { left: 65%; animation-delay: 0s; }
        .bg-animation span:nth-child(6) { left: 75%; animation-delay: 3s; }
        .bg-animation span:nth-child(7) { left: 35%; animation-delay: 7s; }
        .bg-animation span:nth-child(8) { left: 50%; animation-delay: 15s; animation-duration: 45s; }
        .bg-animation span:nth-child(9) { left: 20%; animation-delay: 2s; animation-duration: 35s; }
        .bg-animation span:nth-child(10) { left: 85%; animation-delay: 0s; animation-duration: 11s; }

        @keyframes float {
            0% { transform: translateY(100vh) scale(0); opacity: 0; }
            50% { opacity: 1; }
            100% { transform: translateY(-100vh) scale(1); opacity: 0; }
        }

        /* ===== HEADER Y NAVEGACI√ìN ===== */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 3rem;
            background: rgba(30, 41, 59, 0.6);
            backdrop-filter: blur(10px);
            padding: 1.5rem 2.5rem;
            border-radius: 20px;
            border: 1px solid var(--border);
            animation: slideDown 0.6s ease-out;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 1rem;
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .logo:hover {
            transform: scale(1.05);
        }

        .logo-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            animation: rotate3d 3s infinite ease-in-out;
        }

        @keyframes rotate3d {
            0%, 100% { transform: rotateY(0deg); }
            50% { transform: rotateY(180deg); }
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .avatar {
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, var(--accent), var(--danger));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .avatar:hover {
            transform: scale(1.1) rotate(5deg);
        }

        .nav-menu {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .nav-item {
            padding: 0.8rem 1.5rem;
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .nav-item:hover, .nav-item.active {
            background: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(99, 102, 241, 0.4);
        }

        /* ===== COMPONENTES DE CONTENIDO ===== */
        .page-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .content-card {
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.8), rgba(30, 41, 59, 0.4));
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 1px solid var(--border);
            padding: 2rem;
            margin-bottom: 2rem;
        }

        /* ===== COMPONENTES DE FORMULARIO ===== */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 0.8rem 1rem;
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 0.95rem;
        }

        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: var(--primary);
        }

        .form-textarea {
            resize: vertical;
            min-height: 100px;
        }

        .form-row {
            display: flex;
            gap: 1rem;
        }

        .form-row .form-group {
            flex: 1;
        }

        /* ===== BOTONES ===== */
        .btn {
            padding: 0.8rem 1.5rem;
            background: var(--primary);
            border: none;
            border-radius: 12px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(99, 102, 241, 0.4);
        }

        .btn-secondary {
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background: var(--bg-hover);
        }

        .btn-danger {
            background: var(--danger);
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        .btn-success {
            background: var(--success);
        }

        .btn-success:hover {
            background: #059669;
        }

        .action-buttons {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
            flex-wrap: wrap;
        }

        /* ===== COMPONENTES DE DETALLE ===== */
        .detail-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .detail-item {
            background: rgba(51, 65, 85, 0.3);
            padding: 1.5rem;
            border-radius: 12px;
            border-left: 4px solid var(--primary);
        }

        .detail-label {
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }

        .detail-value {
            font-size: 1.1rem;
        }

        /* ===== BADGES ===== */
        .badge {
            padding: 0.4rem 1rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            display: inline-block;
        }

        .badge.active { background: rgba(16, 185, 129, 0.2); color: var(--success); }
        .badge.pending { background: rgba(245, 158, 11, 0.2); color: var(--accent); }
        .badge.alert { background: rgba(239, 68, 68, 0.2); color: var(--danger); }
        .badge.warning { background: rgba(245, 158, 11, 0.2); color: var(--warning); }
        .badge.info { background: rgba(59, 130, 246, 0.2); color: var(--info); }

        /* ===== COMPONENTES DEL DASHBOARD ===== */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.8), rgba(30, 41, 59, 0.4));
            backdrop-filter: blur(10px);
            border-radius: 15px;
            border: 1px solid var(--border);
            padding: 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            transition: transform 0.3s ease;
            cursor: pointer;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary);
        }

        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 2rem;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .card-header h3 {
            font-size: 1.3rem;
            font-weight: 600;
        }

        /* ===== COMPONENTES DE LOGIN ===== */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 80vh;
        }

        .login-card {
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.9), rgba(30, 41, 59, 0.7));
            backdrop-filter: blur(10px);
            padding: 3rem;
            border-radius: 20px;
            border: 1px solid var(--border);
            width: 100%;
            max-width: 400px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }

        .login-title {
            text-align: center;
            margin-bottom: 2rem;
            font-size: 1.8rem;
            font-weight: 700;
        }

        .form-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 1.5rem;
        }

        /* ===== ALERTS ===== */
        .alert {
            padding: 1rem;
            border-radius: 12px;
            margin-bottom: 1.5rem;
            border-left: 4px solid;
        }

        .alert-success {
            background: rgba(16, 185, 129, 0.2);
            border-color: var(--success);
            color: var(--success);
        }

        .alert-error {
            background: rgba(239, 68, 68, 0.2);
            border-color: var(--danger);
            color: var(--danger);
        }

        .alert-warning {
            background: rgba(245, 158, 11, 0.2);
            border-color: var(--warning);
            color: var(--warning);
        }

        /* ===== RESPONSIVE ===== */
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }

            .header {
                flex-direction: column;
                gap: 1rem;
            }

            .form-row {
                flex-direction: column;
                gap: 0;
            }

            .action-buttons {
                flex-direction: column;
            }

            .login-card {
                padding: 2rem;
                margin: 1rem;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
    {% block extra_css %}{% endblock %}
</head>
<body>
    <div class="bg-animation">
        <span></span><span></span><span></span><span></span><span></span>
        <span></span><span></span><span></span><span></span><span></span>
    </div>

    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="logo" onclick="window.location.href='{% url 'dashboard' %}'">
                <div class="logo-icon">üöö</div>
                <span>Log√≠stica Global</span>
            </div>
            
            <div class="user-info">
                {% if user.is_authenticated %}
                    <div>
                        <div style="font-weight: 600;">{{ user.get_full_name|default:user.username }}</div>
                        <div style="font-size: 0.85rem; color: var(--text-secondary);">
                            {% if user.is_superuser %}
                                üëë SUPERUSUARIO
                            {% elif user.perfilusuario.tipo_usuario == 'ADMIN' %}
                                Administrador
                            {% elif user.perfilusuario.tipo_usuario == 'CLIENTE' %}
                                Cliente
                            {% elif user.perfilusuario.tipo_usuario == 'CONDUCTOR' %}
                                Conductor
                            {% elif user.perfilusuario.tipo_usuario == 'PILOTO' %}
                                Piloto
                            {% else %}
                                Usuario
                            {% endif %}
                        </div>
                    </div>
                    <div class="avatar" onclick="window.location.href='{% url 'logout' %}'" title="Cerrar sesi√≥n">
                        {{ user.username|slice:":2"|upper }}
                    </div>
                {% else %}
                    <a href="{% url 'login' %}" class="btn">Iniciar Sesi√≥n</a>
                {% endif %}
            </div>
        </div>
        
        <!-- Indicador de Rol -->
        {% if user.is_authenticated %}
        <div style="text-align: center; margin-bottom: 1rem;">
            <div style="display: inline-block; background: rgba(99, 102, 241, 0.2); padding: 0.5rem 1rem; border-radius: 20px; font-size: 0.9rem;">
                {% if user.is_superuser %}
                    üëë SUPERUSUARIO - Acceso completo
                {% elif user.perfilusuario.tipo_usuario == 'ADMIN' %}
                    üëë ADMINISTRADOR - Acceso completo
                {% elif user.perfilusuario.tipo_usuario == 'CLIENTE' %}
                    üë• CLIENTE - Modo solo lectura
                {% elif user.perfilusuario.tipo_usuario == 'CONDUCTOR' %}
                    üöõ CONDUCTOR - Acceso limitado
                {% elif user.perfilusuario.tipo_usuario == 'PILOTO' %}
                    ‚úàÔ∏è PILOTO - Acceso limitado
                {% endif %}
            </div>
        </div>
        {% endif %}

        <!-- Navegaci√≥n -->
        {% if user.is_authenticated %}
        <div class="nav-menu">
            <div class="nav-item {% if request.resolver_match.url_name == 'dashboard' %}active{% endif %}" 
                 onclick="window.location.href='{% url 'dashboard' %}'">üìä Dashboard</div>
            
            <!-- ‚úÖ ESTAS SECCIONES AHORA SON VISIBLES PARA TODOS LOS USUARIOS -->
            <div class="nav-item {% if request.resolver_match.url_name == 'despachos' %}active{% endif %}" 
                 onclick="window.location.href='{% url 'despachos' %}'">üì¶ Despachos</div>
            <div class="nav-item {% if request.resolver_match.url_name == 'rutas' %}active{% endif %}" 
                 onclick="window.location.href='{% url 'rutas' %}'">üó∫Ô∏è Rutas</div>
            <div class="nav-item {% if request.resolver_match.url_name == 'vehiculos' %}active{% endif %}" 
                 onclick="window.location.href='{% url 'vehiculos' %}'">üöõ Veh√≠culos</div>
            <div class="nav-item {% if request.resolver_match.url_name == 'aeronaves' %}active{% endif %}" 
                 onclick="window.location.href='{% url 'aeronaves' %}'">‚úàÔ∏è Aeronaves</div>
            <div class="nav-item {% if request.resolver_match.url_name == 'conductores' %}active{% endif %}" 
                 onclick="window.location.href='{% url 'conductores' %}'">üë®‚Äçüíº Conductores</div>
            <div class="nav-item {% if request.resolver_match.url_name == 'pilotos' %}active{% endif %}" 
                 onclick="window.location.href='{% url 'pilotos' %}'">üë®‚Äç‚úàÔ∏è Pilotos</div>
            <div class="nav-item {% if request.resolver_match.url_name == 'clientes' %}active{% endif %}" 
                 onclick="window.location.href='{% url 'clientes' %}'">üë• Clientes</div>
            <div class="nav-item {% if request.resolver_match.url_name == 'cargas' %}active{% endif %}" 
                 onclick="window.location.href='{% url 'cargas' %}'">üì¶ Cargas</div>
            <div class="nav-item {% if request.resolver_match.url_name == 'seguros' %}active{% endif %}" 
                 onclick="window.location.href='{% url 'seguros' %}'">üõ°Ô∏è Seguros</div>
            
            <!-- Solo admin puede ver reportes -->
            {% if user.is_superuser or user.perfilusuario.tipo_usuario == 'ADMIN' %}
            <div class="nav-item {% if request.resolver_match.url_name == 'reportes' %}active{% endif %}" 
                 onclick="window.location.href='{% url 'reportes' %}'">üìà Reportes</div>
            {% endif %}
            
            <div class="nav-item {% if request.resolver_match.url_name == 'api' %}active{% endif %}" 
                 onclick="window.location.href='{% url 'api' %}'">üîó API</div>
        </div>
        {% endif %}

        <!-- Mensajes -->
        {% if messages %}
            {% for message in messages %}
            <div class="alert alert-{{ message.tags }}">
                {{ message }}
            </div>
            {% endfor %}
        {% endif %}

        <!-- Contenido Principal -->
        {% block content %}
        {% endblock %}
    </div>

    <script>
        // ===== FUNCIONES DE NAVEGACI√ìN =====
        function goToDashboard() {
            window.location.href = '{% url 'dashboard' %}';
        }

        function goToPage(url) {
            window.location.href = url;
        }

        // ===== SISTEMA DE NOTIFICACIONES =====
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.textContent = `‚úì ${message}`;
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: linear-gradient(135deg, #6366f1, #06b6d4);
                color: white;
                padding: 1rem 2rem;
                border-radius: 12px;
                box-shadow: 0 10px 30px rgba(99, 102, 241, 0.4);
                z-index: 1000;
                animation: slideInRight 0.4s ease-out;
                font-weight: 600;
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOutRight 0.4s ease-out';
                setTimeout(() => notification.remove(), 400);
            }, 3000);
        }

        // ===== ANIMACIONES =====
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideInRight {
                from { transform: translateX(400px); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOutRight {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(400px); opacity: 0; }
            }
        `;
        document.head.appendChild(style);

        // ===== FUNCIONALIDAD DE MODALES =====
        window.onclick = function(event) {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            });
        }
    </script>
    
    {% block extra_js %}{% endblock %}
</body>
</html>
============================================================


################################################################################
üìÅ Carpeta: C:\Users\kevin\OneDrive\Liceo\Escritorio\Prueba\transporte\templates\transporte
################################################################################


===== aeronaves.html =====
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aeronaves - Sistema de Gesti√≥n de Transporte</title>
    <style>
        /* MANTENER TODOS LOS ESTILOS ORIGINALES EXACTAMENTE IGUAL */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #06b6d4;
            --accent: #f59e0b;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --info: #3b82f6;
            --bg-dark: #0f172a;
            --bg-card: #1e293b;
            --bg-hover: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --border: #334155;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--bg-dark) 0%, #1e293b 100%);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .bg-animation {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 0;
            overflow: hidden;
        }

        .bg-animation span {
            position: absolute;
            display: block;
            width: 20px;
            height: 20px;
            background: rgba(99, 102, 241, 0.1);
            animation: float 25s infinite;
            border-radius: 50%;
        }

        .bg-animation span:nth-child(1) { left: 25%; animation-delay: 0s; }
        .bg-animation span:nth-child(2) { left: 10%; animation-delay: 2s; animation-duration: 30s; }
        .bg-animation span:nth-child(3) { left: 70%; animation-delay: 4s; }
        .bg-animation span:nth-child(4) { left: 40%; animation-delay: 0s; animation-duration: 18s; }
        .bg-animation span:nth-child(5) { left: 65%; animation-delay: 0s; }
        .bg-animation span:nth-child(6) { left: 75%; animation-delay: 3s; }
        .bg-animation span:nth-child(7) { left: 35%; animation-delay: 7s; }
        .bg-animation span:nth-child(8) { left: 50%; animation-delay: 15s; animation-duration: 45s; }
        .bg-animation span:nth-child(9) { left: 20%; animation-delay: 2s; animation-duration: 35s; }
        .bg-animation span:nth-child(10) { left: 85%; animation-delay: 0s; animation-duration: 11s; }

        @keyframes float {
            0% {
                transform: translateY(100vh) scale(0);
                opacity: 0;
            }
            50% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100vh) scale(1);
                opacity: 0;
            }
        }

        .container {
            position: relative;
            z-index: 1;
            max-width: 1600px;
            margin: 0 auto;
            padding: 2.5rem 3rem;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 3rem;
            background: rgba(30, 41, 59, 0.6);
            backdrop-filter: blur(10px);
            padding: 1.5rem 2.5rem;
            border-radius: 20px;
            border: 1px solid var(--border);
            animation: slideDown 0.6s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 1rem;
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .logo-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            animation: rotate3d 3s infinite ease-in-out;
        }

        @keyframes rotate3d {
            0%, 100% { transform: rotateY(0deg); }
            50% { transform: rotateY(180deg); }
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .avatar {
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, var(--accent), var(--danger));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .avatar:hover {
            transform: scale(1.1) rotate(5deg);
        }

        .nav-menu {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .nav-item {
            padding: 0.8rem 1.5rem;
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .nav-item:hover, .nav-item.active {
            background: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(99, 102, 241, 0.4);
        }

        .page-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .filters {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .filter-group {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .filter-select, .search-input {
            padding: 0.8rem 1.2rem;
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 0.95rem;
            min-width: 180px;
        }

        .search-input {
            flex: 1;
            min-width: 250px;
        }

        .btn {
            padding: 0.8rem 1.5rem;
            background: var(--primary);
            border: none;
            border-radius: 12px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(99, 102, 241, 0.4);
        }

        .btn-secondary {
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background: var(--bg-hover);
        }

        .table-container {
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.8), rgba(30, 41, 59, 0.4));
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 1px solid var(--border);
            overflow: hidden;
            margin-bottom: 2rem;
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem 2rem;
            border-bottom: 1px solid var(--border);
        }

        .table-title {
            font-size: 1.3rem;
            font-weight: 600;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
        }

        .table th {
            text-align: left;
            padding: 1.2rem 1.5rem;
            background: rgba(51, 65, 85, 0.3);
            font-weight: 600;
            color: var(--text-secondary);
            border-bottom: 1px solid var(--border);
        }

        .table td {
            padding: 1.2rem 1.5rem;
            border-bottom: 1px solid var(--border);
        }

        .table tr:last-child td {
            border-bottom: none;
        }

        .table tr:hover {
            background: rgba(51, 65, 85, 0.2);
        }

        .badge {
            padding: 0.4rem 1rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .badge.active {
            background: rgba(16, 185, 129, 0.2);
            color: var(--success);
        }

        .badge.maintenance {
            background: rgba(245, 158, 11, 0.2);
            color: var(--warning);
        }

        .badge.inactive {
            background: rgba(239, 68, 68, 0.2);
            color: var(--danger);
        }

        .badge.cargo {
            background: rgba(59, 130, 246, 0.2);
            color: var(--info);
        }

        .badge.passenger {
            background: rgba(139, 92, 246, 0.2);
            color: #a78bfa;
        }

        .badge.mixed {
            background: rgba(245, 158, 11, 0.2);
            color: var(--warning);
        }

        .pagination {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem 2rem;
            border-top: 1px solid var(--border);
        }

        .pagination-info {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .pagination-controls {
            display: flex;
            gap: 0.5rem;
        }

        .pagination-btn {
            padding: 0.6rem 1rem;
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .pagination-btn:hover {
            background: var(--primary);
        }

        .pagination-btn.active {
            background: var(--primary);
        }

        .action-btn {
            padding: 0.4rem 0.8rem;
            background: rgba(99, 102, 241, 0.2);
            border: 1px solid var(--primary);
            border-radius: 8px;
            color: var(--primary);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.85rem;
            margin-right: 0.5rem;
        }

        .action-btn:hover {
            background: var(--primary);
            color: white;
        }

        .action-btn.delete {
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid var(--danger);
            color: var(--danger);
        }

        .action-btn.delete:hover {
            background: var(--danger);
            color: white;
        }

        .loading {
            text-align: center;
            padding: 2rem;
            color: var(--text-secondary);
        }

        .error {
            text-align: center;
            padding: 2rem;
            color: var(--danger);
            background: rgba(239, 68, 68, 0.1);
            border-radius: 12px;
            margin: 1rem 0;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--bg-card);
            padding: 2rem;
            border-radius: 20px;
            border: 1px solid var(--border);
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .close-modal {
            position: absolute;
            top: 1rem;
            right: 1rem;
            cursor: pointer;
            font-size: 1.5rem;
            color: var(--text-secondary);
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .form-input, .form-select {
            width: 100%;
            padding: 0.8rem 1rem;
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 0.95rem;
        }

        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: var(--primary);
        }

        .form-row {
            display: flex;
            gap: 1rem;
        }

        .form-row .form-group {
            flex: 1;
        }

        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }

            .header {
                flex-direction: column;
                gap: 1rem;
            }

            .filters {
                flex-direction: column;
            }

            .filter-group {
                width: 100%;
            }

            .filter-select, .search-input {
                min-width: 100%;
            }

            .table-container {
                overflow-x: auto;
            }

            .table {
                min-width: 800px;
            }

            .form-row {
                flex-direction: column;
                gap: 0;
            }
        }
    </style>
</head>
<body>
    <div class="bg-animation">
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
    </div>

    <div class="container">
        <div class="header">
            <div class="logo">
                <div class="logo-icon">‚úàÔ∏è</div>
                <span>Log√≠stica Global</span>
            </div>
            <div class="user-info">
                {% if user.is_authenticated %}
                <div>
                    <div style="font-weight: 600;">{{ user.get_full_name|default:user.username }}</div>
                    <div style="font-size: 0.85rem; color: var(--text-secondary);">
                        {% if user.is_staff %}Administrador{% else %}Usuario{% endif %}
                    </div>
                </div>
                <div class="avatar" onclick="window.location.href='{% url 'logout' %}'" title="Cerrar sesi√≥n">
                    {{ user.username|slice:":2"|upper }}
                </div>
                {% else %}
                <a href="{% url 'login' %}" class="btn">Iniciar Sesi√≥n</a>
                {% endif %}
            </div>
        </div>

        <div class="nav-menu">
            <div class="nav-item" onclick="window.location.href='{% url 'dashboard' %}'">üìä Dashboard</div>
            <div class="nav-item" onclick="window.location.href='{% url 'despachos' %}'">üì¶ Despachos</div>
            <div class="nav-item" onclick="window.location.href='{% url 'rutas' %}'">üó∫Ô∏è Rutas</div>
            <div class="nav-item" onclick="window.location.href='{% url 'vehiculos' %}'">üöõ Veh√≠culos</div>
            <div class="nav-item active" onclick="window.location.href='{% url 'aeronaves' %}'">‚úàÔ∏è Aeronaves</div>
            <div class="nav-item" onclick="window.location.href='{% url 'conductores' %}'">üë®‚Äçüíº Conductores</div>
            <div class="nav-item" onclick="window.location.href='{% url 'pilotos' %}'">üë®‚Äç‚úàÔ∏è Pilotos</div>
            <div class="nav-item" onclick="window.location.href='{% url 'clientes' %}'">üë• Clientes</div>
            <div class="nav-item" onclick="window.location.href='{% url 'cargas' %}'">üì¶ Cargas</div>
            <div class="nav-item" onclick="window.location.href='{% url 'seguros' %}'">üõ°Ô∏è Seguros</div>
            <div class="nav-item" onclick="window.location.href='{% url 'reportes' %}'">üìà Reportes</div>
            <div class="nav-item" onclick="window.location.href='{% url 'api' %}'">üîó API</div>
        </div>

        <!-- BLOQUE DE PERMISOS PARA NO-ADMIN -->
        {% if user.is_authenticated and user.perfilusuario.tipo_usuario != 'ADMIN' %}
        <style>
            #new-aircraft-btn,
            .btn[onclick*="crear"],
            .btn[onclick*="editar"],
            .btn[onclick*="eliminar"],
            .action-btn.delete,
            .btn-danger {
                display: none !important;
            }
        </style>
        
        <div style="background: rgba(59, 130, 246, 0.2); border: 1px solid #3b82f6; border-radius: 12px; padding: 1rem; margin-bottom: 1.5rem;">
            <div style="display: flex; align-items: center; gap: 0.5rem; color: #3b82f6;">
                <span>üîí</span>
                <div>
                    <strong>Modo Solo Lectura</strong>
                    <div style="font-size: 0.9rem; opacity: 0.9;">
                        Como {{ user.perfilusuario.tipo_usuario|title }}, solo puedes visualizar informaci√≥n de aeronaves.
                    </div>
                </div>
            </div>
        </div>
        {% endif %}

        <!-- Mensajes del sistema -->
        {% if messages %}
            {% for message in messages %}
            <div class="alert alert-{{ message.tags }}">
                {{ message }}
            </div>
            {% endfor %}
        {% endif %}

        <div class="page-title">
            <span>‚úàÔ∏è</span>
            <span>Gesti√≥n de Aeronaves</span>
        </div>

        <div class="filters">
            <div class="filter-group">
                <select class="filter-select" id="filter-status">
                    <option value="">Todos los estados</option>
                    <option value="active">Activa</option>
                    <option value="maintenance">En Mantenimiento</option>
                    <option value="inactive">Inactiva</option>
                </select>
                <select class="filter-select" id="filter-type">
                    <option value="">Todos los tipos</option>
                    <option value="cargo">Carga</option>
                    <option value="passenger">Pasajeros</option>
                    <option value="mixed">Mixto</option>
                </select>
            </div>
            <input type="text" class="search-input" id="search-input" placeholder="Buscar aeronave...">
            <button class="btn" id="new-aircraft-btn">‚ûï Nueva Aeronave</button>
        </div>

        <div class="table-container">
            <div class="table-header">
                <div class="table-title">Lista de Aeronaves</div>
                <div id="aircraft-count" style="color: var(--text-secondary); font-size: 0.9rem;">Cargando...</div>
            </div>
            <table class="table">
                <thead>
                    <tr>
                        <th>Matr√≠cula</th>
                        <th>Modelo</th>
                        <th>Tipo</th>
                        <th>Capacidad</th>
                        <th>Piloto Asignado</th>
                        <th>Estado</th>
                        <th>√öltimo Mantenimiento</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody id="aircraft-table-body">
                    <tr>
                        <td colspan="8" class="loading">Cargando datos de aeronaves desde la base de datos...</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Modal para crear nueva aeronave -->
    <div id="newAircraftModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal('newAircraftModal')">&times;</span>
            <h3>Nueva Aeronave</h3>
            <form id="newAircraftForm">
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Matr√≠cula</label>
                        <input type="text" class="form-input" name="matricula" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Tipo de Aeronave</label>
                        <select class="form-select" name="tipo_aeronave" required>
                            <option value="">Seleccionar tipo</option>
                            <option value="Carga">Carga</option>
                            <option value="Pasajeros">Pasajeros</option>
                            <option value="Mixto">Mixto</option>
                            <option value="Privado">Privado</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Modelo</label>
                        <input type="text" class="form-input" name="modelo" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Capacidad (kg)</label>
                        <input type="number" class="form-input" name="capacidad_kg" required min="0">
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Piloto Asignado</label>
                    <select class="form-select" name="piloto_asignado" id="piloto-select">
                        <option value="">Sin asignar</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        <input type="checkbox" name="activo" checked> Activa
                    </label>
                </div>
                
                <div style="margin-top: 2rem; display: flex; gap: 1rem; justify-content: flex-end;">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('newAircraftModal')">Cancelar</button>
                    <button type="submit" class="btn">Crear Aeronave</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Variable global para almacenar las aeronaves
        let aircraftData = [];

        // Funci√≥n para cargar aeronaves desde la base de datos
        async function loadAircraftFromDatabase() {
            try {
                showLoadingState();
                
                // Aqu√≠ se har√≠a la llamada real a tu API o backend
                const response = await fetch('/api/aeronaves/', {
                headers: {
                    'Accept': 'application/json',
                    'X-Requested-With': 'XMLHttpRequest'
                }
            });
                
                if (!response.ok) {
                    throw new Error('Error al cargar las aeronaves');
                }
                
                aircraftData = await response.json();
                renderAircraftTable(aircraftData);
                showNotification('Datos de aeronaves cargados correctamente', 'success');
                
            } catch (error) {
                console.error('Error:', error);
                showErrorState('Error al cargar las aeronaves: ' + error.message);
            }
        }

        // Funci√≥n para mostrar estado de carga
        function showLoadingState() {
            const tableBody = document.getElementById('aircraft-table-body');
            tableBody.innerHTML = `
                <tr>
                    <td colspan="8" class="loading">Cargando datos de aeronaves desde la base de datos...</td>
                </tr>
            `;
            document.getElementById('aircraft-count').textContent = 'Cargando...';
        }

        // Funci√≥n para mostrar estado de error
        function showErrorState(message) {
            const tableBody = document.getElementById('aircraft-table-body');
            tableBody.innerHTML = `
                <tr>
                    <td colspan="8">
                        <div class="error">
                            ${message}
                            <br>
                            <button class="btn" onclick="loadAircraftFromDatabase()" style="margin-top: 1rem;">
                                Reintentar
                            </button>
                        </div>
                    </td>
                </tr>
            `;
            document.getElementById('aircraft-count').textContent = 'Error';
        }

        // Funci√≥n para simular fecha de √∫ltimo mantenimiento (ya que no existe en el modelo)
        function getLastMaintenanceDate(aircraftId) {
            // Simular una fecha basada en el ID para mantener el dise√±o
            const dates = ['2023-11-15', '2023-12-01', '2024-01-10', '2024-02-05'];
            return dates[aircraftId % dates.length];
        }

        // Funci√≥n para formatear fecha
        function formatDate(dateString) {
            if (!dateString) return 'N/A';
            const date = new Date(dateString);
            return date.toLocaleDateString('es-ES');
        }

        // Funci√≥n para renderizar la tabla de aeronaves
        function renderAircraftTable(aircraft) {
            const tableBody = document.getElementById('aircraft-table-body');
            const aircraftCount = document.getElementById('aircraft-count');
            
            if (aircraft.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="8" class="loading">No se encontraron aeronaves en la base de datos</td>
                    </tr>
                `;
                aircraftCount.textContent = 'Total: 0 aeronaves';
                return;
            }
            
            tableBody.innerHTML = '';
            aircraftCount.textContent = `Total: ${aircraft.length} aeronaves`;
            
            aircraft.forEach(aircraft => {
                const row = document.createElement('tr');
                
                // USAR CAMPOS REALES DE LA BASE DE DATOS
                // Estado basado en el campo 'activo' (booleano)
                let statusClass = '';
                let statusText = '';
                
                if (aircraft.activo) {
                    statusClass = 'active';
                    statusText = 'Activa';
                } else {
                    statusClass = 'inactive';
                    statusText = 'Inactiva';
                }

                // Tipo basado en el campo 'tipo_aeronave'
                let typeClass = '';
                let typeText = aircraft.tipo_aeronave || 'N/A';
                
                // Mapear tipos a clases CSS existentes
                if (typeText.toLowerCase().includes('carga')) {
                    typeClass = 'cargo';
                } else if (typeText.toLowerCase().includes('pasajero')) {
                    typeClass = 'passenger';
                } else if (typeText.toLowerCase().includes('mixto')) {
                    typeClass = 'mixed';
                } else {
                    typeClass = 'cargo'; // default
                }

                // Piloto asignado
                const pilotName = aircraft.piloto_asignado ? 
                    (aircraft.piloto_asignado_nombre || aircraft.piloto_asignado.nombre || 'Asignado') : 
                    'Sin asignar';
                
                // Simular √∫ltimo mantenimiento (campo que no existe en el modelo)
                const lastMaintenance = getLastMaintenanceDate(aircraft.id);
                
                row.innerHTML = `
                    <td>${aircraft.matricula || aircraft.id}</td>
                    <td>${aircraft.modelo || 'N/A'}</td>
                    <td><span class="badge ${typeClass}">${typeText}</span></td>
                    <td>${aircraft.capacidad_kg ? aircraft.capacidad_kg + ' kg' : 'N/A'}</td>
                    <td>${pilotName}</td>
                    <td><span class="badge ${statusClass}">${statusText}</span></td>
                    <td>${formatDate(lastMaintenance)}</td>
                    <td>
                        <button class="action-btn" onclick="viewAircraft('${aircraft.matricula || aircraft.id}')">Ver</button>
                        <button class="action-btn" onclick="editAircraft(${aircraft.id})">Editar</button>
                        <button class="action-btn delete" onclick="deleteAircraft(${aircraft.id})">Eliminar</button>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
        }

        // Funci√≥n para filtrar aeronaves
        function filterAircraft() {
            const statusFilter = document.getElementById('filter-status').value;
            const typeFilter = document.getElementById('filter-type').value;
            const searchText = document.getElementById('search-input').value.toLowerCase();
            
            const filteredAircraft = aircraftData.filter(aircraft => {
                // Filtro por estado (usando campo 'activo' real)
                const matchesStatus = !statusFilter || 
                    (statusFilter === 'active' && aircraft.activo) ||
                    (statusFilter === 'inactive' && !aircraft.activo) ||
                    (statusFilter === 'maintenance' && !aircraft.activo); // Considerar inactivo como mantenimiento
                
                // Filtro por tipo (usando campo 'tipo_aeronave' real)
                const matchesType = !typeFilter || 
                    (typeFilter === 'cargo' && aircraft.tipo_aeronave && aircraft.tipo_aeronave.toLowerCase().includes('carga')) ||
                    (typeFilter === 'passenger' && aircraft.tipo_aeronave && aircraft.tipo_aeronave.toLowerCase().includes('pasajero')) ||
                    (typeFilter === 'mixed' && aircraft.tipo_aeronave && aircraft.tipo_aeronave.toLowerCase().includes('mixto'));
                
                // Filtro por b√∫squeda
                const matchesSearch = !searchText || 
                    (aircraft.matricula && aircraft.matricula.toLowerCase().includes(searchText)) ||
                    (aircraft.modelo && aircraft.modelo.toLowerCase().includes(searchText)) ||
                    (aircraft.piloto_asignado_nombre && aircraft.piloto_asignado_nombre.toLowerCase().includes(searchText));
                
                return matchesStatus && matchesType && matchesSearch;
            });
            
            renderAircraftTable(filteredAircraft);
        }

        // Funciones de acci√≥n para las aeronaves
        async function viewAircraft(aircraftId) {
            try {
                const response = await fetch(`/api/aeronaves/${aircraftId}/`);
                const aircraftDetails = await response.json();
                
                showNotification(`Viendo detalles de la aeronave ${aircraftId}`, 'info');
                console.log('Detalles de la aeronave:', aircraftDetails);
                
            } catch (error) {
                console.error('Error al obtener detalles:', error);
                showNotification('Error al cargar detalles de la aeronave', 'error');
            }
        }

        async function editAircraft(aircraftId) {
            showNotification(`Editando la aeronave ${aircraftId}`, 'info');
            // Redirigir a p√°gina de edici√≥n
            window.location.href = `/aeronaves/${aircraftId}/editar/`;
        }

        async function deleteAircraft(aircraftId) {
            if (confirm(`¬øEst√° seguro de que desea eliminar la aeronave ${aircraftId}? Esta acci√≥n no se puede deshacer.`)) {
                try {
                    showNotification('Eliminando aeronave...', 'warning');
                    
                    // Crear un formulario temporal para enviar la solicitud POST
                    const form = document.createElement('form');
                    form.method = 'POST';
                    form.action = `/aeronaves/${aircraftId}/eliminar/`;
                    
                    // Agregar token CSRF
                    const csrfToken = getCSRFToken();
                    const csrfInput = document.createElement('input');
                    csrfInput.type = 'hidden';
                    csrfInput.name = 'csrfmiddlewaretoken';
                    csrfInput.value = csrfToken;
                    form.appendChild(csrfInput);
                    
                    // Agregar al documento y enviar
                    document.body.appendChild(form);
                    form.submit();
                    
                } catch (error) {
                    console.error('Error:', error);
                    showNotification('Error al eliminar la aeronave', 'error');
                }
            }
        }

        // Funciones para el modal de nueva aeronave
        async function showNewAircraftModal() {
            await loadPilotosForSelect();
            showModal('newAircraftModal');
        }

        async function loadPilotosForSelect() {
            try {
                const response = await fetch('/api/pilotos/');
                if (response.ok) {
                    const pilotos = await response.json();
                    const select = document.getElementById('piloto-select');
                    
                    // Limpiar opciones excepto la primera
                    while (select.children.length > 1) {
                        select.removeChild(select.lastChild);
                    }
                    
                    // Agregar pilotos activos
                    pilotos.forEach(piloto => {
                        if (piloto.activo) {
                            const option = document.createElement('option');
                            option.value = piloto.id;
                            option.textContent = `${piloto.nombre} (${piloto.certificacion})`;
                            select.appendChild(option);
                        }
                    });
                }
            } catch (error) {
                console.error('Error al cargar pilotos:', error);
            }
        }

        async function createAircraft(formData) {
            try {
                const response = await fetch('/api/aeronaves/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': getCSRFToken()
                    },
                    body: JSON.stringify(formData)
                });
                
                if (response.ok) {
                    const newAircraft = await response.json();
                    showNotification('Aeronave creada exitosamente', 'success');
                    closeModal('newAircraftModal');
                    await loadAircraftFromDatabase();
                    return newAircraft;
                } else {
                    const errorData = await response.json();
                    throw new Error(errorData.detail || 'Error al crear la aeronave');
                }
            } catch (error) {
                console.error('Error:', error);
                showNotification('Error al crear la aeronave: ' + error.message, 'error');
                throw error;
            }
        }

        function handleAircraftFormSubmit(e) {
            e.preventDefault();
            
            const formData = {
                matricula: document.querySelector('input[name="matricula"]').value,
                tipo_aeronave: document.querySelector('select[name="tipo_aeronave"]').value,
                modelo: document.querySelector('input[name="modelo"]').value,
                capacidad_kg: parseInt(document.querySelector('input[name="capacidad_kg"]').value),
                activo: document.querySelector('input[name="activo"]').checked,
                piloto_asignado: document.querySelector('select[name="piloto_asignado"]').value || null
            };
            
            createAircraft(formData);
        }

        // Funciones auxiliares para modals
        function showModal(modalId) {
            document.getElementById(modalId).style.display = 'block';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
            // Resetear formulario
            if (modalId === 'newAircraftModal') {
                document.getElementById('newAircraftForm').reset();
            }
        }

        // Funci√≥n auxiliar para obtener el token CSRF
        function getCSRFToken() {
            const name = 'csrftoken';
            let cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                const cookies = document.cookie.split(';');
                for (let i = 0; i < cookies.length; i++) {
                    const cookie = cookies[i].trim();
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }

        // Funci√≥n para mostrar notificaciones
        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            
            let backgroundColor = 'linear-gradient(135deg, #10b981, #059669)';
            let icon = '‚úì';
            
            if (type === 'error') {
                backgroundColor = 'linear-gradient(135deg, #ef4444, #dc2626)';
                icon = '‚ùå';
            } else if (type === 'warning') {
                backgroundColor = 'linear-gradient(135deg, #f59e0b, #d97706)';
                icon = '‚ö†Ô∏è';
            } else if (type === 'info') {
                backgroundColor = 'linear-gradient(135deg, #3b82f6, #1d4ed8)';
                icon = '‚ÑπÔ∏è';
            }
            
            notification.innerHTML = `<span style="margin-right: 8px;">${icon}</span>${message}`;
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${backgroundColor};
                color: white;
                padding: 1rem 2rem;
                border-radius: 12px;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
                z-index: 1000;
                animation: slideInRight 0.4s ease-out;
                font-weight: 600;
                display: flex;
                align-items: center;
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOutRight 0.4s ease-out';
                setTimeout(() => notification.remove(), 400);
            }, 4000);
        }

        // Inicializaci√≥n cuando se carga la p√°gina
        document.addEventListener('DOMContentLoaded', function() {
            loadAircraftFromDatabase();
            
            document.getElementById('filter-status').addEventListener('change', filterAircraft);
            document.getElementById('filter-type').addEventListener('change', filterAircraft);
            document.getElementById('search-input').addEventListener('input', filterAircraft);
            
            // Actualizado para abrir el modal
            document.getElementById('new-aircraft-btn').addEventListener('click', showNewAircraftModal);
            
            // Agregar event listener para el formulario
            document.getElementById('newAircraftForm').addEventListener('submit', handleAircraftFormSubmit);
            
            console.log('‚úàÔ∏è M√≥dulo de Aeronaves cargado exitosamente');
        });

        // Estilos para las animaciones de notificaciones
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideInRight {
                from {
                    transform: translateX(400px);
                    opacity: 0;
                }
                to {
                    transform: translateX(0);
                    opacity: 1;
                }
            }
            @keyframes slideOutRight {
                from {
                    transform: translateX(0);
                    opacity: 1;
                }
                to {
                    transform: translateX(400px);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(style);

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            });
        }
    </script>
</body>
</html>
============================================================


===== aeronave_confirm_delete.html =====
{% extends 'base.html' %}

{% block title %}Eliminar Aeronave - Log√≠stica Global{% endblock %}

{% block content %}
<div class="page-title">
    <span>üóëÔ∏è</span>
    <span>Eliminar Aeronave</span>
</div>

<div class="content-card">
    <div style="text-align: center; margin-bottom: 2rem;">
        <div style="font-size: 4rem; margin-bottom: 1rem;">‚ö†Ô∏è</div>
        <h2 style="margin-bottom: 1rem;">¬øEst√°s seguro de que deseas eliminar esta aeronave?</h2>
        <p style="color: var(--text-secondary); margin-bottom: 2rem;">
            Aeronave: {{ object.matricula }} - {{ object.modelo }}<br>
            Tipo: {{ object.tipo_aeronave }}<br>
            Esta acci√≥n no se puede deshacer.
        </p>
    </div>

    <form method="post" style="text-align: center;">
        {% csrf_token %}
        <div class="action-buttons" style="justify-content: center;">
            <button type="submit" class="btn btn-danger">S√≠, eliminar</button>
            <a href="{% url 'aeronave_detail' object.pk %}" class="btn btn-secondary">Cancelar</a>
        </div>
    </form>
</div>
{% endblock %}
============================================================


===== aeronave_editar.html =====
{% extends 'base.html' %}

{% block title %}Editar Aeronave - Log√≠stica Global{% endblock %}

{% block content %}
<div class="page-title">
    <span>‚úàÔ∏è</span>
    <span>Editar Aeronave</span>
</div>

<div class="content-card">
    <form method="post">
        {% csrf_token %}
        
        <!-- Secci√≥n 1: Informaci√≥n B√°sica -->
        <div style="margin-bottom: 2.5rem;">
            <h3 style="margin-bottom: 1.5rem; color: var(--primary); display: flex; align-items: center; gap: 0.5rem;">
                <span>üìù</span>
                <span>Informaci√≥n B√°sica</span>
            </h3>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">
                <div class="form-group">
                    <label class="form-label">Matr√≠cula *</label>
                    <input type="text" class="form-input" name="matricula" value="{{ aeronave.matricula }}" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Tipo de Aeronave *</label>
                    <input type="text" class="form-input" name="tipo_aeronave" value="{{ aeronave.tipo_aeronave }}" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Modelo *</label>
                    <input type="text" class="form-input" name="modelo" value="{{ aeronave.modelo }}" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Capacidad (kg) *</label>
                    <input type="number" class="form-input" name="capacidad_kg" value="{{ aeronave.capacidad_kg }}" required min="0">
                </div>
            </div>
        </div>

        <!-- Secci√≥n 2: Asignaciones -->
        <div style="margin-bottom: 2.5rem;">
            <h3 style="margin-bottom: 1.5rem; color: var(--primary); display: flex; align-items: center; gap: 0.5rem;">
                <span>üë®‚Äç‚úàÔ∏è</span>
                <span>Asignaciones</span>
            </h3>
            <div style="max-width: 400px;">
                <div class="form-group">
                    <label class="form-label">Piloto Asignado</label>
                    <select class="form-select" name="piloto_asignado">
                        <option value="">Sin asignar</option>
                        {% for piloto in pilotos %}
                        <option value="{{ piloto.id }}" {% if aeronave.piloto_asignado.id == piloto.id %}selected{% endif %}>
                            {{ piloto.nombre }} ({{ piloto.certificacion }})
                        </option>
                        {% endfor %}
                    </select>
                </div>
            </div>
        </div>

        <!-- Secci√≥n 3: Estado -->
        <div style="margin-bottom: 2.5rem;">
            <h3 style="margin-bottom: 1.5rem; color: var(--primary); display: flex; align-items: center; gap: 0.5rem;">
                <span>üîÑ</span>
                <span>Estado</span>
            </h3>
            <div class="form-group">
                <label class="form-label" style="display: flex; align-items: center; gap: 0.5rem;">
                    <input type="checkbox" name="activo" {% if aeronave.activo %}checked{% endif %}>
                    <span>Activa</span>
                </label>
            </div>
        </div>

        <!-- Botones de acci√≥n -->
        <div class="action-buttons">
            <button type="submit" class="btn btn-success">Actualizar Aeronave</button>
            <a href="{% url 'aeronaves' %}" class="btn btn-secondary">Cancelar</a>
        </div>
    </form>
</div>

<style>
.form-group {
    margin-bottom: 1.5rem;
}

.form-label {
    display: block;
    margin-bottom: 0.5rem;
    font-weight: 600;
    color: var(--text-primary);
}

.form-input, .form-select {
    width: 100%;
    padding: 0.8rem 1rem;
    background: rgba(30, 41, 59, 0.6);
    border: 1px solid var(--border);
    border-radius: 12px;
    color: var(--text-primary);
    font-size: 0.95rem;
}

.form-input:focus, .form-select:focus {
    outline: none;
    border-color: var(--primary);
}

.action-buttons {
    display: flex;
    gap: 1rem;
    margin-top: 2rem;
    padding-top: 1.5rem;
    border-top: 1px solid var(--border);
}

@media (max-width: 768px) {
    .content-card > div > div {
        grid-template-columns: 1fr !important;
    }
}
</style>
{% endblock %}
============================================================


===== aeronave_form.html =====
{% extends 'base.html' %}

{% block title %}{% if form.instance.pk %}Editar{% else %}Crear{% endif %} Aeronave - Log√≠stica Global{% endblock %}

{% block content %}
<div class="page-title">
    <span>‚úàÔ∏è</span>
    <span>{% if form.instance.pk %}Editar Aeronave{% else %}Nueva Aeronave{% endif %}</span>
</div>

<div class="content-card">
    <form method="post">
        {% csrf_token %}
        
        <div class="form-row">
            <div class="form-group">
                <label class="form-label" for="id_matricula">Matr√≠cula</label>
                {{ form.matricula }}
            </div>
            <div class="form-group">
                <label class="form-label" for="id_tipo_aeronave">Tipo de Aeronave</label>
                {{ form.tipo_aeronave }}
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label class="form-label" for="id_modelo">Modelo</label>
                {{ form.modelo }}
            </div>
            <div class="form-group">
                <label class="form-label" for="id_capacidad_kg">Capacidad (kg)</label>
                {{ form.capacidad_kg }}
            </div>
        </div>

        <div class="form-group">
            <label class="form-label" for="id_piloto_asignado">Piloto Asignado</label>
            {{ form.piloto_asignado }}
        </div>

        <div class="form-group">
            <label class="form-label" for="id_activo">
                {{ form.activo }} Activo
            </label>
        </div>

        <div class="action-buttons">
            <button type="submit" class="btn btn-success">
                {% if form.instance.pk %}Actualizar{% else %}Crear{% endif %} Aeronave
            </button>
            <a href="{% url 'aeronaves' %}" class="btn btn-secondary">Cancelar</a>
        </div>
    </form>
</div>
{% endblock %}
============================================================


===== api.html =====
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API - Sistema de Gesti√≥n de Transporte</title>
    <style>
        /* Todos los estilos del dashboard original */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #06b6d4;
            --accent: #f59e0b;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --info: #3b82f6;
            --bg-dark: #0f172a;
            --bg-card: #1e293b;
            --bg-hover: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --border: #334155;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--bg-dark) 0%, #1e293b 100%);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .bg-animation {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 0;
            overflow: hidden;
        }

        .bg-animation span {
            position: absolute;
            display: block;
            width: 20px;
            height: 20px;
            background: rgba(99, 102, 241, 0.1);
            animation: float 25s infinite;
            border-radius: 50%;
        }

        .bg-animation span:nth-child(1) { left: 25%; animation-delay: 0s; }
        .bg-animation span:nth-child(2) { left: 10%; animation-delay: 2s; animation-duration: 30s; }
        .bg-animation span:nth-child(3) { left: 70%; animation-delay: 4s; }
        .bg-animation span:nth-child(4) { left: 40%; animation-delay: 0s; animation-duration: 18s; }
        .bg-animation span:nth-child(5) { left: 65%; animation-delay: 0s; }
        .bg-animation span:nth-child(6) { left: 75%; animation-delay: 3s; }
        .bg-animation span:nth-child(7) { left: 35%; animation-delay: 7s; }
        .bg-animation span:nth-child(8) { left: 50%; animation-delay: 15s; animation-duration: 45s; }
        .bg-animation span:nth-child(9) { left: 20%; animation-delay: 2s; animation-duration: 35s; }
        .bg-animation span:nth-child(10) { left: 85%; animation-delay: 0s; animation-duration: 11s; }

        @keyframes float {
            0% {
                transform: translateY(100vh) scale(0);
                opacity: 0;
            }
            50% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100vh) scale(1);
                opacity: 0;
            }
        }

        .container {
            position: relative;
            z-index: 1;
            max-width: 1600px;
            margin: 0 auto;
            padding: 2.5rem 3rem;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 3rem;
            background: rgba(30, 41, 59, 0.6);
            backdrop-filter: blur(10px);
            padding: 1.5rem 2.5rem;
            border-radius: 20px;
            border: 1px solid var(--border);
            animation: slideDown 0.6s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 1rem;
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .logo-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            animation: rotate3d 3s infinite ease-in-out;
        }

        @keyframes rotate3d {
            0%, 100% { transform: rotateY(0deg); }
            50% { transform: rotateY(180deg); }
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .avatar {
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, var(--accent), var(--danger));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .avatar:hover {
            transform: scale(1.1) rotate(5deg);
        }

        .nav-menu {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .nav-item {
            padding: 0.8rem 1.5rem;
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .nav-item:hover, .nav-item.active {
            background: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(99, 102, 241, 0.4);
        }

        .page-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .api-status-card {
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.8), rgba(30, 41, 59, 0.4));
            backdrop-filter: blur(10px);
            padding: 2rem;
            border-radius: 20px;
            border: 1px solid var(--border);
            margin-bottom: 2rem;
        }

        .status-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .status-title {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .status-badge {
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: 600;
            background: rgba(16, 185, 129, 0.2);
            color: var(--success);
        }

        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .status-item {
            text-align: center;
            padding: 1.5rem;
            background: rgba(51, 65, 85, 0.3);
            border-radius: 12px;
            border: 1px solid var(--border);
        }

        .status-value {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .status-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .endpoints-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .endpoint-card {
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.8), rgba(30, 41, 59, 0.4));
            backdrop-filter: blur(10px);
            padding: 1.5rem;
            border-radius: 15px;
            border: 1px solid var(--border);
            transition: all 0.3s ease;
        }

        .endpoint-card:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
        }

        .endpoint-method {
            display: inline-block;
            padding: 0.3rem 0.8rem;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-bottom: 1rem;
        }

        .method-get {
            background: rgba(59, 130, 246, 0.2);
            color: var(--info);
        }

        .method-post {
            background: rgba(16, 185, 129, 0.2);
            color: var(--success);
        }

        .method-put {
            background: rgba(245, 158, 11, 0.2);
            color: var(--warning);
        }

        .method-delete {
            background: rgba(239, 68, 68, 0.2);
            color: var(--danger);
        }

        .endpoint-path {
            font-family: monospace;
            background: rgba(51, 65, 85, 0.5);
            padding: 0.5rem;
            border-radius: 6px;
            margin-bottom: 1rem;
            font-size: 0.9rem;
        }

        .endpoint-description {
            color: var(--text-secondary);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .btn {
            padding: 0.8rem 1.5rem;
            background: var(--primary);
            border: none;
            border-radius: 12px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(99, 102, 241, 0.4);
        }

        .btn-secondary {
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background: var(--bg-hover);
        }

        .api-keys-container {
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.8), rgba(30, 41, 59, 0.4));
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 1px solid var(--border);
            overflow: hidden;
            margin-bottom: 2rem;
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem 2rem;
            border-bottom: 1px solid var(--border);
        }

        .table-title {
            font-size: 1.3rem;
            font-weight: 600;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
        }

        .table th {
            text-align: left;
            padding: 1.2rem 1.5rem;
            background: rgba(51, 65, 85, 0.3);
            font-weight: 600;
            color: var(--text-secondary);
            border-bottom: 1px solid var(--border);
        }

        .table td {
            padding: 1.2rem 1.5rem;
            border-bottom: 1px solid var(--border);
        }

        .table tr:last-child td {
            border-bottom: none;
        }

        .table tr:hover {
            background: rgba(51, 65, 85, 0.2);
        }

        .badge {
            padding: 0.4rem 1rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .badge.active {
            background: rgba(16, 185, 129, 0.2);
            color: var(--success);
        }

        .badge.pending {
            background: rgba(245, 158, 11, 0.2);
            color: var(--accent);
        }

        .badge.alert {
            background: rgba(239, 68, 68, 0.2);
            color: var(--danger);
        }

        .badge.warning {
            background: rgba(245, 158, 11, 0.2);
            color: var(--warning);
        }

        .badge.info {
            background: rgba(59, 130, 246, 0.2);
            color: var(--info);
        }

        .action-btn {
            padding: 0.4rem 0.8rem;
            background: rgba(99, 102, 241, 0.2);
            border: 1px solid var(--primary);
            border-radius: 8px;
            color: var(--primary);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.85rem;
            margin-right: 0.5rem;
        }

        .action-btn:hover {
            background: var(--primary);
            color: white;
        }

        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }

            .header {
                flex-direction: column;
                gap: 1rem;
            }

            .status-grid, .endpoints-grid {
                grid-template-columns: 1fr;
            }

            .api-keys-container {
                overflow-x: auto;
            }

            .table {
                min-width: 800px;
            }
        }
    </style>
</head>
<body>
    <div class="bg-animation">
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
    </div>

    <div class="container">
        <div class="header">
            <div class="logo">
                <div class="logo-icon">üöö</div>
                <span>Log√≠stica Global</span>
            </div>
            <div class="user-info">
                {% if user.is_authenticated %}
                <div>
                    <div style="font-weight: 600;">{{ user.get_full_name|default:user.username }}</div>
                    <div style="font-size: 0.85rem; color: var(--text-secondary);">
                        {% if user.is_staff %}Administrador{% else %}Usuario{% endif %}
                    </div>
                </div>
                <div class="avatar" onclick="window.location.href='{% url 'logout' %}'" title="Cerrar sesi√≥n">
                    {{ user.username|slice:":2"|upper }}
                </div>
                {% else %}
                <a href="{% url 'login' %}" class="btn">Iniciar Sesi√≥n</a>
                {% endif %}
            </div>
        </div>

        <div class="nav-menu">
            <div class="nav-item" onclick="window.location.href='{% url 'dashboard' %}'">üìä Dashboard</div>
            <div class="nav-item" onclick="window.location.href='despachos.html'">üì¶ Despachos</div>
            <div class="nav-item" onclick="window.location.href='rutas.html'">üó∫Ô∏è Rutas</div>
            <div class="nav-item" onclick="window.location.href='vehiculos.html'">üöõ Veh√≠culos</div>
            <div class="nav-item" onclick="window.location.href='aeronaves.html'">‚úàÔ∏è Aeronaves</div>
            <div class="nav-item" onclick="window.location.href='conductores.html'">üë®‚Äçüíº Conductores</div>
            <div class="nav-item" onclick="window.location.href='pilotos.html'">üë®‚Äç‚úàÔ∏è Pilotos</div>
            <div class="nav-item" onclick="window.location.href='clientes.html'">üë• Clientes</div>
            <div class="nav-item" onclick="window.location.href='cargas.html'">üì¶ Cargas</div>
            <div class="nav-item" onclick="window.location.href='seguros.html'">üõ°Ô∏è Seguros</div>
            <div class="nav-item" onclick="window.location.href='reportes.html'">üìà Reportes</div>
            <div class="nav-item active" onclick="window.location.href='{% url 'api' %}'">üîó API</div>
        </div>

        <div class="page-title">
            <span>üîó</span>
            <span>API REST - Documentaci√≥n</span>
        </div>

        <div class="api-status-card">
            <div class="status-header">
                <div class="status-title">Estado del Servicio API</div>
                <div class="status-badge">üü¢ Operativo</div>
            </div>
            <div class="status-grid">
                <div class="status-item">
                    <div class="status-value">99.8%</div>
                    <div class="status-label">Disponibilidad</div>
                </div>
                <div class="status-item">
                    <div class="status-value">45 ms</div>
                    <div class="status-label">Tiempo Respuesta</div>
                </div>
                <div class="status-item">
                    <div class="status-value">1,245</div>
                    <div class="status-label">Llamadas Hoy</div>
                </div>
                <div class="status-item">
                    <div class="status-value">0</div>
                    <div class="status-label">Errores</div>
                </div>
            </div>
            <div style="display: flex; gap: 1rem;">
                <button class="btn" onclick="testAPI()">üß™ Probar API</button>
                <button class="btn btn-secondary" onclick="showDocumentation()">üìö Ver Documentaci√≥n Completa</button>
            </div>
        </div>

        <div class="endpoints-grid">
            <div class="endpoint-card">
                <div class="endpoint-method method-get">GET</div>
                <div class="endpoint-path">/api/despachos/</div>
                <div class="endpoint-description">
                    Obtener lista de despachos con filtros opcionales por estado, fecha y cliente.
                </div>
            </div>
            <div class="endpoint-card">
                <div class="endpoint-method method-post">POST</div>
                <div class="endpoint-path">/api/despachos/</div>
                <div class="endpoint-description">
                    Crear un nuevo despacho. Requiere autenticaci√≥n JWT y datos completos del despacho.
                </div>
            </div>
            <div class="endpoint-card">
                <div class="endpoint-method method-get">GET</div>
                <div class="endpoint-path">/api/despachos/{id}/</div>
                <div class="endpoint-description">
                    Obtener detalles espec√≠ficos de un despacho por ID.
                </div>
            </div>
            <div class="endpoint-card">
                <div class="endpoint-method method-put">PUT</div>
                <div class="endpoint-path">/api/despachos/{id}/</div>
                <div class="endpoint-description">
                    Actualizar un despacho existente. Campos parciales permitidos.
                </div>
            </div>
            <div class="endpoint-card">
                <div class="endpoint-method method-get">GET</div>
                <div class="endpoint-path">/api/vehiculos/</div>
                <div class="endpoint-description">
                    Listar veh√≠culos con informaci√≥n de estado, ubicaci√≥n y mantenimiento.
                </div>
            </div>
            <div class="endpoint-card">
                <div class="endpoint-method method-get">GET</div>
                <div class="endpoint-path">/api/aeronaves/</div>
                <div class="endpoint-description">
                    Obtener informaci√≥n de aeronaves, horarios de vuelo y estado operativo.
                </div>
            </div>
        </div>

        <div class="api-keys-container">
            <div class="table-header">
                <div class="table-title">Claves API</div>
                <button class="btn" onclick="generateAPIKey()">‚ûï Generar Nueva Clave</button>
            </div>
            <table class="table">
                <thead>
                    <tr>
                        <th>Nombre</th>
                        <th>Clave API</th>
                        <th>Creado</th>
                        <th>√öltimo Uso</th>
                        <th>Llamadas (30d)</th>
                        <th>Estado</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Aplicaci√≥n Web</td>
                        <td>lg_web_*****7890</td>
                        <td>15/01/2023</td>
                        <td>10/12/2023</td>
                        <td>12,458</td>
                        <td><span class="badge active">Activa</span></td>
                        <td>
                            <button class="action-btn" onclick="viewAPIKey('lg_web_*****7890')">Ver</button>
                            <button class="action-btn" onclick="revokeAPIKey('lg_web_*****7890')">Revocar</button>
                        </td>
                    </tr>
                    <tr>
                        <td>App M√≥vil</td>
                        <td>lg_mobile_*****1234</td>
                        <td>20/02/2023</td>
                        <td>09/12/2023</td>
                        <td>8,742</td>
                        <td><span class="badge active">Activa</span></td>
                        <td>
                            <button class="action-btn" onclick="viewAPIKey('lg_mobile_*****1234')">Ver</button>
                            <button class="action-btn" onclick="revokeAPIKey('lg_mobile_*****1234')">Revocar</button>
                        </td>
                    </tr>
                    <tr>
                        <td>Integraci√≥n Cliente</td>
                        <td>lg_client_*****5678</td>
                        <td>05/06/2023</td>
                        <td>05/12/2023</td>
                        <td>3,215</td>
                        <td><span class="badge warning">Inactiva</span></td>
                        <td>
                            <button class="action-btn" onclick="viewAPIKey('lg_client_*****5678')">Ver</button>
                            <button class="action-btn" onclick="revokeAPIKey('lg_client_*****5678')">Revocar</button>
                        </td>
                    </tr>
                    <tr>
                        <td>Desarrollo</td>
                        <td>lg_dev_*****9012</td>
                        <td>10/11/2023</td>
                        <td>08/12/2023</td>
                        <td>1,847</td>
                        <td><span class="badge active">Activa</span></td>
                        <td>
                            <button class="action-btn" onclick="viewAPIKey('lg_dev_*****9012')">Ver</button>
                            <button class="action-btn" onclick="revokeAPIKey('lg_dev_*****9012')">Revocar</button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <script>
        function testAPI() {
            showNotification('Probando conexi√≥n API...');
            // Simulate API test
            setTimeout(() => {
                showNotification('‚úì Conexi√≥n API exitosa - JWT activo');
            }, 1500);
        }

        function showDocumentation() {
            showNotification('Abriendo documentaci√≥n completa de la API...');
            // In a real application, this would open the full API documentation
        }

        function generateAPIKey() {
            showNotification('Generando nueva clave API...');
            // In a real application, this would generate a new API key
            setTimeout(() => {
                showNotification('‚úì Nueva clave API generada exitosamente');
            }, 2000);
        }

        function viewAPIKey(keyId) {
            showNotification(`Mostrando detalles de clave API: ${keyId}`);
            // In a real application, this would show the API key details
        }

        function revokeAPIKey(keyId) {
            if (confirm(`¬øEst√° seguro de que desea revocar la clave API ${keyId}?`)) {
                showNotification(`Revocando clave API: ${keyId}`);
                // In a real application, this would revoke the API key
                setTimeout(() => {
                    showNotification('‚úì Clave API revocada exitosamente');
                }, 2000);
            }
        }

        function showNotification(message) {
            const notification = document.createElement('div');
            notification.textContent = `‚úì ${message}`;
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: linear-gradient(135deg, #6366f1, #06b6d4);
                color: white;
                padding: 1rem 2rem;
                border-radius: 12px;
                box-shadow: 0 10px 30px rgba(99, 102, 241, 0.4);
                z-index: 1000;
                animation: slideInRight 0.4s ease-out;
                font-weight: 600;
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOutRight 0.4s ease-out';
                setTimeout(() => notification.remove(), 400);
            }, 3000);
        }

        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideInRight {
                from {
                    transform: translateX(400px);
                    opacity: 0;
                }
                to {
                    transform: translateX(0);
                    opacity: 1;
                }
            }
            @keyframes slideOutRight {
                from {
                    transform: translateX(0);
                    opacity: 1;
                }
                to {
                    transform: translateX(400px);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(style);

        console.log('üîó M√≥dulo de API cargado exitosamente');
        console.log('üìä Sistema integrado con Django REST Framework');
        console.log('üîê Autenticaci√≥n JWT activa');
        console.log('üöÄ API REST operativa');
    </script>
</body>
</html>
============================================================


===== cargas.html =====
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cargas - Sistema de Gesti√≥n de Transporte</title>
    <style>
        /* Todos los estilos del dashboard original */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #06b6d4;
            --accent: #f59e0b;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --info: #3b82f6;
            --bg-dark: #0f172a;
            --bg-card: #1e293b;
            --bg-hover: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --border: #334155;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--bg-dark) 0%, #1e293b 100%);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .bg-animation {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 0;
            overflow: hidden;
        }

        .bg-animation span {
            position: absolute;
            display: block;
            width: 20px;
            height: 20px;
            background: rgba(99, 102, 241, 0.1);
            animation: float 25s infinite;
            border-radius: 50%;
        }

        .bg-animation span:nth-child(1) { left: 25%; animation-delay: 0s; }
        .bg-animation span:nth-child(2) { left: 10%; animation-delay: 2s; animation-duration: 30s; }
        .bg-animation span:nth-child(3) { left: 70%; animation-delay: 4s; }
        .bg-animation span:nth-child(4) { left: 40%; animation-delay: 0s; animation-duration: 18s; }
        .bg-animation span:nth-child(5) { left: 65%; animation-delay: 0s; }
        .bg-animation span:nth-child(6) { left: 75%; animation-delay: 3s; }
        .bg-animation span:nth-child(7) { left: 35%; animation-delay: 7s; }
        .bg-animation span:nth-child(8) { left: 50%; animation-delay: 15s; animation-duration: 45s; }
        .bg-animation span:nth-child(9) { left: 20%; animation-delay: 2s; animation-duration: 35s; }
        .bg-animation span:nth-child(10) { left: 85%; animation-delay: 0s; animation-duration: 11s; }

        @keyframes float {
            0% {
                transform: translateY(100vh) scale(0);
                opacity: 0;
            }
            50% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100vh) scale(1);
                opacity: 0;
            }
        }

        .container {
            position: relative;
            z-index: 1;
            max-width: 1600px;
            margin: 0 auto;
            padding: 2.5rem 3rem;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 3rem;
            background: rgba(30, 41, 59, 0.6);
            backdrop-filter: blur(10px);
            padding: 1.5rem 2.5rem;
            border-radius: 20px;
            border: 1px solid var(--border);
            animation: slideDown 0.6s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 1rem;
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .logo-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            animation: rotate3d 3s infinite ease-in-out;
        }

        @keyframes rotate3d {
            0%, 100% { transform: rotateY(0deg); }
            50% { transform: rotateY(180deg); }
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .avatar {
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, var(--accent), var(--danger));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .avatar:hover {
            transform: scale(1.1) rotate(5deg);
        }

        .nav-menu {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .nav-item {
            padding: 0.8rem 1.5rem;
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .nav-item:hover, .nav-item.active {
            background: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(99, 102, 241, 0.4);
        }

        .page-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .filters {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .filter-group {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .filter-select, .search-input {
            padding: 0.8rem 1.2rem;
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 0.95rem;
            min-width: 180px;
        }

        .search-input {
            flex: 1;
            min-width: 250px;
        }

        .btn {
            padding: 0.8rem 1.5rem;
            background: var(--primary);
            border: none;
            border-radius: 12px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(99, 102, 241, 0.4);
        }

        .btn-secondary {
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background: var(--bg-hover);
        }

        .table-container {
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.8), rgba(30, 41, 59, 0.4));
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 1px solid var(--border);
            overflow: hidden;
            margin-bottom: 2rem;
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem 2rem;
            border-bottom: 1px solid var(--border);
        }

        .table-title {
            font-size: 1.3rem;
            font-weight: 600;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
        }

        .table th {
            text-align: left;
            padding: 1.2rem 1.5rem;
            background: rgba(51, 65, 85, 0.3);
            font-weight: 600;
            color: var(--text-secondary);
            border-bottom: 1px solid var(--border);
        }

        .table td {
            padding: 1.2rem 1.5rem;
            border-bottom: 1px solid var(--border);
        }

        .table tr:last-child td {
            border-bottom: none;
        }

        .table tr:hover {
            background: rgba(51, 65, 85, 0.2);
        }

        .badge {
            padding: 0.4rem 1rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .badge.entregado {
            background: rgba(16, 185, 129, 0.2);
            color: var(--success);
        }

        .badge.transito {
            background: rgba(59, 130, 246, 0.2);
            color: var(--info);
        }

        .badge.cargado {
            background: rgba(245, 158, 11, 0.2);
            color: var(--warning);
        }

        .badge.pendiente {
            background: rgba(148, 163, 184, 0.2);
            color: var(--text-secondary);
        }

        .badge.general {
            background: rgba(59, 130, 246, 0.2);
            color: var(--info);
        }

        .badge.peligrosa {
            background: rgba(239, 68, 68, 0.2);
            color: var(--danger);
        }

        .badge.refrigerada {
            background: rgba(14, 165, 233, 0.2);
            color: #38bdf8;
        }

        .badge.fragil {
            background: rgba(139, 92, 246, 0.2);
            color: #a78bfa;
        }

        .loading {
            text-align: center;
            padding: 2rem;
            color: var(--text-secondary);
        }

        .error {
            text-align: center;
            padding: 2rem;
            color: var(--danger);
            background: rgba(239, 68, 68, 0.1);
            border-radius: 12px;
            margin: 1rem 0;
        }

        .pagination {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem 2rem;
            border-top: 1px solid var(--border);
        }

        .pagination-info {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .pagination-controls {
            display: flex;
            gap: 0.5rem;
        }

        .pagination-btn {
            padding: 0.6rem 1rem;
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .pagination-btn:hover {
            background: var(--primary);
        }

        .pagination-btn.active {
            background: var(--primary);
        }

        .action-btn {
            padding: 0.4rem 0.8rem;
            background: rgba(99, 102, 241, 0.2);
            border: 1px solid var(--primary);
            border-radius: 8px;
            color: var(--primary);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.85rem;
            margin-right: 0.5rem;
        }

        .action-btn:hover {
            background: var(--primary);
            color: white;
        }

        .action-btn.delete {
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid var(--danger);
            color: var(--danger);
        }

        .action-btn.delete:hover {
            background: var(--danger);
            color: white;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--bg-card);
            padding: 2rem;
            border-radius: 20px;
            border: 1px solid var(--border);
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .close-modal {
            position: absolute;
            top: 1rem;
            right: 1rem;
            cursor: pointer;
            font-size: 1.5rem;
            color: var(--text-secondary);
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .form-input, .form-select {
            width: 100%;
            padding: 0.8rem 1rem;
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 0.95rem;
        }

        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: var(--primary);
        }

        .form-row {
            display: flex;
            gap: 1rem;
        }

        .form-row .form-group {
            flex: 1;
        }

        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }

            .header {
                flex-direction: column;
                gap: 1rem;
            }

            .filters {
                flex-direction: column;
            }

            .filter-group {
                width: 100%;
            }

            .filter-select, .search-input {
                min-width: 100%;
            }

            .table-container {
                overflow-x: auto;
            }

            .table {
                min-width: 800px;
            }

            .form-row {
                flex-direction: column;
                gap: 0;
            }
        }
    </style>
</head>
<body>
    <div class="bg-animation">
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
    </div>

    <div class="container">
        <div class="header">
            <div class="logo">
                <div class="logo-icon">üöö</div>
                <span>Log√≠stica Global</span>
            </div>
            <div class="user-info">
                {% if user.is_authenticated %}
                <div>
                    <div style="font-weight: 600;">{{ user.get_full_name|default:user.username }}</div>
                    <div style="font-size: 0.85rem; color: var(--text-secondary);">
                        {% if user.is_staff %}Administrador{% else %}Usuario{% endif %}
                    </div>
                </div>
                <div class="avatar" onclick="window.location.href='{% url 'logout' %}'" title="Cerrar sesi√≥n">
                    {{ user.username|slice:":2"|upper }}
                </div>
                {% else %}
                <a href="{% url 'login' %}" class="btn">Iniciar Sesi√≥n</a>
                {% endif %}
            </div>
        </div>

        <div class="nav-menu">
            <div class="nav-item" onclick="window.location.href='{% url 'dashboard' %}'">üìä Dashboard</div>
            <div class="nav-item" onclick="window.location.href='{% url 'despachos' %}'">üì¶ Despachos</div>
            <div class="nav-item" onclick="window.location.href='{% url 'rutas' %}'">üó∫Ô∏è Rutas</div>
            <div class="nav-item" onclick="window.location.href='{% url 'vehiculos' %}'">üöõ Veh√≠culos</div>
            <div class="nav-item" onclick="window.location.href='{% url 'aeronaves' %}'">‚úàÔ∏è Aeronaves</div>
            <div class="nav-item" onclick="window.location.href='{% url 'conductores' %}'">üë®‚Äçüíº Conductores</div>
            <div class="nav-item" onclick="window.location.href='{% url 'pilotos' %}'">üë®‚Äç‚úàÔ∏è Pilotos</div>
            <div class="nav-item" onclick="window.location.href='{% url 'clientes' %}'">üë• Clientes</div>
            <div class="nav-item active" onclick="window.location.href='{% url 'cargas' %}'">üì¶ Cargas</div>
            <div class="nav-item" onclick="window.location.href='{% url 'seguros' %}'">üõ°Ô∏è Seguros</div>
            <div class="nav-item" onclick="window.location.href='{% url 'reportes' %}'">üìà Reportes</div>
            <div class="nav-item" onclick="window.location.href='{% url 'api' %}'">üîó API</div>
        </div>

        <!-- BLOQUE DE PERMISOS PARA NO-ADMIN -->
        {% if user.is_authenticated and user.perfilusuario.tipo_usuario != 'ADMIN' %}
        <style>
            #new-cargo-btn,
            .btn[onclick*="crear"],
            .btn[onclick*="editar"],
            .btn[onclick*="eliminar"],
            .action-btn.delete,
            .btn-danger {
                display: none !important;
            }
        </style>
        
        <div style="background: rgba(59, 130, 246, 0.2); border: 1px solid #3b82f6; border-radius: 12px; padding: 1rem; margin-bottom: 1.5rem;">
            <div style="display: flex; align-items: center; gap: 0.5rem; color: #3b82f6;">
                <span>üîí</span>
                <div>
                    <strong>Modo Solo Lectura</strong>
                    <div style="font-size: 0.9rem; opacity: 0.9;">
                        Como {{ user.perfilusuario.tipo_usuario|title }}, solo puedes visualizar informaci√≥n de cargas.
                    </div>
                </div>
            </div>
        </div>
        {% endif %}

        <!-- Mensajes del sistema -->
        {% if messages %}
            {% for message in messages %}
            <div class="alert alert-{{ message.tags }}">
                {{ message }}
            </div>
            {% endfor %}
        {% endif %}

        <div class="page-title">
            <span>üì¶</span>
            <span>Gesti√≥n de Cargas</span>
        </div>

        <div class="filters">
            <div class="filter-group">
                <select class="filter-select" id="filter-status">
                    <option value="">Todos los estados</option>
                    <option value="pendiente">Pendiente</option>
                    <option value="cargado">Cargado</option>
                    <option value="transito">En tr√°nsito</option>
                    <option value="entregado">Entregado</option>
                </select>
                <select class="filter-select" id="filter-type">
                    <option value="">Todos los tipos</option>
                    <option value="general">General</option>
                    <option value="peligrosa">Peligrosa</option>
                    <option value="refrigerada">Refrigerada</option>
                    <option value="fragil">Fr√°gil</option>
                </select>
            </div>
            <input type="text" class="search-input" id="search-input" placeholder="Buscar carga...">
            <button class="btn" id="new-cargo-btn">‚ûï Nueva Carga</button>
        </div>

        <div class="table-container">
            <div class="table-header">
                <div class="table-title">Lista de Cargas</div>
                <div id="cargo-count" style="color: var(--text-secondary); font-size: 0.9rem;">Cargando...</div>
            </div>
            <table class="table">
                <thead>
                    <tr>
                        <th>ID Carga</th>
                        <th>Descripci√≥n</th>
                        <th>Tipo</th>
                        <th>Peso (kg)</th>
                        <th>Volumen (m¬≥)</th>
                        <th>Valor Declarado</th>
                        <th>Cliente</th>
                        <th>Estado</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody id="cargos-table-body">
                    <tr>
                        <td colspan="9" class="loading">Cargando datos de cargas desde la base de datos...</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div id="newCargaModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal('newCargaModal')">&times;</span>
            <h3>Nueva Carga</h3>
            <form id="newCargaForm">
                <div class="form-group">
                    <label class="form-label">Descripci√≥n</label>
                    <input type="text" class="form-input" name="descripcion" required>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Tipo de Carga</label>
                        <select class="form-select" name="tipo_carga" required>
                            <option value="">Seleccionar tipo</option>
                            <option value="General">General</option>
                            <option value="Peligrosa">Peligrosa</option>
                            <option value="Refrigerada">Refrigerada</option>
                            <option value="Fr√°gil">Fr√°gil</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Cliente</label>
                        <select class="form-select" name="cliente" id="cliente-select" required>
                            <option value="">Seleccionar cliente</option>
                            <!-- Los clientes se cargar√°n din√°micamente -->
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Peso (kg)</label>
                        <input type="number" class="form-input" name="peso_kg" step="0.01" required min="0">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Volumen (m¬≥)</label>
                        <input type="number" class="form-input" name="volumen_m3" step="0.01" required min="0">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Valor Declarado</label>
                        <input type="number" class="form-input" name="valor_declarado" step="0.01" placeholder="$" required min="0">
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">Notas Especiales</label>
                    <textarea class="form-input" name="notas_especiales" rows="3"></textarea>
                </div>
                <div style="margin-top: 2rem; display: flex; gap: 1rem; justify-content: flex-end;">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('newCargaModal')">Cancelar</button>
                    <button type="submit" class="btn">Crear Carga</button>
                </div>
            </form>
        </div>
    </div>

    <div id="viewCargaModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal('viewCargaModal')">&times;</span>
            <h3 id="viewCargaTitle">Detalles de la Carga</h3>
            <div id="viewCargaContent"></div>
        </div>
    </div>

    <script>
        // Variable global para almacenar las cargas
        let cargosData = [];

        // Funci√≥n para cargar cargas desde la base de datos
        async function loadCargosFromDatabase() {
            try {
                showLoadingState();
                
                const response = await fetch('/api/cargas/');
                
                if (!response.ok) {
                    throw new Error('Error al cargar las cargas');
                }
                
                cargosData = await response.json();
                renderCargosTable(cargosData);
                showNotification('Datos de cargas cargados correctamente');
                
            } catch (error) {
                console.error('Error:', error);
                showErrorState('Error al cargar las cargas: ' + error.message);
            }
        }

        // Funci√≥n para mostrar estado de carga
        function showLoadingState() {
            const tableBody = document.getElementById('cargos-table-body');
            tableBody.innerHTML = `
                <tr>
                    <td colspan="9" class="loading">Cargando datos de cargas desde la base de datos...</td>
                </tr>
            `;
            document.getElementById('cargo-count').textContent = 'Cargando...';
        }

        // Funci√≥n para mostrar estado de error
        function showErrorState(message) {
            const tableBody = document.getElementById('cargos-table-body');
            tableBody.innerHTML = `
                <tr>
                    <td colspan="9">
                        <div class="error">
                            ${message}
                            <br>
                            <button class="btn" onclick="loadCargosFromDatabase()" style="margin-top: 1rem;">
                                Reintentar
                            </button>
                        </div>
                    </td>
                </tr>
            `;
            document.getElementById('cargo-count').textContent = 'Error';
        }

        // Funci√≥n para simular estado (ya que no existe en el modelo Carga)
        function getCargoStatus(cargoId) {
            const statuses = ['pendiente', 'cargado', 'transito', 'entregado'];
            return statuses[cargoId % statuses.length];
        }

        // Funci√≥n para formatear moneda
        function formatCurrency(amount) {
            if (!amount) return 'N/A';
            return new Intl.NumberFormat('es-CL', {
                style: 'currency',
                currency: 'CLP'
            }).format(amount);
        }

        // Funci√≥n para renderizar la tabla de cargas
        function renderCargosTable(cargos) {
            const tableBody = document.getElementById('cargos-table-body');
            const cargoCount = document.getElementById('cargo-count');
            
            if (cargos.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="9" class="loading">No se encontraron cargas en la base de datos</td>
                    </tr>
                `;
                cargoCount.textContent = 'Total: 0 cargas';
                return;
            }
            
            tableBody.innerHTML = '';
            cargoCount.textContent = `Total: ${cargos.length} cargas`;
            
            cargos.forEach(cargo => {
                const row = document.createElement('tr');
                
                // USAR CAMPOS REALES DE LA BASE DE DATOS
                const status = getCargoStatus(cargo.id); // Estado simulado
                
                let statusClass = '';
                let statusText = '';
                
                switch (status) {
                    case 'entregado':
                        statusClass = 'entregado';
                        statusText = 'Entregado';
                        break;
                    case 'transito':
                        statusClass = 'transito';
                        statusText = 'En tr√°nsito';
                        break;
                    case 'cargado':
                        statusClass = 'cargado';
                        statusText = 'Cargado';
                        break;
                    case 'pendiente':
                        statusClass = 'pendiente';
                        statusText = 'Pendiente';
                        break;
                    default:
                        statusClass = 'pendiente';
                        statusText = 'Pendiente';
                }

                // Tipo basado en campo real 'tipo_carga'
                let typeClass = '';
                let typeText = cargo.tipo_carga || 'General';
                
                switch (cargo.tipo_carga?.toLowerCase()) {
                    case 'peligrosa':
                        typeClass = 'peligrosa';
                        break;
                    case 'refrigerada':
                        typeClass = 'refrigerada';
                        break;
                    case 'fr√°gil':
                    case 'fragil':
                        typeClass = 'fragil';
                        break;
                    default:
                        typeClass = 'general';
                }
                
                // Obtener nombre del cliente
                const clienteNombre = cargo.cliente ? 
                    (cargo.cliente_razon_social || cargo.cliente.razon_social || 'Cliente') : 
                    'N/A';
                
                row.innerHTML = `
                    <td>${cargo.id || 'N/A'}</td>
                    <td>${cargo.descripcion || 'N/A'}</td>
                    <td><span class="badge ${typeClass}">${typeText}</span></td>
                    <td>${cargo.peso_kg ? cargo.peso_kg + ' kg' : 'N/A'}</td>
                    <td>${cargo.volumen_m3 ? cargo.volumen_m3 + ' m¬≥' : 'N/A'}</td>
                    <td>${formatCurrency(cargo.valor_declarado)}</td>
                    <td>${clienteNombre}</td>
                    <td><span class="badge ${statusClass}">${statusText}</span></td>
                    <td>
                        <button class="action-btn" onclick="viewCargo(${cargo.id})">Ver</button>
                        <button class="action-btn" onclick="window.location.href='/cargas/${cargo.id}/editar/'">Editar</button>
                        <button class="action-btn delete" onclick="deleteCargo(${cargo.id})">Eliminar</button>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
        }

        // Funci√≥n para filtrar cargas
        function filterCargos() {
            const statusFilter = document.getElementById('filter-status').value;
            const typeFilter = document.getElementById('filter-type').value;
            const searchText = document.getElementById('search-input').value.toLowerCase();
            
            const filteredCargos = cargosData.filter(cargo => {
                // Estado simulado
                const status = getCargoStatus(cargo.id);
                const matchesStatus = !statusFilter || status === statusFilter;
                
                // Tipo real
                const matchesType = !typeFilter || 
                    (cargo.tipo_carga && cargo.tipo_carga.toLowerCase().includes(typeFilter.toLowerCase()));
                
                // B√∫squeda
                const matchesSearch = !searchText || 
                    (cargo.descripcion && cargo.descripcion.toLowerCase().includes(searchText)) ||
                    (cargo.cliente_razon_social && cargo.cliente_razon_social.toLowerCase().includes(searchText)) ||
                    (cargo.id && cargo.id.toString().includes(searchText));
                
                return matchesStatus && matchesType && matchesSearch;
            });
            
            renderCargosTable(filteredCargos);
        }

        // Funciones de acci√≥n para las cargas
        async function viewCargo(cargoId) {
            try {
                const response = await fetch(`/api/cargas/${cargoId}/`);
                const cargoDetails = await response.json();
                
                showNotification(`Viendo detalles de la carga ${cargoId}`);
                
                // Mostrar detalles en modal
                document.getElementById('viewCargaTitle').textContent = `Detalles de Carga #${cargoId}`;
                document.getElementById('viewCargaContent').innerHTML = `
                    <div style="display: grid; gap: 1rem;">
                        <div><strong>Descripci√≥n:</strong> ${cargoDetails.descripcion || 'N/A'}</div>
                        <div><strong>Tipo:</strong> ${cargoDetails.tipo_carga || 'N/A'}</div>
                        <div><strong>Peso:</strong> ${cargoDetails.peso_kg || 'N/A'} kg</div>
                        <div><strong>Volumen:</strong> ${cargoDetails.volumen_m3 || 'N/A'} m¬≥</div>
                        <div><strong>Valor Declarado:</strong> ${formatCurrency(cargoDetails.valor_declarado)}</div>
                        <div><strong>Cliente:</strong> ${cargoDetails.cliente_razon_social || 'N/A'}</div>
                        <div><strong>Notas:</strong> ${cargoDetails.notas_especiales || 'Sin notas especiales'}</div>
                    </div>
                `;
                showModal('viewCargaModal');
                
            } catch (error) {
                console.error('Error al obtener detalles:', error);
                showNotification('Error al cargar detalles de la carga');
            }
        }

        async function editCargo(cargoId) {
            showNotification(`Editando la carga ${cargoId}`);
            // Redirigir a p√°gina de edici√≥n
            window.location.href = `/cargas/${cargoId}/editar/`;
        }

        async function deleteCargo(cargoId) {
            if (confirm('¬øEst√° seguro de que desea eliminar esta carga?')) {
                try {
                    const response = await fetch(`/api/cargas/${cargoId}/`, {
                        method: 'DELETE',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-CSRFToken': getCSRFToken()
                        }
                    });
                    
                    if (response.ok) {
                        await loadCargosFromDatabase();
                        showNotification('Carga eliminada correctamente');
                    } else {
                        throw new Error('Error al eliminar la carga');
                    }
                } catch (error) {
                    console.error('Error:', error);
                    showNotification('Error al eliminar la carga');
                }
            }
        }

        // FUNCIONES NUEVAS PARA CREAR CARGAS
        async function loadClientesForSelect() {
            try {
                const response = await fetch('/api/clientes/');
                if (response.ok) {
                    const clientes = await response.json();
                    const select = document.getElementById('cliente-select');
                    
                    // Limpiar opciones excepto la primera
                    while (select.children.length > 1) {
                        select.removeChild(select.lastChild);
                    }
                    
                    // Agregar clientes activos
                    clientes.forEach(cliente => {
                        if (cliente.activo) {
                            const option = document.createElement('option');
                            option.value = cliente.id;
                            option.textContent = cliente.razon_social || cliente.nombre || `Cliente ${cliente.id}`;
                            select.appendChild(option);
                        }
                    });
                }
            } catch (error) {
                console.error('Error al cargar clientes:', error);
                // Si hay error, mostrar opciones de ejemplo
                const select = document.getElementById('cliente-select');
                const option = document.createElement('option');
                option.value = "1";
                option.textContent = "Cliente de Ejemplo";
                select.appendChild(option);
            }
        }

        async function createCarga(formData) {
            try {
                const response = await fetch('/api/cargas/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': getCSRFToken()
                    },
                    body: JSON.stringify(formData)
                });
                
                if (response.ok) {
                    const newCarga = await response.json();
                    showNotification('Carga creada exitosamente');
                    closeModal('newCargaModal');
                    await loadCargosFromDatabase(); // Recargar la lista
                    return newCarga;
                } else {
                    const errorData = await response.json();
                    throw new Error(errorData.detail || 'Error al crear la carga');
                }
            } catch (error) {
                console.error('Error:', error);
                showNotification('Error al crear la carga: ' + error.message);
                throw error;
            }
        }

        function handleCargaFormSubmit(e) {
            e.preventDefault();
            
            const form = e.target;
            const formData = {
                descripcion: form.querySelector('input[name="descripcion"]').value,
                tipo_carga: form.querySelector('select[name="tipo_carga"]').value,
                peso_kg: parseFloat(form.querySelector('input[name="peso_kg"]').value),
                volumen_m3: parseFloat(form.querySelector('input[name="volumen_m3"]').value),
                valor_declarado: parseFloat(form.querySelector('input[name="valor_declarado"]').value),
                cliente: form.querySelector('select[name="cliente"]').value,
                notas_especiales: form.querySelector('textarea[name="notas_especiales"]').value
            };
            
            createCarga(formData);
        }

        async function showNewCargaModal() {
            await loadClientesForSelect();
            showModal('newCargaModal');
        }

        // Funci√≥n auxiliar para obtener el token CSRF
        function getCSRFToken() {
            const name = 'csrftoken';
            let cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                const cookies = document.cookie.split(';');
                for (let i = 0; i < cookies.length; i++) {
                    const cookie = cookies[i].trim();
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }

        // Modal Functions
        function showModal(modalId) {
            document.getElementById(modalId).style.display = 'block';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
            // Resetear formulario
            if (modalId === 'newCargaModal') {
                document.getElementById('newCargaForm').reset();
            }
        }

        // Notification System
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.textContent = `‚úì ${message}`;
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: linear-gradient(135deg, #6366f1, #06b6d4);
                color: white;
                padding: 1rem 2rem;
                border-radius: 12px;
                box-shadow: 0 10px 30px rgba(99, 102, 241, 0.4);
                z-index: 1000;
                animation: slideInRight 0.4s ease-out;
                font-weight: 600;
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOutRight 0.4s ease-out';
                setTimeout(() => notification.remove(), 400);
            }, 3000);
        }

        // Inicializaci√≥n cuando se carga la p√°gina
        document.addEventListener('DOMContentLoaded', function() {
            loadCargosFromDatabase();
            
            document.getElementById('filter-status').addEventListener('change', filterCargos);
            document.getElementById('filter-type').addEventListener('change', filterCargos);
            document.getElementById('search-input').addEventListener('input', filterCargos);
            
            // Actualizado para abrir el modal y cargar clientes
            document.getElementById('new-cargo-btn').addEventListener('click', showNewCargaModal);
            
            // Agregar event listener para el formulario
            document.getElementById('newCargaForm').addEventListener('submit', handleCargaFormSubmit);
            
            console.log('üì¶ M√≥dulo de Cargas cargado exitosamente');
        });

        // Estilos para las animaciones de notificaciones
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideInRight {
                from {
                    transform: translateX(400px);
                    opacity: 0;
                }
                to {
                    transform: translateX(0);
                    opacity: 1;
                }
            }
            @keyframes slideOutRight {
                from {
                    transform: translateX(0);
                    opacity: 1;
                }
                to {
                    transform: translateX(400px);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(style);

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            });
        }
    </script>
</body>
</html>
============================================================


===== carga_confirm_delete.html =====
{% extends 'base.html' %}

{% block title %}Eliminar Carga - Log√≠stica Global{% endblock %}

{% block content %}
<div class="page-title">
    <span>üóëÔ∏è</span>
    <span>Eliminar Carga</span>
</div>

<div class="content-card">
    <div style="text-align: center; margin-bottom: 2rem;">
        <div style="font-size: 4rem; margin-bottom: 1rem;">‚ö†Ô∏è</div>
        <h2 style="margin-bottom: 1rem;">¬øEst√°s seguro de que deseas eliminar esta carga?</h2>
        <p style="color: var(--text-secondary); margin-bottom: 2rem;">
            Carga: {{ carga.descripcion }}<br>
            Tipo: {{ carga.tipo_carga }}<br>
            Peso: {{ carga.peso_kg }} kg<br>
            Esta acci√≥n no se puede deshacer.
        </p>
    </div>

    <form method="post" style="text-align: center;">
        {% csrf_token %}
        <div class="action-buttons" style="justify-content: center;">
            <button type="submit" class="btn btn-danger">S√≠, eliminar</button>
            <a href="{% url 'cargas' %}" class="btn btn-secondary">Cancelar</a>
        </div>
    </form>
</div>
{% endblock %}
============================================================


===== carga_detail.html =====
{% extends 'base.html' %}

{% block title %}Carga {{ carga.descripcion }} - Log√≠stica Global{% endblock %}

{% block content %}
<div class="page-title">
    <span>üì¶</span>
    <span>Carga {{ carga.descripcion }}</span>
</div>

<div class="content-card">
    <div class="detail-grid">
        <div class="detail-item">
            <div class="detail-label">ID</div>
            <div class="detail-value">{{ carga.id }}</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Descripci√≥n</div>
            <div class="detail-value">{{ carga.descripcion }}</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Tipo de Carga</div>
            <div class="detail-value">{{ carga.tipo_carga }}</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Peso</div>
            <div class="detail-value">{{ carga.peso_kg }} kg</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Volumen</div>
            <div class="detail-value">{{ carga.volumen_m3 }} m¬≥</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Valor Declarado</div>
            <div class="detail-value">${{ carga.valor_declarado }}</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Cliente</div>
            <div class="detail-value">{{ carga.cliente.razon_social }}</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Notas Especiales</div>
            <div class="detail-value">
                {% if carga.notas_especiales %}
                    {{ carga.notas_especiales }}
                {% else %}
                    <span style="color: var(--text-secondary);">Sin notas especiales</span>
                {% endif %}
            </div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Despachos Asociados</div>
            <div class="detail-value">{{ carga.despacho_set.count }}</div>
        </div>
    </div>

    <div class="action-buttons">
        <a href="{% url 'carga_editar' carga.pk %}" class="btn">Editar</a>
        <a href="{% url 'carga_eliminar' carga.pk %}" class="btn btn-danger">Eliminar</a>
        <a href="{% url 'cargas' %}" class="btn btn-secondary">Volver a la lista</a>
    </div>
</div>
{% endblock %}
============================================================


===== carga_editar.html =====
{% extends 'base.html' %}

{% block title %}Editar Carga - Log√≠stica Global{% endblock %}

{% block content %}
<div class="page-title">
    <span>üì¶</span>
    <span>Editar Carga</span>
</div>

<div class="content-card">
    <form method="post">
        {% csrf_token %}
        
        <!-- Secci√≥n 1: Informaci√≥n General -->
        <div style="margin-bottom: 2.5rem;">
            <h3 style="margin-bottom: 1.5rem; color: var(--primary); display: flex; align-items: center; gap: 0.5rem;">
                <span>üìã</span>
                <span>Informaci√≥n General</span>
            </h3>
            <div style="display: grid; grid-template-columns: 1fr; gap: 1.5rem;">
                <div class="form-group">
                    <label class="form-label">Descripci√≥n *</label>
                    <input type="text" class="form-input" name="descripcion" value="{{ carga.descripcion }}" required>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">
                    <div class="form-group">
                        <label class="form-label">Tipo de Carga *</label>
                        <select class="form-select" name="tipo_carga" required>
                            <option value="General" {% if carga.tipo_carga == 'General' %}selected{% endif %}>General</option>
                            <option value="Peligrosa" {% if carga.tipo_carga == 'Peligrosa' %}selected{% endif %}>Peligrosa</option>
                            <option value="Refrigerada" {% if carga.tipo_carga == 'Refrigerada' %}selected{% endif %}>Refrigerada</option>
                            <option value="Fr√°gil" {% if carga.tipo_carga == 'Fr√°gil' %}selected{% endif %}>Fr√°gil</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Cliente *</label>
                        <select class="form-select" name="cliente" required>
                            {% for cliente in clientes %}
                            <option value="{{ cliente.id }}" {% if carga.cliente.id == cliente.id %}selected{% endif %}>
                                {{ cliente.razon_social|default:cliente.nombre }}
                            </option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
            </div>
        </div>

        <!-- Secci√≥n 2: Especificaciones -->
        <div style="margin-bottom: 2.5rem;">
            <h3 style="margin-bottom: 1.5rem; color: var(--primary); display: flex; align-items: center; gap: 0.5rem;">
                <span>‚öñÔ∏è</span>
                <span>Especificaciones</span>
            </h3>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">
                <div class="form-group">
                    <label class="form-label">Peso (kg) *</label>
                    <input type="number" class="form-input" name="peso_kg" value="{{ carga.peso_kg }}" step="0.01" required min="0">
                </div>
                <div class="form-group">
                    <label class="form-label">Volumen (m¬≥) *</label>
                    <input type="number" class="form-input" name="volumen_m3" value="{{ carga.volumen_m3 }}" step="0.01" required min="0">
                </div>
                <div class="form-group">
                    <label class="form-label">Valor Declarado ($) *</label>
                    <input type="number" class="form-input" name="valor_declarado" value="{{ carga.valor_declarado }}" step="0.01" required min="0">
                </div>
            </div>
        </div>

        <!-- Secci√≥n 3: Informaci√≥n Adicional -->
        <div style="margin-bottom: 2.5rem;">
            <h3 style="margin-bottom: 1.5rem; color: var(--primary); display: flex; align-items: center; gap: 0.5rem;">
                <span>üìù</span>
                <span>Informaci√≥n Adicional</span>
            </h3>
            <div class="form-group">
                <label class="form-label">Notas Especiales</label>
                <textarea class="form-input" name="notas_especiales" rows="4">{{ carga.notas_especiales|default:'' }}</textarea>
            </div>
        </div>

        <!-- Botones de acci√≥n -->
        <div class="action-buttons">
            <button type="submit" class="btn btn-success">Actualizar Carga</button>
            <a href="{% url 'cargas' %}" class="btn btn-secondary">Cancelar</a>
        </div>
    </form>
</div>

<style>
.form-group {
    margin-bottom: 1.5rem;
}

.form-label {
    display: block;
    margin-bottom: 0.5rem;
    font-weight: 600;
    color: var(--text-primary);
}

.form-input, .form-select, .form-textarea {
    width: 100%;
    padding: 0.8rem 1rem;
    background: rgba(30, 41, 59, 0.6);
    border: 1px solid var(--border);
    border-radius: 12px;
    color: var(--text-primary);
    font-size: 0.95rem;
}

.form-input:focus, .form-select:focus, .form-textarea:focus {
    outline: none;
    border-color: var(--primary);
}

.form-textarea {
    resize: vertical;
    min-height: 100px;
}

.action-buttons {
    display: flex;
    gap: 1rem;
    margin-top: 2rem;
    padding-top: 1.5rem;
    border-top: 1px solid var(--border);
}

@media (max-width: 768px) {
    .content-card > div > div {
        grid-template-columns: 1fr !important;
    }
}
</style>
{% endblock %}
============================================================


===== carga_form.html =====
{% extends 'base.html' %}

{% block title %}Nueva Carga - Log√≠stica Global{% endblock %}

{% block content %}
<div class="page-title">
    <span>üì¶</span>
    <span>Nueva Carga</span>
</div>

<div class="content-card">
    <form method="post">
        {% csrf_token %}
        
        <div class="form-group">
            <label class="form-label">Descripci√≥n *</label>
            <input type="text" class="form-input" name="descripcion" required>
        </div>
        
        <div class="form-group">
            <label class="form-label">Tipo de Carga *</label>
            <select class="form-select" name="tipo_carga" required>
                <option value="">Seleccionar tipo</option>
                <option value="General">General</option>
                <option value="Peligrosa">Peligrosa</option>
                <option value="Refrigerada">Refrigerada</option>
                <option value="Fr√°gil">Fr√°gil</option>
            </select>
        </div>
        
        <div class="form-group">
            <label class="form-label">Peso (kg) *</label>
            <input type="number" class="form-input" name="peso_kg" step="0.01" required min="0">
        </div>
        
        <div class="form-group">
            <label class="form-label">Volumen (m¬≥) *</label>
            <input type="number" class="form-input" name="volumen_m3" step="0.01" required min="0">
        </div>
        
        <div class="form-group">
            <label class="form-label">Valor Declarado *</label>
            <input type="number" class="form-input" name="valor_declarado" step="0.01" required min="0">
        </div>
        
        <div class="form-group">
            <label class="form-label">Cliente *</label>
            <select class="form-select" name="cliente" required>
                <option value="">Seleccionar cliente</option>
                {% for cliente in clientes %}
                <option value="{{ cliente.id }}">{{ cliente.razon_social|default:cliente.nombre }}</option>
                {% endfor %}
            </select>
        </div>
        
        <div class="form-group">
            <label class="form-label">Notas Especiales</label>
            <textarea class="form-input" name="notas_especiales" rows="3"></textarea>
        </div>
        
        <div class="action-buttons">
            <button type="submit" class="btn">Crear Carga</button>
            <a href="{% url 'cargas' %}" class="btn btn-secondary">Cancelar</a>
        </div>
    </form>
</div>
{% endblock %}
============================================================


===== clientes.html =====
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clientes - Sistema de Gesti√≥n de Transporte</title>
    <style>
        /* Todos los estilos del dashboard original */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #06b6d4;
            --accent: #f59e0b;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --info: #3b82f6;
            --bg-dark: #0f172a;
            --bg-card: #1e293b;
            --bg-hover: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --border: #334155;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--bg-dark) 0%, #1e293b 100%);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .bg-animation {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 0;
            overflow: hidden;
        }

        .bg-animation span {
            position: absolute;
            display: block;
            width: 20px;
            height: 20px;
            background: rgba(99, 102, 241, 0.1);
            animation: float 25s infinite;
            border-radius: 50%;
        }

        .bg-animation span:nth-child(1) { left: 25%; animation-delay: 0s; }
        .bg-animation span:nth-child(2) { left: 10%; animation-delay: 2s; animation-duration: 30s; }
        .bg-animation span:nth-child(3) { left: 70%; animation-delay: 4s; }
        .bg-animation span:nth-child(4) { left: 40%; animation-delay: 0s; animation-duration: 18s; }
        .bg-animation span:nth-child(5) { left: 65%; animation-delay: 0s; }
        .bg-animation span:nth-child(6) { left: 75%; animation-delay: 3s; }
        .bg-animation span:nth-child(7) { left: 35%; animation-delay: 7s; }
        .bg-animation span:nth-child(8) { left: 50%; animation-delay: 15s; animation-duration: 45s; }
        .bg-animation span:nth-child(9) { left: 20%; animation-delay: 2s; animation-duration: 35s; }
        .bg-animation span:nth-child(10) { left: 85%; animation-delay: 0s; animation-duration: 11s; }

        @keyframes float {
            0% {
                transform: translateY(100vh) scale(0);
                opacity: 0;
            }
            50% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100vh) scale(1);
                opacity: 0;
            }
        }

        .container {
            position: relative;
            z-index: 1;
            max-width: 1600px;
            margin: 0 auto;
            padding: 2.5rem 3rem;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 3rem;
            background: rgba(30, 41, 59, 0.6);
            backdrop-filter: blur(10px);
            padding: 1.5rem 2.5rem;
            border-radius: 20px;
            border: 1px solid var(--border);
            animation: slideDown 0.6s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 1rem;
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .logo-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            animation: rotate3d 3s infinite ease-in-out;
        }

        @keyframes rotate3d {
            0%, 100% { transform: rotateY(0deg); }
            50% { transform: rotateY(180deg); }
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .avatar {
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, var(--accent), var(--danger));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .avatar:hover {
            transform: scale(1.1) rotate(5deg);
        }

        .nav-menu {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .nav-item {
            padding: 0.8rem 1.5rem;
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .nav-item:hover, .nav-item.active {
            background: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(99, 102, 241, 0.4);
        }

        .page-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .filters {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .filter-group {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .filter-select, .search-input {
            padding: 0.8rem 1.2rem;
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 0.95rem;
            min-width: 180px;
        }

        .search-input {
            flex: 1;
            min-width: 250px;
        }

        .btn {
            padding: 0.8rem 1.5rem;
            background: var(--primary);
            border: none;
            border-radius: 12px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(99, 102, 241, 0.4);
        }

        .btn-secondary {
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background: var(--bg-hover);
        }

        .table-container {
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.8), rgba(30, 41, 59, 0.4));
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 1px solid var(--border);
            overflow: hidden;
            margin-bottom: 2rem;
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem 2rem;
            border-bottom: 1px solid var(--border);
        }

        .table-title {
            font-size: 1.3rem;
            font-weight: 600;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
        }

        .table th {
            text-align: left;
            padding: 1.2rem 1.5rem;
            background: rgba(51, 65, 85, 0.3);
            font-weight: 600;
            color: var(--text-secondary);
            border-bottom: 1px solid var(--border);
        }

        .table td {
            padding: 1.2rem 1.5rem;
            border-bottom: 1px solid var(--border);
        }

        .table tr:last-child td {
            border-bottom: none;
        }

        .table tr:hover {
            background: rgba(51, 65, 85, 0.2);
        }

        .badge {
            padding: 0.4rem 1rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .badge.active {
            background: rgba(16, 185, 129, 0.2);
            color: var(--success);
        }

        .badge.inactive {
            background: rgba(239, 68, 68, 0.2);
            color: var(--danger);
        }

        .badge.empresa {
            background: rgba(59, 130, 246, 0.2);
            color: var(--info);
        }

        .badge.individual {
            background: rgba(139, 92, 246, 0.2);
            color: #a78bfa;
        }

        .loading {
            text-align: center;
            padding: 2rem;
            color: var(--text-secondary);
        }

        .error {
            text-align: center;
            padding: 2rem;
            color: var(--danger);
            background: rgba(239, 68, 68, 0.1);
            border-radius: 12px;
            margin: 1rem 0;
        }

        .pagination {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem 2rem;
            border-top: 1px solid var(--border);
        }

        .pagination-info {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .pagination-controls {
            display: flex;
            gap: 0.5rem;
        }

        .pagination-btn {
            padding: 0.6rem 1rem;
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .pagination-btn:hover {
            background: var(--primary);
        }

        .pagination-btn.active {
            background: var(--primary);
        }

        .action-btn {
            padding: 0.4rem 0.8rem;
            background: rgba(99, 102, 241, 0.2);
            border: 1px solid var(--primary);
            border-radius: 8px;
            color: var(--primary);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.85rem;
            margin-right: 0.5rem;
        }

        .action-btn:hover {
            background: var(--primary);
            color: white;
        }

        .action-btn.delete {
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid var(--danger);
            color: var(--danger);
        }

        .action-btn.delete:hover {
            background: var(--danger);
            color: white;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--bg-card);
            padding: 2rem;
            border-radius: 20px;
            border: 1px solid var(--border);
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .close-modal {
            position: absolute;
            top: 1rem;
            right: 1rem;
            cursor: pointer;
            font-size: 1.5rem;
            color: var(--text-secondary);
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 0.8rem 1rem;
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 0.95rem;
        }

        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: var(--primary);
        }

        .form-textarea {
            resize: vertical;
            min-height: 100px;
        }

        .form-row {
            display: flex;
            gap: 1rem;
        }

        .form-row .form-group {
            flex: 1;
        }

        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }

            .header {
                flex-direction: column;
                gap: 1rem;
            }

            .filters {
                flex-direction: column;
            }

            .filter-group {
                width: 100%;
            }

            .filter-select, .search-input {
                min-width: 100%;
            }

            .table-container {
                overflow-x: auto;
            }

            .table {
                min-width: 800px;
            }

            .form-row {
                flex-direction: column;
                gap: 0;
            }
        }
    </style>
</head>
<body>
    <div class="bg-animation">
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
    </div>

    <div class="container">
        <div class="header">
            <div class="logo">
                <div class="logo-icon">üë•</div>
                <span>Log√≠stica Global</span>
            </div>
            <div class="user-info">
                {% if user.is_authenticated %}
                <div>
                    <div style="font-weight: 600;">{{ user.get_full_name|default:user.username }}</div>
                    <div style="font-size: 0.85rem; color: var(--text-secondary);">
                        {% if user.is_staff %}Administrador{% else %}Usuario{% endif %}
                    </div>
                </div>
                <div class="avatar" onclick="window.location.href='{% url 'logout' %}'" title="Cerrar sesi√≥n">
                    {{ user.username|slice:":2"|upper }}
                </div>
                {% else %}
                <a href="{% url 'login' %}" class="btn">Iniciar Sesi√≥n</a>
                {% endif %}
            </div>
        </div>

        <div class="nav-menu">
            <div class="nav-item" onclick="window.location.href='{% url 'dashboard' %}'">üìä Dashboard</div>
            <div class="nav-item" onclick="window.location.href='{% url 'despachos' %}'">üì¶ Despachos</div>
            <div class="nav-item" onclick="window.location.href='{% url 'rutas' %}'">üó∫Ô∏è Rutas</div>
            <div class="nav-item" onclick="window.location.href='{% url 'vehiculos' %}'">üöõ Veh√≠culos</div>
            <div class="nav-item" onclick="window.location.href='{% url 'aeronaves' %}'">‚úàÔ∏è Aeronaves</div>
            <div class="nav-item" onclick="window.location.href='{% url 'conductores' %}'">üë®‚Äçüíº Conductores</div>
            <div class="nav-item" onclick="window.location.href='{% url 'pilotos' %}'">üë®‚Äç‚úàÔ∏è Pilotos</div>
            <div class="nav-item active" onclick="window.location.href='{% url 'clientes' %}'">üë• Clientes</div>
            <div class="nav-item" onclick="window.location.href='{% url 'cargas' %}'">üì¶ Cargas</div>
            <div class="nav-item" onclick="window.location.href='{% url 'seguros' %}'">üõ°Ô∏è Seguros</div>
            <div class="nav-item" onclick="window.location.href='{% url 'reportes' %}'">üìà Reportes</div>
            <div class="nav-item" onclick="window.location.href='{% url 'api' %}'">üîó API</div>
        </div>

        <div class="page-title">
            <span>üë•</span>
            <span>Gesti√≥n de Clientes</span>
        </div>

        <div class="filters">
            <div class="filter-group">
                <select class="filter-select" id="filter-status">
                    <option value="">Todos los estados</option>
                    <option value="active">Activo</option>
                    <option value="inactive">Inactivo</option>
                </select>
                <select class="filter-select" id="filter-type">
                    <option value="">Todos los tipos</option>
                    <option value="empresa">Empresa</option>
                    <option value="individual">Individual</option>
                </select>
            </div>
            <input type="text" class="search-input" id="search-input" placeholder="Buscar cliente...">
            <button class="btn" id="new-client-btn">‚ûï Nuevo Cliente</button>
        </div>

        <div class="table-container">
            <div class="table-header">
                <div class="table-title">Lista de Clientes</div>
                <div id="client-count" style="color: var(--text-secondary); font-size: 0.9rem;">Cargando...</div>
            </div>
            <table class="table">
                <thead>
                    <tr>
                        <th>RUT</th>
                        <th>Raz√≥n Social/Nombre</th>
                        <th>Tipo</th>
                        <th>Persona de Contacto</th>
                        <th>Tel√©fono</th>
                        <th>Email</th>
                        <th>Estado</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody id="clients-table-body">
                    <tr>
                        <td colspan="8" class="loading">Cargando datos de clientes desde la base de datos...</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Modal para nuevo cliente -->
    <div id="newClientModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal('newClientModal')">&times;</span>
            <h3>Nuevo Cliente</h3>
            <form id="newClientForm">
                <div class="form-group">
                    <label class="form-label">Tipo de Cliente</label>
                    <select class="form-select" name="tipo_cliente" id="tipo-cliente-select" required>
                        <option value="">Seleccionar tipo</option>
                        <option value="EMPRESA">Empresa</option>
                        <option value="INDIVIDUAL">Individual</option>
                    </select>
                </div>

                <div id="empresa-fields">
                    <div class="form-group">
                        <label class="form-label">Raz√≥n Social</label>
                        <input type="text" class="form-input" name="razon_social">
                    </div>
                </div>

                <div id="individual-fields" style="display: none;">
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Nombre</label>
                            <input type="text" class="form-input" name="nombre">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Apellido</label>
                            <input type="text" class="form-input" name="apellido">
                        </div>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">RUT</label>
                        <input type="text" class="form-input" name="rut" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Persona de Contacto</label>
                        <input type="text" class="form-input" name="persona_contacto" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Tel√©fono</label>
                        <input type="text" class="form-input" name="telefono" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Email</label>
                        <input type="email" class="form-input" name="email" required>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Direcci√≥n</label>
                    <textarea class="form-textarea" name="direccion" required></textarea>
                </div>

                <div class="form-group">
                    <label class="form-label">
                        <input type="checkbox" name="activo" checked> Activo
                    </label>
                </div>

                <div style="margin-top: 2rem; display: flex; gap: 1rem; justify-content: flex-end;">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('newClientModal')">Cancelar</button>
                    <button type="submit" class="btn">Crear Cliente</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Variable global para almacenar los clientes
        let clientsData = [];

        // Funci√≥n para cargar clientes desde la base de datos
        async function loadClientsFromDatabase() {
            try {
                showLoadingState();
                
                const response = await fetch('/api/clientes/');
                
                if (!response.ok) {
                    throw new Error('Error al cargar los clientes');
                }
                
                clientsData = await response.json();
                renderClientsTable(clientsData);
                showNotification('Datos de clientes cargados correctamente');
                
            } catch (error) {
                console.error('Error:', error);
                showErrorState('Error al cargar los clientes: ' + error.message);
            }
        }

        // Funci√≥n para mostrar estado de carga
        function showLoadingState() {
            const tableBody = document.getElementById('clients-table-body');
            tableBody.innerHTML = `
                <tr>
                    <td colspan="8" class="loading">Cargando datos de clientes desde la base de datos...</td>
                </tr>
            `;
            document.getElementById('client-count').textContent = 'Cargando...';
        }

        // Funci√≥n para mostrar estado de error
        function showErrorState(message) {
            const tableBody = document.getElementById('clients-table-body');
            tableBody.innerHTML = `
                <tr>
                    <td colspan="8">
                        <div class="error">
                            ${message}
                            <br>
                            <button class="btn" onclick="loadClientsFromDatabase()" style="margin-top: 1rem;">
                                Reintentar
                            </button>
                        </div>
                    </td>
                </tr>
            `;
            document.getElementById('client-count').textContent = 'Error';
        }

        // Funci√≥n para renderizar la tabla de clientes
        function renderClientsTable(clients) {
            const tableBody = document.getElementById('clients-table-body');
            const clientCount = document.getElementById('client-count');
            
            if (clients.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="8" class="loading">No se encontraron clientes en la base de datos</td>
                    </tr>
                `;
                clientCount.textContent = 'Total: 0 clientes';
                return;
            }
            
            tableBody.innerHTML = '';
            clientCount.textContent = `Total: ${clients.length} clientes`;
            
            clients.forEach(client => {
                const row = document.createElement('tr');
                
                // Estado basado en campo 'activo'
                const statusClass = client.activo ? 'active' : 'inactive';
                const statusText = client.activo ? 'Activo' : 'Inactivo';
                
                // Tipo de cliente
                const typeClass = client.tipo_cliente === 'EMPRESA' ? 'empresa' : 'individual';
                const typeText = client.tipo_cliente === 'EMPRESA' ? 'Empresa' : 'Individual';
                
                // Nombre/raz√≥n social
                const nombreDisplay = client.tipo_cliente === 'EMPRESA' ? 
                    client.razon_social : 
                    `${client.nombre} ${client.apellido}`;
                
                row.innerHTML = `
                    <td>${client.rut || 'N/A'}</td>
                    <td>${nombreDisplay || 'N/A'}</td>
                    <td><span class="badge ${typeClass}">${typeText}</span></td>
                    <td>${client.persona_contacto || 'N/A'}</td>
                    <td>${client.telefono || 'N/A'}</td>
                    <td>${client.email || 'N/A'}</td>
                    <td><span class="badge ${statusClass}">${statusText}</span></td>
                    <td>
                        <button class="action-btn" onclick="viewClient(${client.id})">Ver</button>
                        <button class="action-btn" onclick="editClient(${client.id})">Editar</button>
                        <button class="action-btn delete" onclick="deleteClient(${client.id})">Eliminar</button>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
        }

        // Funci√≥n para filtrar clientes
        function filterClients() {
            const statusFilter = document.getElementById('filter-status').value;
            const typeFilter = document.getElementById('filter-type').value;
            const searchText = document.getElementById('search-input').value.toLowerCase();
            
            const filteredClients = clientsData.filter(client => {
                // Filtro por estado
                const matchesStatus = !statusFilter || 
                    (statusFilter === 'active' && client.activo) ||
                    (statusFilter === 'inactive' && !client.activo);
                
                // Filtro por tipo
                const matchesType = !typeFilter || 
                    (typeFilter === 'empresa' && client.tipo_cliente === 'EMPRESA') ||
                    (typeFilter === 'individual' && client.tipo_cliente === 'INDIVIDUAL');
                
                // Filtro por b√∫squeda
                const matchesSearch = !searchText || 
                    (client.rut && client.rut.toLowerCase().includes(searchText)) ||
                    (client.razon_social && client.razon_social.toLowerCase().includes(searchText)) ||
                    (client.nombre && client.nombre.toLowerCase().includes(searchText)) ||
                    (client.persona_contacto && client.persona_contacto.toLowerCase().includes(searchText)) ||
                    (client.email && client.email.toLowerCase().includes(searchText));
                
                return matchesStatus && matchesType && matchesSearch;
            });
            
            renderClientsTable(filteredClients);
        }

        // Funciones de acci√≥n para los clientes
        async function viewClient(clientId) {
            try {
                const response = await fetch(`/api/clientes/${clientId}/`);
                const clientDetails = await response.json();
                
                showNotification(`Viendo detalles del cliente ${clientId}`);
                console.log('Detalles del cliente:', clientDetails);
                
            } catch (error) {
                console.error('Error al obtener detalles:', error);
                showNotification('Error al cargar detalles del cliente');
            }
        }

        async function editClient(clientId) {
            showNotification(`Editando el cliente ${clientId}`);
            // Redirigir a p√°gina de edici√≥n
            window.location.href = `/clientes/${clientId}/editar/`;
        }

        async function deleteClient(clientId) {
            if (confirm('¬øEst√° seguro de que desea eliminar este cliente?')) {
                try {
                    const response = await fetch(`/api/clientes/${clientId}/`, {
                        method: 'DELETE',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-CSRFToken': getCSRFToken()
                        }
                    });
                    
                    if (response.ok) {
                        await loadClientsFromDatabase();
                        showNotification('Cliente eliminado correctamente');
                    } else {
                        throw new Error('Error al eliminar el cliente');
                    }
                } catch (error) {
                    console.error('Error:', error);
                    showNotification('Error al eliminar el cliente');
                }
            }
        }

        // Funciones para el modal de nuevo cliente
        function showNewClientModal() {
            showModal('newClientModal');
        }

        async function createClient(formData) {
            try {
                const response = await fetch('/api/clientes/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': getCSRFToken()
                    },
                    body: JSON.stringify(formData)
                });
                
                if (response.ok) {
                    const newClient = await response.json();
                    showNotification('Cliente creado exitosamente');
                    closeModal('newClientModal');
                    await loadClientsFromDatabase();
                    return newClient;
                } else {
                    const errorData = await response.json();
                    throw new Error(errorData.detail || 'Error al crear el cliente');
                }
            } catch (error) {
                console.error('Error:', error);
                showNotification('Error al crear el cliente: ' + error.message);
                throw error;
            }
        }

        function handleClientFormSubmit(e) {
            e.preventDefault();
            
            const form = e.target;
            const formData = {
                tipo_cliente: form.querySelector('select[name="tipo_cliente"]').value,
                rut: form.querySelector('input[name="rut"]').value,
                persona_contacto: form.querySelector('input[name="persona_contacto"]').value,
                telefono: form.querySelector('input[name="telefono"]').value,
                email: form.querySelector('input[name="email"]').value,
                direccion: form.querySelector('textarea[name="direccion"]').value,
                activo: form.querySelector('input[name="activo"]').checked
            };

            // Agregar campos espec√≠ficos seg√∫n el tipo
            if (formData.tipo_cliente === 'EMPRESA') {
                formData.razon_social = form.querySelector('input[name="razon_social"]').value;
                formData.nombre = null;
                formData.apellido = null;
            } else {
                formData.razon_social = null;
                formData.nombre = form.querySelector('input[name="nombre"]').value;
                formData.apellido = form.querySelector('input[name="apellido"]').value;
            }
            
            createClient(formData);
        }

        // Funci√≥n para manejar cambio de tipo de cliente
        function handleTipoClienteChange() {
            const tipo = document.getElementById('tipo-cliente-select').value;
            const empresaFields = document.getElementById('empresa-fields');
            const individualFields = document.getElementById('individual-fields');
            
            if (tipo === 'EMPRESA') {
                empresaFields.style.display = 'block';
                individualFields.style.display = 'none';
            } else if (tipo === 'INDIVIDUAL') {
                empresaFields.style.display = 'none';
                individualFields.style.display = 'block';
            } else {
                empresaFields.style.display = 'none';
                individualFields.style.display = 'none';
            }
        }

        // Funci√≥n auxiliar para obtener el token CSRF
        function getCSRFToken() {
            const name = 'csrftoken';
            let cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                const cookies = document.cookie.split(';');
                for (let i = 0; i < cookies.length; i++) {
                    const cookie = cookies[i].trim();
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }

        // Modal Functions
        function showModal(modalId) {
            document.getElementById(modalId).style.display = 'block';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
            // Resetear formulario
            if (modalId === 'newClientModal') {
                document.getElementById('newClientForm').reset();
                document.getElementById('empresa-fields').style.display = 'block';
                document.getElementById('individual-fields').style.display = 'none';
            }
        }

        // Notification System
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.textContent = `‚úì ${message}`;
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: linear-gradient(135deg, #6366f1, #06b6d4);
                color: white;
                padding: 1rem 2rem;
                border-radius: 12px;
                box-shadow: 0 10px 30px rgba(99, 102, 241, 0.4);
                z-index: 1000;
                animation: slideInRight 0.4s ease-out;
                font-weight: 600;
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOutRight 0.4s ease-out';
                setTimeout(() => notification.remove(), 400);
            }, 3000);
        }

        // Inicializaci√≥n cuando se carga la p√°gina
        document.addEventListener('DOMContentLoaded', function() {
            loadClientsFromDatabase();
            
            document.getElementById('filter-status').addEventListener('change', filterClients);
            document.getElementById('filter-type').addEventListener('change', filterClients);
            document.getElementById('search-input').addEventListener('input', filterClients);
            
            document.getElementById('new-client-btn').addEventListener('click', showNewClientModal);
            
            document.getElementById('newClientForm').addEventListener('submit', handleClientFormSubmit);
            
            document.getElementById('tipo-cliente-select').addEventListener('change', handleTipoClienteChange);
            
            console.log('üë• M√≥dulo de Clientes cargado exitosamente');
        });

        // Estilos para las animaciones de notificaciones
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideInRight {
                from {
                    transform: translateX(400px);
                    opacity: 0;
                }
                to {
                    transform: translateX(0);
                    opacity: 1;
                }
            }
            @keyframes slideOutRight {
                from {
                    transform: translateX(0);
                    opacity: 1;
                }
                to {
                    transform: translateX(400px);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(style);

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            });
        }
    </script>
</body>
</html>
============================================================


===== cliente_confirm_delete.html =====
{% extends 'base.html' %}

{% block title %}Eliminar Cliente - Log√≠stica Global{% endblock %}

{% block content %}
<div class="page-title">
    <span>üóëÔ∏è</span>
    <span>Eliminar Cliente</span>
</div>

<div class="content-card">
    <div style="text-align: center; margin-bottom: 2rem;">
        <div style="font-size: 4rem; margin-bottom: 1rem;">‚ö†Ô∏è</div>
        <h2 style="margin-bottom: 1rem;">¬øEst√°s seguro de que deseas eliminar este cliente?</h2>
        <p style="color: var(--text-secondary); margin-bottom: 2rem;">
            Cliente: {{ cliente.razon_social|default:cliente.nombre }}<br>
            RUT: {{ cliente.rut }}<br>
            Esta acci√≥n no se puede deshacer.
        </p>
    </div>

    <form method="post" style="text-align: center;">
        {% csrf_token %}
        <div class="action-buttons" style="justify-content: center;">
            <button type="submit" class="btn btn-danger">S√≠, eliminar</button>
            <a href="{% url 'clientes' %}" class="btn btn-secondary">Cancelar</a>
        </div>
    </form>
</div>
{% endblock %}
============================================================


===== cliente_detail.html =====
{% extends 'base.html' %}

{% block title %}Cliente {{ cliente.razon_social }} - Log√≠stica Global{% endblock %}

{% block content %}
<div class="page-title">
    <span>üë•</span>
    <span>Cliente {{ cliente.razon_social }}</span>
</div>

<div class="content-card">
    <div class="detail-grid">
        <div class="detail-item">
            <div class="detail-label">ID</div>
            <div class="detail-value">{{ cliente.id }}</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Raz√≥n Social</div>
            <div class="detail-value">{{ cliente.razon_social }}</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">RUT</div>
            <div class="detail-value">{{ cliente.rut }}</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Persona de Contacto</div>
            <div class="detail-value">{{ cliente.persona_contacto }}</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Tel√©fono</div>
            <div class="detail-value">{{ cliente.telefono }}</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Email</div>
            <div class="detail-value">{{ cliente.email }}</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Direcci√≥n</div>
            <div class="detail-value">{{ cliente.direccion }}</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Estado</div>
            <div class="detail-value">
                <span class="badge {% if cliente.activo %}active{% else %}alert{% endif %}">
                    {% if cliente.activo %}Activo{% else %}Inactivo{% endif %}
                </span>
            </div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Cargas Registradas</div>
            <div class="detail-value">{{ cliente.carga_set.count }}</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Despachos Realizados</div>
            <div class="detail-value">{{ cliente.despacho_set.count }}</div>
        </div>
    </div>

    <div class="action-buttons">
        <a href="{% url 'cliente_edit' cliente.pk %}" class="btn">Editar</a>
        <a href="{% url 'cliente_delete' cliente.pk %}" class="btn btn-danger">Eliminar</a>
        <a href="{% url 'clientes' %}" class="btn btn-secondary">Volver a la lista</a>
    </div>
</div>
{% endblock %}
============================================================


===== cliente_editar.html =====
{% extends 'base.html' %}

{% block title %}Editar Cliente - Log√≠stica Global{% endblock %}

{% block content %}
<div class="page-title">
    <span>üë•</span>
    <span>Editar Cliente</span>
</div>

<div class="content-card">
    <form method="post">
        {% csrf_token %}
        
        <div class="form-group">
            <label class="form-label">Tipo de Cliente</label>
            <select class="form-select" name="tipo_cliente" id="tipo_cliente" required onchange="toggleClienteFields(this.value)">
                <option value="EMPRESA" {% if cliente.tipo_cliente == 'EMPRESA' %}selected{% endif %}>Empresa</option>
                <option value="INDIVIDUAL" {% if cliente.tipo_cliente == 'INDIVIDUAL' %}selected{% endif %}>Individual</option>
            </select>
        </div>

        <div id="empresaFields" {% if cliente.tipo_cliente == 'EMPRESA' %}style="display: block;"{% else %}style="display: none;"{% endif %}>
            <div class="form-group">
                <label class="form-label">Raz√≥n Social</label>
                <input type="text" class="form-input" name="razon_social" value="{{ cliente.razon_social|default:'' }}">
            </div>
        </div>

        <div id="individualFields" {% if cliente.tipo_cliente == 'INDIVIDUAL' %}style="display: block;"{% else %}style="display: none;"{% endif %}>
            <div class="form-row">
                <div class="form-group">
                    <label class="form-label">Nombre</label>
                    <input type="text" class="form-input" name="nombre" value="{{ cliente.nombre|default:'' }}">
                </div>
                <div class="form-group">
                    <label class="form-label">Apellido</label>
                    <input type="text" class="form-input" name="apellido" value="{{ cliente.apellido|default:'' }}">
                </div>
            </div>
        </div>

        <div class="form-group">
            <label class="form-label">RUT</label>
            <input type="text" class="form-input" name="rut" value="{{ cliente.rut }}" required>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label class="form-label">Persona de Contacto</label>
                <input type="text" class="form-input" name="persona_contacto" value="{{ cliente.persona_contacto }}" required>
            </div>
            <div class="form-group">
                <label class="form-label">Tel√©fono</label>
                <input type="tel" class="form-input" name="telefono" value="{{ cliente.telefono }}" required>
            </div>
        </div>

        <div class="form-group">
            <label class="form-label">Email</label>
            <input type="email" class="form-input" name="email" value="{{ cliente.email }}" required>
        </div>

        <div class="form-group">
            <label class="form-label">Direcci√≥n</label>
            <textarea class="form-input" name="direccion" rows="3" required>{{ cliente.direccion }}</textarea>
        </div>

        <div class="form-group">
            <label class="form-label">
                <input type="checkbox" name="activo" {% if cliente.activo %}checked{% endif %}> Activo
            </label>
        </div>

        <div class="action-buttons">
            <button type="submit" class="btn btn-success">Actualizar Cliente</button>
            <a href="{% url 'clientes' %}" class="btn btn-secondary">Cancelar</a>
        </div>
    </form>
</div>

<script>
function toggleClienteFields(tipo) {
    const empresaFields = document.getElementById('empresaFields');
    const individualFields = document.getElementById('individualFields');
    
    if (tipo === 'EMPRESA') {
        empresaFields.style.display = 'block';
        individualFields.style.display = 'none';
    } else {
        empresaFields.style.display = 'none';
        individualFields.style.display = 'block';
    }
}
</script>
{% endblock %}
============================================================


===== cliente_form.html =====
{% extends 'base.html' %}

{% block title %}Nuevo Cliente - Log√≠stica Global{% endblock %}

{% block content %}
<div class="page-title">
    <span>üë•</span>
    <span>Nuevo Cliente</span>
</div>

<div class="content-card">
    <form method="post">
        {% csrf_token %}
        
        <div class="form-group">
            <label class="form-label">Tipo de Cliente *</label>
            <select class="form-select" name="tipo_cliente" required>
                <option value="EMPRESA">Empresa</option>
                <option value="INDIVIDUAL">Individual</option>
            </select>
        </div>
        
        <div id="empresa-fields">
            <div class="form-group">
                <label class="form-label">Raz√≥n Social *</label>
                <input type="text" class="form-input" name="razon_social" required>
            </div>
        </div>
        
        <div id="individual-fields" style="display: none;">
            <div class="form-group">
                <label class="form-label">Nombre *</label>
                <input type="text" class="form-input" name="nombre">
            </div>
            <div class="form-group">
                <label class="form-label">Apellido *</label>
                <input type="text" class="form-input" name="apellido">
            </div>
        </div>
        
        <div class="form-group">
            <label class="form-label">RUT *</label>
            <input type="text" class="form-input" name="rut" required>
        </div>
        
        <div class="form-group">
            <label class="form-label">Persona de Contacto *</label>
            <input type="text" class="form-input" name="persona_contacto" required>
        </div>
        
        <div class="form-group">
            <label class="form-label">Tel√©fono *</label>
            <input type="text" class="form-input" name="telefono" required>
        </div>
        
        <div class="form-group">
            <label class="form-label">Email *</label>
            <input type="email" class="form-input" name="email" required>
        </div>
        
        <div class="form-group">
            <label class="form-label">Direcci√≥n *</label>
            <textarea class="form-input" name="direccion" required></textarea>
        </div>
        
        <div class="form-group">
            <label class="form-label">
                <input type="checkbox" name="activo" checked> Activo
            </label>
        </div>
        
        <div class="action-buttons">
            <button type="submit" class="btn">Crear Cliente</button>
            <a href="{% url 'clientes' %}" class="btn btn-secondary">Cancelar</a>
        </div>
    </form>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const tipoClienteSelect = document.querySelector('select[name="tipo_cliente"]');
    const empresaFields = document.getElementById('empresa-fields');
    const individualFields = document.getElementById('individual-fields');
    
    function toggleFields() {
        if (tipoClienteSelect.value === 'EMPRESA') {
            empresaFields.style.display = 'block';
            individualFields.style.display = 'none';
            empresaFields.querySelector('input').required = true;
            individualFields.querySelectorAll('input').forEach(input => input.required = false);
        } else {
            empresaFields.style.display = 'none';
            individualFields.style.display = 'block';
            empresaFields.querySelector('input').required = false;
            individualFields.querySelectorAll('input').forEach(input => input.required = true);
        }
    }
    
    tipoClienteSelect.addEventListener('change', toggleFields);
    toggleFields(); // Ejecutar al cargar la p√°gina
});
</script>
{% endblock %}
============================================================


===== conductores.html =====
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conductores - Sistema de Gesti√≥n de Transporte</title>
    <style>
        /* MANTENER TODOS LOS ESTILOS ORIGINALES EXACTAMENTE IGUAL */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #06b6d4;
            --accent: #f59e0b;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --info: #3b82f6;
            --bg-dark: #0f172a;
            --bg-card: #1e293b;
            --bg-hover: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --border: #334155;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--bg-dark) 0%, #1e293b 100%);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .bg-animation {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 0;
            overflow: hidden;
        }

        .bg-animation span {
            position: absolute;
            display: block;
            width: 20px;
            height: 20px;
            background: rgba(99, 102, 241, 0.1);
            animation: float 25s infinite;
            border-radius: 50%;
        }

        .bg-animation span:nth-child(1) { left: 25%; animation-delay: 0s; }
        .bg-animation span:nth-child(2) { left: 10%; animation-delay: 2s; animation-duration: 30s; }
        .bg-animation span:nth-child(3) { left: 70%; animation-delay: 4s; }
        .bg-animation span:nth-child(4) { left: 40%; animation-delay: 0s; animation-duration: 18s; }
        .bg-animation span:nth-child(5) { left: 65%; animation-delay: 0s; }
        .bg-animation span:nth-child(6) { left: 75%; animation-delay: 3s; }
        .bg-animation span:nth-child(7) { left: 35%; animation-delay: 7s; }
        .bg-animation span:nth-child(8) { left: 50%; animation-delay: 15s; animation-duration: 45s; }
        .bg-animation span:nth-child(9) { left: 20%; animation-delay: 2s; animation-duration: 35s; }
        .bg-animation span:nth-child(10) { left: 85%; animation-delay: 0s; animation-duration: 11s; }

        @keyframes float {
            0% {
                transform: translateY(100vh) scale(0);
                opacity: 0;
            }
            50% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100vh) scale(1);
                opacity: 0;
            }
        }

        .container {
            position: relative;
            z-index: 1;
            max-width: 1600px;
            margin: 0 auto;
            padding: 2.5rem 3rem;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 3rem;
            background: rgba(30, 41, 59, 0.6);
            backdrop-filter: blur(10px);
            padding: 1.5rem 2.5rem;
            border-radius: 20px;
            border: 1px solid var(--border);
            animation: slideDown 0.6s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 1rem;
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .logo-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            animation: rotate3d 3s infinite ease-in-out;
        }

        @keyframes rotate3d {
            0%, 100% { transform: rotateY(0deg); }
            50% { transform: rotateY(180deg); }
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .avatar {
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, var(--accent), var(--danger));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .avatar:hover {
            transform: scale(1.1) rotate(5deg);
        }

        .nav-menu {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .nav-item {
            padding: 0.8rem 1.5rem;
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .nav-item:hover, .nav-item.active {
            background: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(99, 102, 241, 0.4);
        }

        .page-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .filters {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .filter-group {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .filter-select, .search-input {
            padding: 0.8rem 1.2rem;
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 0.95rem;
            min-width: 180px;
        }

        .search-input {
            flex: 1;
            min-width: 250px;
        }

        .btn {
            padding: 0.8rem 1.5rem;
            background: var(--primary);
            border: none;
            border-radius: 12px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(99, 102, 241, 0.4);
        }

        .btn-secondary {
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background: var(--bg-hover);
        }

        .table-container {
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.8), rgba(30, 41, 59, 0.4));
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 1px solid var(--border);
            overflow: hidden;
            margin-bottom: 2rem;
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem 2rem;
            border-bottom: 1px solid var(--border);
        }

        .table-title {
            font-size: 1.3rem;
            font-weight: 600;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
        }

        .table th {
            text-align: left;
            padding: 1.2rem 1.5rem;
            background: rgba(51, 65, 85, 0.3);
            font-weight: 600;
            color: var(--text-secondary);
            border-bottom: 1px solid var(--border);
        }

        .table td {
            padding: 1.2rem 1.5rem;
            border-bottom: 1px solid var(--border);
        }

        .table tr:last-child td {
            border-bottom: none;
        }

        .table tr:hover {
            background: rgba(51, 65, 85, 0.2);
        }

        .badge {
            padding: 0.4rem 1rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .badge.active {
            background: rgba(16, 185, 129, 0.2);
            color: var(--success);
        }

        .badge.inactive {
            background: rgba(239, 68, 68, 0.2);
            color: var(--danger);
        }

        .badge.vacation {
            background: rgba(245, 158, 11, 0.2);
            color: var(--warning);
        }

        .loading {
            text-align: center;
            padding: 2rem;
            color: var(--text-secondary);
        }

        .error {
            text-align: center;
            padding: 2rem;
            color: var(--danger);
            background: rgba(239, 68, 68, 0.1);
            border-radius: 12px;
            margin: 1rem 0;
        }

        .pagination {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem 2rem;
            border-top: 1px solid var(--border);
        }

        .pagination-info {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .pagination-controls {
            display: flex;
            gap: 0.5rem;
        }

        .pagination-btn {
            padding: 0.6rem 1rem;
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .pagination-btn:hover {
            background: var(--primary);
        }

        .pagination-btn.active {
            background: var(--primary);
        }

        .action-btn {
            padding: 0.4rem 0.8rem;
            background: rgba(99, 102, 241, 0.2);
            border: 1px solid var(--primary);
            border-radius: 8px;
            color: var(--primary);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.85rem;
            margin-right: 0.5rem;
        }

        .action-btn:hover {
            background: var(--primary);
            color: white;
        }

        .action-btn.delete {
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid var(--danger);
            color: var(--danger);
        }

        .action-btn.delete:hover {
            background: var(--danger);
            color: white;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--bg-card);
            padding: 2rem;
            border-radius: 20px;
            border: 1px solid var(--border);
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .close-modal {
            position: absolute;
            top: 1rem;
            right: 1rem;
            cursor: pointer;
            font-size: 1.5rem;
            color: var(--text-secondary);
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .form-input, .form-select {
            width: 100%;
            padding: 0.8rem 1rem;
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 0.95rem;
        }

        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: var(--primary);
        }

        .form-row {
            display: flex;
            gap: 1rem;
        }

        .form-row .form-group {
            flex: 1;
        }

        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }

            .header {
                flex-direction: column;
                gap: 1rem;
            }

            .filters {
                flex-direction: column;
            }

            .filter-group {
                width: 100%;
            }

            .filter-select, .search-input {
                min-width: 100%;
            }

            .table-container {
                overflow-x: auto;
            }

            .table {
                min-width: 800px;
            }

            .form-row {
                flex-direction: column;
                gap: 0;
            }
        }
    </style>
</head>
<body>
    <div class="bg-animation">
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
    </div>

    <div class="container">
        <div class="header">
            <div class="logo">
                <div class="logo-icon">üöö</div>
                <span>Log√≠stica Global</span>
            </div>
            <div class="user-info">
                {% if user.is_authenticated %}
                <div>
                    <div style="font-weight: 600;">{{ user.get_full_name|default:user.username }}</div>
                    <div style="font-size: 0.85rem; color: var(--text-secondary);">
                        {% if user.is_staff %}Administrador{% else %}Usuario{% endif %}
                    </div>
                </div>
                <div class="avatar" onclick="window.location.href='{% url 'logout' %}'" title="Cerrar sesi√≥n">
                    {{ user.username|slice:":2"|upper }}
                </div>
                {% else %}
                <a href="{% url 'login' %}" class="btn">Iniciar Sesi√≥n</a>
                {% endif %}
            </div>
        </div>

        <div class="nav-menu">
            <div class="nav-item" onclick="window.location.href='{% url 'dashboard' %}'">üìä Dashboard</div>
            <div class="nav-item" onclick="window.location.href='{% url 'despachos' %}'">üì¶ Despachos</div>
            <div class="nav-item" onclick="window.location.href='{% url 'rutas' %}'">üó∫Ô∏è Rutas</div>
            <div class="nav-item" onclick="window.location.href='{% url 'vehiculos' %}'">üöõ Veh√≠culos</div>
            <div class="nav-item" onclick="window.location.href='{% url 'aeronaves' %}'">‚úàÔ∏è Aeronaves</div>
            <div class="nav-item active" onclick="window.location.href='{% url 'conductores' %}'">üë®‚Äçüíº Conductores</div>
            <div class="nav-item" onclick="window.location.href='{% url 'pilotos' %}'">üë®‚Äç‚úàÔ∏è Pilotos</div>
            <div class="nav-item" onclick="window.location.href='{% url 'clientes' %}'">üë• Clientes</div>
            <div class="nav-item" onclick="window.location.href='{% url 'cargas' %}'">üì¶ Cargas</div>
            <div class="nav-item" onclick="window.location.href='{% url 'seguros' %}'">üõ°Ô∏è Seguros</div>
            <div class="nav-item" onclick="window.location.href='{% url 'reportes' %}'">üìà Reportes</div>
            <div class="nav-item" onclick="window.location.href='{% url 'api' %}'">üîó API</div>
        </div>

        <div class="page-title">
            <span>üë®‚Äçüíº</span>
            <span>Gesti√≥n de Conductores</span>
        </div>

        <div class="filters">
            <div class="filter-group">
                <select class="filter-select" id="filter-status">
                    <option value="">Todos los estados</option>
                    <option value="active">Activo</option>
                    <option value="inactive">Inactivo</option>
                    <option value="vacation">Vacaciones</option>
                </select>
            </div>
            <input type="text" class="search-input" id="search-input" placeholder="Buscar conductor...">
            <button class="btn" id="new-driver-btn">‚ûï Nuevo Conductor</button>
        </div>

        <div class="table-container">
            <div class="table-header">
                <div class="table-title">Lista de Conductores</div>
                <div id="driver-count" style="color: var(--text-secondary); font-size: 0.9rem;">Cargando...</div>
            </div>
            <table class="table">
                <thead>
                    <tr>
                        <th>Nombre</th>
                        <th>RUT</th>
                        <th>Licencia</th>
                        <th>Tel√©fono</th>
                        <th>Email</th>
                        <th>Veh√≠culo Asignado</th>
                        <th>Estado</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody id="drivers-table-body">
                    <tr>
                        <td colspan="8" class="loading">Cargando datos de conductores desde la base de datos...</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Modal para crear nuevo conductor -->
    <div id="newDriverModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal('newDriverModal')">&times;</span>
            <h3>Nuevo Conductor</h3>
            <form id="newDriverForm">
                <div class="form-group">
                    <label class="form-label">Nombre Completo</label>
                    <input type="text" class="form-input" name="nombre" required>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">RUT</label>
                        <input type="text" class="form-input" name="rut" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Licencia</label>
                        <input type="text" class="form-input" name="licencia" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Tel√©fono</label>
                        <input type="text" class="form-input" name="telefono" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Email</label>
                        <input type="email" class="form-input" name="email" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        <input type="checkbox" name="activo" checked> Activo
                    </label>
                </div>
                
                <div style="margin-top: 2rem; display: flex; gap: 1rem; justify-content: flex-end;">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('newDriverModal')">Cancelar</button>
                    <button type="submit" class="btn">Crear Conductor</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Variable global para almacenar los conductores
        let driversData = [];

        // Funci√≥n para cargar conductores desde la base de datos
        async function loadDriversFromDatabase() {
            try {
                showLoadingState();
                
                const response = await fetch('/api/conductores/');
                
                if (!response.ok) {
                    throw new Error('Error al cargar los conductores');
                }
                
                driversData = await response.json();
                renderDriversTable(driversData);
                showNotification('Datos de conductores cargados correctamente');
                
            } catch (error) {
                console.error('Error:', error);
                showErrorState('Error al cargar los conductores: ' + error.message);
            }
        }

        // Funci√≥n para mostrar estado de carga
        function showLoadingState() {
            const tableBody = document.getElementById('drivers-table-body');
            tableBody.innerHTML = `
                <tr>
                    <td colspan="8" class="loading">Cargando datos de conductores desde la base de datos...</td>
                </tr>
            `;
            document.getElementById('driver-count').textContent = 'Cargando...';
        }

        // Funci√≥n para mostrar estado de error
        function showErrorState(message) {
            const tableBody = document.getElementById('drivers-table-body');
            tableBody.innerHTML = `
                <tr>
                    <td colspan="8">
                        <div class="error">
                            ${message}
                            <br>
                            <button class="btn" onclick="loadDriversFromDatabase()" style="margin-top: 1rem;">
                                Reintentar
                            </button>
                        </div>
                    </td>
                </tr>
            `;
            document.getElementById('driver-count').textContent = 'Error';
        }

        // Funci√≥n para renderizar la tabla de conductores
        function renderDriversTable(drivers) {
            const tableBody = document.getElementById('drivers-table-body');
            const driverCount = document.getElementById('driver-count');
            
            if (drivers.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="8" class="loading">No se encontraron conductores en la base de datos</td>
                    </tr>
                `;
                driverCount.textContent = 'Total: 0 conductores';
                return;
            }
            
            tableBody.innerHTML = '';
            driverCount.textContent = `Total: ${drivers.length} conductores`;
            
            drivers.forEach(driver => {
                const row = document.createElement('tr');
                
                // USAR CAMPOS REALES DE LA BASE DE DATOS
                let statusClass = '';
                let statusText = '';
                
                if (driver.activo) {
                    statusClass = 'active';
                    statusText = 'Activo';
                } else {
                    statusClass = 'inactive';
                    statusText = 'Inactivo';
                }

                // Veh√≠culo asignado
                const vehicleAssigned = driver.vehiculo_asignado ? 
                    (driver.vehiculo_asignado_patente || driver.vehiculo_asignado.patente || 'Asignado') : 
                    'Sin asignar';
                
                row.innerHTML = `
                    <td>${driver.nombre || 'N/A'}</td>
                    <td>${driver.rut || 'N/A'}</td>
                    <td>${driver.licencia || 'N/A'}</td>
                    <td>${driver.telefono || 'N/A'}</td>
                    <td>${driver.email || 'N/A'}</td>
                    <td>${vehicleAssigned}</td>
                    <td><span class="badge ${statusClass}">${statusText}</span></td>
                    <td>
                        <button class="action-btn" onclick="viewDriver(${driver.id})">Ver</button>
                        <button class="action-btn" onclick="window.location.href='/conductores/${driver.id}/editar/'">Editar</button>
                        <button class="action-btn delete" onclick="deleteDriver(${driver.id})">Eliminar</button>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
        }

        // Funci√≥n para filtrar conductores
        function filterDrivers() {
            const statusFilter = document.getElementById('filter-status').value;
            const searchText = document.getElementById('search-input').value.toLowerCase();
            
            const filteredDrivers = driversData.filter(driver => {
                // Filtro por estado (usando campo 'activo' real)
                const matchesStatus = !statusFilter || 
                    (statusFilter === 'active' && driver.activo) ||
                    (statusFilter === 'inactive' && !driver.activo) ||
                    (statusFilter === 'vacation' && !driver.activo);
                
                // Filtro por b√∫squeda
                const matchesSearch = !searchText || 
                    (driver.nombre && driver.nombre.toLowerCase().includes(searchText)) ||
                    (driver.rut && driver.rut.toLowerCase().includes(searchText)) ||
                    (driver.licencia && driver.licencia.toLowerCase().includes(searchText)) ||
                    (driver.email && driver.email.toLowerCase().includes(searchText));
                
                return matchesStatus && matchesSearch;
            });
            
            renderDriversTable(filteredDrivers);
        }

        // Funciones de acci√≥n para los conductores
        async function viewDriver(driverId) {
            try {
                const response = await fetch(`/api/conductores/${driverId}/`);
                const driverDetails = await response.json();
                
                showNotification(`Viendo detalles del conductor ${driverId}`);
                console.log('Detalles del conductor:', driverDetails);
                
            } catch (error) {
                console.error('Error al obtener detalles:', error);
                showNotification('Error al cargar detalles del conductor');
            }
        }

        async function deleteDriver(driverId) {
            if (confirm('¬øEst√° seguro de que desea eliminar este conductor?')) {
                try {
                    const response = await fetch(`/api/conductores/${driverId}/`, {
                        method: 'DELETE',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-CSRFToken': getCSRFToken()
                        }
                    });
                    
                    if (response.ok) {
                        await loadDriversFromDatabase();
                        showNotification('Conductor eliminado correctamente');
                    } else {
                        throw new Error('Error al eliminar el conductor');
                    }
                } catch (error) {
                    console.error('Error:', error);
                    showNotification('Error al eliminar el conductor');
                }
            }
        }

        // Funciones para el modal de nuevo conductor
        function showNewDriverModal() {
            showModal('newDriverModal');
        }

        async function createDriver(formData) {
            try {
                const response = await fetch('/api/conductores/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': getCSRFToken()
                    },
                    body: JSON.stringify(formData)
                });
                
                if (response.ok) {
                    const newDriver = await response.json();
                    showNotification('Conductor creado exitosamente');
                    closeModal('newDriverModal');
                    await loadDriversFromDatabase();
                    return newDriver;
                } else {
                    const errorData = await response.json();
                    throw new Error(errorData.detail || 'Error al crear el conductor');
                }
            } catch (error) {
                console.error('Error:', error);
                showNotification('Error al crear el conductor: ' + error.message);
                throw error;
            }
        }

        function handleDriverFormSubmit(e) {
            e.preventDefault();
            
            const formData = {
                nombre: document.querySelector('input[name="nombre"]').value,
                rut: document.querySelector('input[name="rut"]').value,
                licencia: document.querySelector('input[name="licencia"]').value,
                telefono: document.querySelector('input[name="telefono"]').value,
                email: document.querySelector('input[name="email"]').value,
                activo: document.querySelector('input[name="activo"]').checked
            };
            
            createDriver(formData);
        }

        // Funciones auxiliares para modals
        function showModal(modalId) {
            document.getElementById(modalId).style.display = 'block';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
            // Resetear formulario
            if (modalId === 'newDriverModal') {
                document.getElementById('newDriverForm').reset();
            }
        }

        // Funci√≥n auxiliar para obtener el token CSRF
        function getCSRFToken() {
            const name = 'csrftoken';
            let cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                const cookies = document.cookie.split(';');
                for (let i = 0; i < cookies.length; i++) {
                    const cookie = cookies[i].trim();
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }

        // Funci√≥n para mostrar notificaciones
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.textContent = `‚úì ${message}`;
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: linear-gradient(135deg, #6366f1, #06b6d4);
                color: white;
                padding: 1rem 2rem;
                border-radius: 12px;
                box-shadow: 0 10px 30px rgba(99, 102, 241, 0.4);
                z-index: 1000;
                animation: slideInRight 0.4s ease-out;
                font-weight: 600;
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOutRight 0.4s ease-out';
                setTimeout(() => notification.remove(), 400);
            }, 3000);
        }

        // Inicializaci√≥n cuando se carga la p√°gina
        document.addEventListener('DOMContentLoaded', function() {
            loadDriversFromDatabase();
            
            document.getElementById('filter-status').addEventListener('change', filterDrivers);
            document.getElementById('search-input').addEventListener('input', filterDrivers);
            
            document.getElementById('new-driver-btn').addEventListener('click', showNewDriverModal);
            
            document.getElementById('newDriverForm').addEventListener('submit', handleDriverFormSubmit);
            
            console.log('üë®‚Äçüíº M√≥dulo de Conductores cargado exitosamente');
        });

        // Estilos para las animaciones de notificaciones
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideInRight {
                from {
                    transform: translateX(400px);
                    opacity: 0;
                }
                to {
                    transform: translateX(0);
                    opacity: 1;
                }
            }
            @keyframes slideOutRight {
                from {
                    transform: translateX(0);
                    opacity: 1;
                }
                to {
                    transform: translateX(400px);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(style);

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            });
        }
    </script>
</body>
</html>
============================================================


===== conductor_confirm_delete.html =====
{% extends 'base.html' %}

{% block title %}Eliminar Conductor - Log√≠stica Global{% endblock %}

{% block content %}
<div class="page-title">
    <span>üóëÔ∏è</span>
    <span>Eliminar Conductor</span>
</div>

<div class="content-card">
    <div style="text-align: center; margin-bottom: 2rem;">
        <div style="font-size: 4rem; margin-bottom: 1rem;">‚ö†Ô∏è</div>
        <h2 style="margin-bottom: 1rem;">¬øEst√°s seguro de que deseas eliminar este conductor?</h2>
        <p style="color: var(--text-secondary); margin-bottom: 2rem;">
            Conductor: {{ conductor.nombre }}<br>
            Licencia: {{ conductor.licencia }}<br>
            Esta acci√≥n no se puede deshacer.
        </p>
    </div>

    <form method="post" style="text-align: center;">
        {% csrf_token %}
        <div class="action-buttons" style="justify-content: center;">
            <button type="submit" class="btn btn-danger">S√≠, eliminar</button>
            <a href="{% url 'conductores' %}" class="btn btn-secondary">Cancelar</a>
        </div>
    </form>
</div>
{% endblock %}
============================================================


===== conductor_detail.html =====
<!-- conductor_detail.html -->
{% extends 'base.html' %}

{% block title %}Conductor {{ conductor.nombre }} - Log√≠stica Global{% endblock %}

{% block content %}
<div class="page-title">
    <span>üë®‚Äçüíº</span>
    <span>Conductor {{ conductor.nombre }}</span>
</div>

<div class="content-card">
    <div class="detail-grid">
        <div class="detail-item">
            <div class="detail-label">ID</div>
            <div class="detail-value">{{ conductor.id }}</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Nombre</div>
            <div class="detail-value">{{ conductor.nombre }}</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">RUT</div>
            <div class="detail-value">{{ conductor.rut }}</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Licencia</div>
            <div class="detail-value">{{ conductor.licencia }}</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Tel√©fono</div>
            <div class="detail-value">{{ conductor.telefono }}</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Email</div>
            <div class="detail-value">{{ conductor.email }}</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Estado</div>
            <div class="detail-value">
                <span class="badge {% if conductor.activo %}active{% else %}alert{% endif %}">
                    {% if conductor.activo %}Activo{% else %}Inactivo{% endif %}
                </span>
            </div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Veh√≠culo Asignado</div>
            <div class="detail-value">
                {% if conductor.vehiculo_set.exists %}
                    {{ conductor.vehiculo_set.first.patente }}
                {% else %}
                    <span style="color: var(--text-secondary);">Sin asignar</span>
                {% endif %}
            </div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Despachos Asignados</div>
            <div class="detail-value">{{ conductor.despacho_set.count }}</div>
        </div>
    </div>

    <div class="action-buttons">
        <a href="{% url 'conductor_edit' conductor.pk %}" class="btn">Editar</a>
        <a href="{% url 'conductor_delete' conductor.pk %}" class="btn btn-danger">Eliminar</a>
        <a href="{% url 'conductores' %}" class="btn btn-secondary">Volver a la lista</a>
    </div>
</div>
{% endblock %}
============================================================


===== conductor_editar.html =====
{% extends 'base.html' %}

{% block title %}Editar Conductor - Log√≠stica Global{% endblock %}

{% block content %}
<div class="page-title">
    <span>üë®‚Äçüíº</span>
    <span>Editar Conductor</span>
</div>

<div class="content-card">
    <form method="post">
        {% csrf_token %}
        
        <div class="form-row">
            <div class="form-group">
                <label class="form-label">Nombre</label>
                <input type="text" class="form-input" name="nombre" value="{{ conductor.nombre }}" required>
            </div>
            <div class="form-group">
                <label class="form-label">RUT</label>
                <input type="text" class="form-input" name="rut" value="{{ conductor.rut }}" required>
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label class="form-label">Licencia</label>
                <input type="text" class="form-input" name="licencia" value="{{ conductor.licencia }}" required>
            </div>
            <div class="form-group">
                <label class="form-label">Tel√©fono</label>
                <input type="tel" class="form-input" name="telefono" value="{{ conductor.telefono }}" required>
            </div>
        </div>

        <div class="form-group">
            <label class="form-label">Email</label>
            <input type="email" class="form-input" name="email" value="{{ conductor.email }}" required>
        </div>

        <div class="form-group">
            <label class="form-label">
                <input type="checkbox" name="activo" {% if conductor.activo %}checked{% endif %}> Activo
            </label>
        </div>

        <div class="action-buttons">
            <button type="submit" class="btn btn-success">Actualizar Conductor</button>
            <a href="{% url 'conductores' %}" class="btn btn-secondary">Cancelar</a>
        </div>
    </form>
</div>
{% endblock %}
============================================================


===== conductor_form.html =====
{% extends 'base.html' %}

{% block title %}Nuevo Conductor - Log√≠stica Global{% endblock %}

{% block content %}
<div class="page-title">
    <span>üë®‚Äçüíº</span>
    <span>Nuevo Conductor</span>
</div>

<div class="content-card">
    <form method="post">
        {% csrf_token %}
        
        <div class="form-group">
            <label class="form-label">Nombre *</label>
            <input type="text" class="form-input" name="nombre" required>
        </div>
        
        <div class="form-group">
            <label class="form-label">RUT *</label>
            <input type="text" class="form-input" name="rut" required>
        </div>
        
        <div class="form-group">
            <label class="form-label">Licencia *</label>
            <input type="text" class="form-input" name="licencia" required>
        </div>
        
        <div class="form-group">
            <label class="form-label">Tel√©fono *</label>
            <input type="text" class="form-input" name="telefono" required>
        </div>
        
        <div class="form-group">
            <label class="form-label">Email *</label>
            <input type="email" class="form-input" name="email" required>
        </div>
        
        <div class="form-group">
            <label class="form-label">
                <input type="checkbox" name="activo" checked> Activo
            </label>
        </div>
        
        <div class="action-buttons">
            <button type="submit" class="btn">Crear Conductor</button>
            <a href="{% url 'conductores' %}" class="btn btn-secondary">Cancelar</a>
        </div>
    </form>
</div>
{% endblock %}
============================================================


===== dashboard.html =====
{% extends 'base.html' %}

{% block title %}Dashboard - Log√≠stica Global{% endblock %}

{% block content %}
<div class="page-title">
    <span>üìä</span>
    <span>Dashboard Principal</span>
</div>

<!-- Indicador de Permisos -->
{% if user.is_superuser or user.perfilusuario.tipo_usuario == 'ADMIN' %}
<div style="background: rgba(16, 185, 129, 0.2); border: 1px solid var(--success); border-radius: 12px; padding: 1rem; margin-bottom: 1.5rem;">
    <div style="display: flex; align-items: center; gap: 0.5rem; color: var(--success);">
        <span>üëë</span>
        <div>
            <strong>Modo Administrador</strong>
            <div style="font-size: 0.9rem; opacity: 0.9;">
                Tienes acceso completo al sistema: crear, editar, eliminar y generar reportes.
            </div>
        </div>
    </div>
</div>
{% else %}
<div style="background: rgba(59, 130, 246, 0.2); border: 1px solid #3b82f6; border-radius: 12px; padding: 1rem; margin-bottom: 1.5rem;">
    <div style="display: flex; align-items: center; gap: 0.5rem; color: #3b82f6;">
        <span>üîí</span>
        <div>
            <strong>Modo Solo Lectura</strong>
            <div style="font-size: 0.9rem; opacity: 0.9;">
                Como {{ user.perfilusuario.tipo_usuario|title }}, solo puedes visualizar informaci√≥n.
            </div>
        </div>
    </div>
</div>
{% endif %}

<!-- Estad√≠sticas Principales -->
<div class="stats-grid">
    <div class="stat-card" onclick="window.location.href='{% url 'vehiculos' %}'">
        <div class="stat-icon" style="background: linear-gradient(135deg, var(--primary), var(--secondary));">üöõ</div>
        <div>
            <div class="stat-value">{{ total_vehiculos }}</div>
            <div class="stat-label">Veh√≠culos Activos</div>
        </div>
    </div>
    
    <div class="stat-card" onclick="window.location.href='{% url 'aeronaves' %}'">
        <div class="stat-icon" style="background: linear-gradient(135deg, var(--accent), var(--warning));">‚úàÔ∏è</div>
        <div>
            <div class="stat-value">{{ total_aeronaves }}</div>
            <div class="stat-label">Aeronaves Activas</div>
        </div>
    </div>
    
    <div class="stat-card" onclick="window.location.href='{% url 'despachos' %}'">
        <div class="stat-icon" style="background: linear-gradient(135deg, var(--success), #059669);">üì¶</div>
        <div>
            <div class="stat-value">{{ total_despachos }}</div>
            <div class="stat-label">Total Despachos</div>
        </div>
    </div>
    
    <div class="stat-card" onclick="window.location.href='{% url 'clientes' %}'">
        <div class="stat-icon" style="background: linear-gradient(135deg, var(--info), #1d4ed8);">üë•</div>
        <div>
            <div class="stat-value">{{ total_clientes }}</div>
            <div class="stat-label">Clientes Activos</div>
        </div>
    </div>
</div>

<div class="dashboard-grid">
    <!-- Columna Principal -->
    <div>
        <!-- √öltimos Despachos -->
        <div class="content-card">
            <div class="card-header">
                <h3>üì¶ √öltimos Despachos</h3>
                <a href="{% url 'despachos' %}" class="btn">Ver Todos</a>
            </div>
            
            {% if ultimos_despachos %}
            <div style="overflow-x: auto;">
                <table style="width: 100%; border-collapse: collapse;">
                    <thead>
                        <tr style="border-bottom: 1px solid var(--border);">
                            <th style="padding: 1rem; text-align: left; color: var(--text-secondary);">ID</th>
                            <th style="padding: 1rem; text-align: left; color: var(--text-secondary);">Cliente</th>
                            <th style="padding: 1rem; text-align: left; color: var(--text-secondary);">Ruta</th>
                            <th style="padding: 1rem; text-align: left; color: var(--text-secondary);">Estado</th>
                            <th style="padding: 1rem; text-align: left; color: var(--text-secondary);">Fecha</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for despacho in ultimos_despachos %}
                        <tr style="border-bottom: 1px solid var(--border); cursor: pointer;" 
                            onclick="window.location.href='{% url 'despacho_detail' despacho.pk %}'">
                            <td style="padding: 1rem;">DESP-{{ despacho.id }}</td>
                            <td style="padding: 1rem;">{{ despacho.cliente.razon_social }}</td>
                            <td style="padding: 1rem;">{{ despacho.ruta.origen }} - {{ despacho.ruta.destino }}</td>
                            <td style="padding: 1rem;">
                                <span class="badge 
                                    {% if despacho.estado == 'ENTREGADO' %}active
                                    {% elif despacho.estado == 'EN_RUTA' %}info
                                    {% elif despacho.estado == 'PENDIENTE' %}pending
                                    {% else %}alert{% endif %}">
                                    {{ despacho.estado }}
                                </span>
                            </td>
                            <td style="padding: 1rem;">{{ despacho.fecha_despacho|date:"d/m/Y" }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            {% else %}
            <div style="text-align: center; padding: 2rem; color: var(--text-secondary);">
                No hay despachos registrados
            </div>
            {% endif %}
        </div>

        <!-- Acciones R√°pidas (Solo Admin) -->
        {% if user.is_superuser or user.perfilusuario.tipo_usuario == 'ADMIN' %}
        <div class="content-card">
            <div class="card-header">
                <h3>‚ö° Acciones R√°pidas</h3>
            </div>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                <button class="btn" onclick="window.location.href='{% url 'despacho_crear' %}'">‚ûï Nuevo Despacho</button>
                <button class="btn" onclick="window.location.href='{% url 'vehiculo_crear' %}'">üöõ Nuevo Veh√≠culo</button>
                <button class="btn" onclick="window.location.href='{% url 'aeronave_crear' %}'">‚úàÔ∏è Nueva Aeronave</button>
                <button class="btn" onclick="window.location.href='{% url 'generar_reporte_pdf' %}'">üìä Generar Reporte PDF</button>
            </div>
        </div>
        {% endif %}
    </div>

    <!-- Columna Lateral -->
    <div>
        <!-- Estado del Sistema -->
        <div class="content-card">
            <div class="card-header">
                <h3>üîç Estado del Sistema</h3>
            </div>
            <div style="display: flex; flex-direction: column; gap: 1rem;">
                <div style="display: flex; justify-content: between; align-items: center;">
                    <span>Veh√≠culos Activos</span>
                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                        <div style="width: 100px; height: 8px; background: var(--border); border-radius: 4px;">
                            <div style="width: {{ porcentaje_vehiculos_activos }}%; height: 100%; background: var(--success); border-radius: 4px;"></div>
                        </div>
                        <span>{{ porcentaje_vehiculos_activos }}%</span>
                    </div>
                </div>
                
                <div style="display: flex; justify-content: between; align-items: center;">
                    <span>Aeronaves Activas</span>
                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                        <div style="width: 100px; height: 8px; background: var(--border); border-radius: 4px;">
                            <div style="width: {{ porcentaje_aeronaves_activas }}%; height: 100%; background: var(--accent); border-radius: 4px;"></div>
                        </div>
                        <span>{{ porcentaje_aeronaves_activas }}%</span>
                    </div>
                </div>
                
                <div style="display: flex; justify-content: between; align-items: center;">
                    <span>Personal Activo</span>
                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                        <div style="width: 100px; height: 8px; background: var(--border); border-radius: 4px;">
                            <div style="width: {{ porcentaje_personal_activo }}%; height: 100%; background: var(--info); border-radius: 4px;"></div>
                        </div>
                        <span>{{ porcentaje_personal_activo }}%</span>
                    </div>
                </div>
                
                <div style="display: flex; justify-content: between; align-items: center;">
                    <span>Seguros Vigentes</span>
                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                        <div style="width: 100px; height: 8px; background: var(--border); border-radius: 4px;">
                            <div style="width: {{ porcentaje_seguros_vigentes }}%; height: 100%; background: var(--primary); border-radius: 4px;"></div>
                        </div>
                        <span>{{ porcentaje_seguros_vigentes }}%</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Seguros Pr√≥ximos a Vencer (Solo Admin) -->
        {% if user.is_superuser or user.perfilusuario.tipo_usuario == 'ADMIN' %}
        <div class="content-card">
            <div class="card-header">
                <h3>üõ°Ô∏è Seguros Recientes</h3>
                <a href="{% url 'seguros' %}" class="btn">Ver Todos</a>
            </div>
            
            {% if seguros_recientes %}
            <div style="display: flex; flex-direction: column; gap: 1rem;">
                {% for seguro in seguros_recientes %}
                <div style="padding: 1rem; background: rgba(51, 65, 85, 0.3); border-radius: 8px; border-left: 4px solid var(--info);">
                    <div style="font-weight: 600; margin-bottom: 0.5rem;">{{ seguro.numero_poliza }}</div>
                    <div style="font-size: 0.9rem; color: var(--text-secondary);">
                        {{ seguro.aseguradora }} - Vence: {{ seguro.vigencia_hasta|date:"d/m/Y" }}
                    </div>
                    <div style="margin-top: 0.5rem;">
                        <span class="badge {% if seguro.estado == 'VIGENTE' %}active{% else %}warning{% endif %}">
                            {{ seguro.estado }}
                        </span>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <div style="text-align: center; padding: 1rem; color: var(--text-secondary);">
                No hay seguros registrados
            </div>
            {% endif %}
        </div>
        {% endif %}
    </div>
</div>

<style>
.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1.5rem;
    margin-bottom: 2rem;
}

.stat-card {
    background: linear-gradient(135deg, rgba(30, 41, 59, 0.8), rgba(30, 41, 59, 0.4));
    backdrop-filter: blur(10px);
    border-radius: 15px;
    border: 1px solid var(--border);
    padding: 1.5rem;
    display: flex;
    align-items: center;
    gap: 1rem;
    transition: transform 0.3s ease;
    cursor: pointer;
}

.stat-card:hover {
    transform: translateY(-5px);
    border-color: var(--primary);
}

.stat-icon {
    width: 60px;
    height: 60px;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
}

.stat-value {
    font-size: 2rem;
    font-weight: 700;
    margin-bottom: 0.25rem;
}

.stat-label {
    color: var(--text-secondary);
    font-size: 0.9rem;
}

.dashboard-grid {
    display: grid;
    grid-template-columns: 2fr 1fr;
    gap: 2rem;
}

.card-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1.5rem;
}

.card-header h3 {
    font-size: 1.3rem;
    font-weight: 600;
}

@media (max-width: 768px) {
    .dashboard-grid {
        grid-template-columns: 1fr;
    }
    
    .stats-grid {
        grid-template-columns: 1fr;
    }
}
</style>

<script>
// Funci√≥n para actualizar el dashboard cada 30 segundos
function actualizarDashboard() {
    console.log('Actualizando datos del dashboard...');
    // En una implementaci√≥n real, aqu√≠ har√≠as una llamada AJAX
}

// Actualizar cada 30 segundos
setInterval(actualizarDashboard, 30000);

console.log('üìä Dashboard cargado exitosamente');
</script>
{% endblock %}
============================================================


===== dashboard_usuario.html =====
{% extends 'base.html' %}

{% block title %}Dashboard - Log√≠stica Global{% endblock %}

{% block content %}
<div class="page-title">
    <span>üëã</span>
    <span>Bienvenido, {{ nombre_usuario }}</span>
</div>

<!-- Informaci√≥n para Usuarios No-Admin -->
<div style="background: rgba(59, 130, 246, 0.2); border: 1px solid #3b82f6; border-radius: 12px; padding: 1.5rem; margin-bottom: 2rem;">
    <div style="display: flex; align-items: center; gap: 1rem;">
        <span style="font-size: 2rem;">üîí</span>
        <div>
            <h3 style="margin-bottom: 0.5rem; color: #3b82f6;">Modo de Solo Lectura</h3>
            <p style="color: var(--text-secondary); margin: 0;">
                Como <strong>{{ tipo_usuario }}</strong>, tienes acceso de visualizaci√≥n a toda la informaci√≥n del sistema. 
                Puedes explorar despachos, rutas, veh√≠culos, aeronaves y m√°s, pero no puedes realizar modificaciones.
            </p>
        </div>
    </div>
</div>

<!-- Estad√≠sticas de Visualizaci√≥n -->
<div class="stats-grid">
    <div class="stat-card" onclick="window.location.href='{% url 'rutas' %}'">
        <div class="stat-icon" style="background: linear-gradient(135deg, var(--primary), var(--secondary));">üó∫Ô∏è</div>
        <div>
            <div class="stat-value">{{ rutas_count|default:"0" }}</div>
            <div class="stat-label">Rutas Disponibles</div>
        </div>
    </div>
    
    <div class="stat-card" onclick="window.location.href='{% url 'vehiculos' %}'">
        <div class="stat-icon" style="background: linear-gradient(135deg, var(--accent), var(--warning));">üöõ</div>
        <div>
            <div class="stat-value">{{ vehiculos_count|default:"0" }}</div>
            <div class="stat-label">Veh√≠culos Activos</div>
        </div>
    </div>
    
    <div class="stat-card" onclick="window.location.href='{% url 'aeronaves' %}'">
        <div class="stat-icon" style="background: linear-gradient(135deg, var(--success), #059669);">‚úàÔ∏è</div>
        <div>
            <div class="stat-value">{{ aeronaves_count|default:"0" }}</div>
            <div class="stat-label">Aeronaves Activas</div>
        </div>
    </div>
    
    <div class="stat-card" onclick="window.location.href='{% url 'despachos' %}'">
        <div class="stat-icon" style="background: linear-gradient(135deg, var(--info), #1d4ed8);">üì¶</div>
        <div>
            <div class="stat-value">{{ despachos_count|default:"0" }}</div>
            <div class="stat-label">Despachos Totales</div>
        </div>
    </div>
</div>

<div class="dashboard-grid">
    <!-- Columna Principal -->
    <div>
        <!-- Informaci√≥n de Rutas -->
        <div class="content-card">
            <div class="card-header">
                <h3>üó∫Ô∏è Rutas Disponibles</h3>
                <a href="{% url 'rutas' %}" class="btn">Explorar Todas</a>
            </div>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                <div style="padding: 1.5rem; background: rgba(51, 65, 85, 0.3); border-radius: 12px; text-align: center;">
                    <div style="font-size: 2rem; margin-bottom: 0.5rem;">üöõ</div>
                    <div style="font-weight: 600;">Rutas Terrestres</div>
                    <div style="color: var(--text-secondary); font-size: 0.9rem;">Ver todas las rutas por carretera</div>
                </div>
                <div style="padding: 1.5rem; background: rgba(51, 65, 85, 0.3); border-radius: 12px; text-align: center;">
                    <div style="font-size: 2rem; margin-bottom: 0.5rem;">‚úàÔ∏è</div>
                    <div style="font-weight: 600;">Rutas A√©reas</div>
                    <div style="color: var(--text-secondary); font-size: 0.9rem;">Explorar rutas de transporte a√©reo</div>
                </div>
            </div>
        </div>

        <!-- Flota Disponible -->
        <div class="content-card">
            <div class="card-header">
                <h3>üöö Flota de Transporte</h3>
                <div style="display: flex; gap: 0.5rem;">
                    <a href="{% url 'vehiculos' %}" class="btn btn-secondary">Veh√≠culos</a>
                    <a href="{% url 'aeronaves' %}" class="btn btn-secondary">Aeronaves</a>
                </div>
            </div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">
                <div style="text-align: center;">
                    <div style="font-size: 3rem; margin-bottom: 1rem;">üöõ</div>
                    <div style="font-weight: 600; margin-bottom: 0.5rem;">Veh√≠culos Terrestres</div>
                    <div style="color: var(--text-secondary);">Camiones, furgonetas y veh√≠culos de carga</div>
                </div>
                <div style="text-align: center;">
                    <div style="font-size: 3rem; margin-bottom: 1rem;">‚úàÔ∏è</div>
                    <div style="font-weight: 600; margin-bottom: 0.5rem;">Aeronaves</div>
                    <div style="color: var(--text-secondary);">Aviones de carga y transporte a√©reo</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Columna Lateral -->
    <div>
        <!-- Accesos R√°pidos -->
        <div class="content-card">
            <div class="card-header">
                <h3>üîç Navegaci√≥n R√°pida</h3>
            </div>
            <div style="display: flex; flex-direction: column; gap: 1rem;">
                <button class="btn" onclick="window.location.href='{% url 'rutas' %}'">üó∫Ô∏è Ver Todas las Rutas</button>
                <button class="btn" onclick="window.location.href='{% url 'vehiculos' %}'">üöõ Explorar Veh√≠culos</button>
                <button class="btn" onclick="window.location.href='{% url 'aeronaves' %}'">‚úàÔ∏è Ver Aeronaves</button>
                <button class="btn" onclick="window.location.href='{% url 'despachos' %}'">üì¶ Revisar Despachos</button>
                <button class="btn" onclick="window.location.href='{% url 'api' %}'">üîó Documentaci√≥n API</button>
            </div>
        </div>

        <!-- Informaci√≥n del Sistema -->
        <div class="content-card">
            <div class="card-header">
                <h3>‚ÑπÔ∏è Informaci√≥n</h3>
            </div>
            <div style="display: flex; flex-direction: column; gap: 1rem;">
                <div style="display: flex; justify-content: between; align-items: center; padding: 1rem; background: rgba(51, 65, 85, 0.3); border-radius: 8px;">
                    <span>Tu Rol</span>
                    <span class="badge info">{{ tipo_usuario }}</span>
                </div>
                <div style="display: flex; justify-content: between; align-items: center; padding: 1rem; background: rgba(51, 65, 85, 0.3); border-radius: 8px;">
                    <span>Fecha de Acceso</span>
                    <span>{{ today|date:"d/m/Y" }}</span>
                </div>
                <div style="padding: 1rem; background: rgba(16, 185, 129, 0.1); border-radius: 8px; border-left: 4px solid var(--success);">
                    <div style="font-weight: 600; margin-bottom: 0.5rem;">üí° Tip</div>
                    <div style="font-size: 0.9rem; color: var(--text-secondary);">
                        Usa el men√∫ de navegaci√≥n para explorar todas las secciones disponibles para tu rol.
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1.5rem;
    margin-bottom: 2rem;
}

.stat-card {
    background: linear-gradient(135deg, rgba(30, 41, 59, 0.8), rgba(30, 41, 59, 0.4));
    backdrop-filter: blur(10px);
    border-radius: 15px;
    border: 1px solid var(--border);
    padding: 1.5rem;
    display: flex;
    align-items: center;
    gap: 1rem;
    transition: transform 0.3s ease;
    cursor: pointer;
}

.stat-card:hover {
    transform: translateY(-5px);
    border-color: var(--primary);
}

.stat-icon {
    width: 60px;
    height: 60px;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
}

.stat-value {
    font-size: 2rem;
    font-weight: 700;
    margin-bottom: 0.25rem;
}

.stat-label {
    color: var(--text-secondary);
    font-size: 0.9rem;
}

.dashboard-grid {
    display: grid;
    grid-template-columns: 2fr 1fr;
    gap: 2rem;
}

.card-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1.5rem;
}

.card-header h3 {
    font-size: 1.3rem;
    font-weight: 600;
}

@media (max-width: 768px) {
    .dashboard-grid {
        grid-template-columns: 1fr;
    }
    
    .stats-grid {
        grid-template-columns: 1fr;
    }
}
</style>

<script>
// Configuraci√≥n inicial para usuarios no-admin
console.log('üë§ Dashboard de usuario cargado - Modo solo lectura');
console.log('Rol actual: {{ tipo_usuario }}');

// Funci√≥n para mostrar informaci√≥n contextual
function mostrarInfoContextual() {
    console.log('üí° Recuerda que como {{ tipo_usuario }}, tienes acceso de solo lectura.');
    console.log('üìä Puedes visualizar toda la informaci√≥n pero no realizar modificaciones.');
}

// Ejecutar al cargar
document.addEventListener('DOMContentLoaded', function() {
    mostrarInfoContextual();
});
</script>
{% endblock %}
============================================================


===== despachos.html =====
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Despachos - Sistema de Gesti√≥n de Transporte</title>
    <style>
        /* Todos los estilos del dashboard original */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #06b6d4;
            --accent: #f59e0b;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --info: #3b82f6;
            --bg-dark: #0f172a;
            --bg-card: #1e293b;
            --bg-hover: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --border: #334155;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--bg-dark) 0%, #1e293b 100%);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .bg-animation {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 0;
            overflow: hidden;
        }

        .bg-animation span {
            position: absolute;
            display: block;
            width: 20px;
            height: 20px;
            background: rgba(99, 102, 241, 0.1);
            animation: float 25s infinite;
            border-radius: 50%;
        }

        .bg-animation span:nth-child(1) { left: 25%; animation-delay: 0s; }
        .bg-animation span:nth-child(2) { left: 10%; animation-delay: 2s; animation-duration: 30s; }
        .bg-animation span:nth-child(3) { left: 70%; animation-delay: 4s; }
        .bg-animation span:nth-child(4) { left: 40%; animation-delay: 0s; animation-duration: 18s; }
        .bg-animation span:nth-child(5) { left: 65%; animation-delay: 0s; }
        .bg-animation span:nth-child(6) { left: 75%; animation-delay: 3s; }
        .bg-animation span:nth-child(7) { left: 35%; animation-delay: 7s; }
        .bg-animation span:nth-child(8) { left: 50%; animation-delay: 15s; animation-duration: 45s; }
        .bg-animation span:nth-child(9) { left: 20%; animation-delay: 2s; animation-duration: 35s; }
        .bg-animation span:nth-child(10) { left: 85%; animation-delay: 0s; animation-duration: 11s; }

        @keyframes float {
            0% {
                transform: translateY(100vh) scale(0);
                opacity: 0;
            }
            50% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100vh) scale(1);
                opacity: 0;
            }
        }

        .container {
            position: relative;
            z-index: 1;
            max-width: 1600px;
            margin: 0 auto;
            padding: 2.5rem 3rem;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 3rem;
            background: rgba(30, 41, 59, 0.6);
            backdrop-filter: blur(10px);
            padding: 1.5rem 2.5rem;
            border-radius: 20px;
            border: 1px solid var(--border);
            animation: slideDown 0.6s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 1rem;
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .logo-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            animation: rotate3d 3s infinite ease-in-out;
        }

        @keyframes rotate3d {
            0%, 100% { transform: rotateY(0deg); }
            50% { transform: rotateY(180deg); }
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .avatar {
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, var(--accent), var(--danger));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .avatar:hover {
            transform: scale(1.1) rotate(5deg);
        }

        .nav-menu {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .nav-item {
            padding: 0.8rem 1.5rem;
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .nav-item:hover, .nav-item.active {
            background: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(99, 102, 241, 0.4);
        }

        .page-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .filters {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .filter-group {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .filter-select, .search-input {
            padding: 0.8rem 1.2rem;
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 0.95rem;
            min-width: 180px;
        }

        .search-input {
            flex: 1;
            min-width: 250px;
        }

        .btn {
            padding: 0.8rem 1.5rem;
            background: var(--primary);
            border: none;
            border-radius: 12px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(99, 102, 241, 0.4);
        }

        .btn-secondary {
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background: var(--bg-hover);
        }

        .table-container {
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.8), rgba(30, 41, 59, 0.4));
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 1px solid var(--border);
            overflow: hidden;
            margin-bottom: 2rem;
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem 2rem;
            border-bottom: 1px solid var(--border);
        }

        .table-title {
            font-size: 1.3rem;
            font-weight: 600;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
        }

        .table th {
            text-align: left;
            padding: 1.2rem 1.5rem;
            background: rgba(51, 65, 85, 0.3);
            font-weight: 600;
            color: var(--text-secondary);
            border-bottom: 1px solid var(--border);
        }

        .table td {
            padding: 1.2rem 1.5rem;
            border-bottom: 1px solid var(--border);
        }

        .table tr:last-child td {
            border-bottom: none;
        }

        .table tr:hover {
            background: rgba(51, 65, 85, 0.2);
        }

        .badge {
            padding: 0.4rem 1rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .badge.entregado {
            background: rgba(16, 185, 129, 0.2);
            color: var(--success);
        }

        .badge.transito {
            background: rgba(59, 130, 246, 0.2);
            color: var(--info);
        }

        .badge.pendiente {
            background: rgba(245, 158, 11, 0.2);
            color: var(--warning);
        }

        .badge.cancelado {
            background: rgba(239, 68, 68, 0.2);
            color: var(--danger);
        }

        .badge.terrestre {
            background: rgba(99, 102, 241, 0.2);
            color: var(--primary);
        }

        .badge.aereo {
            background: rgba(6, 182, 212, 0.2);
            color: var(--secondary);
        }

        .loading {
            text-align: center;
            padding: 2rem;
            color: var(--text-secondary);
        }

        .error {
            text-align: center;
            padding: 2rem;
            color: var(--danger);
            background: rgba(239, 68, 68, 0.1);
            border-radius: 12px;
            margin: 1rem 0;
        }

        .pagination {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem 2rem;
            border-top: 1px solid var(--border);
        }

        .pagination-info {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .pagination-controls {
            display: flex;
            gap: 0.5rem;
        }

        .pagination-btn {
            padding: 0.6rem 1rem;
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .pagination-btn:hover {
            background: var(--primary);
        }

        .pagination-btn.active {
            background: var(--primary);
        }

        .action-btn {
            padding: 0.4rem 0.8rem;
            background: rgba(99, 102, 241, 0.2);
            border: 1px solid var(--primary);
            border-radius: 8px;
            color: var(--primary);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.85rem;
            margin-right: 0.5rem;
        }

        .action-btn:hover {
            background: var(--primary);
            color: white;
        }

        .action-btn.delete {
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid var(--danger);
            color: var(--danger);
        }

        .action-btn.delete:hover {
            background: var(--danger);
            color: white;
        }

        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }

            .header {
                flex-direction: column;
                gap: 1rem;
            }

            .filters {
                flex-direction: column;
            }

            .filter-group {
                width: 100%;
            }

            .filter-select, .search-input {
                min-width: 100%;
            }

            .table-container {
                overflow-x: auto;
            }

            .table {
                min-width: 800px;
            }
        }
    </style>
</head>
<body>
    <div class="bg-animation">
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
    </div>

    <div class="container">
        <div class="header">
            <div class="logo">
                <div class="logo-icon">üöö</div>
                <span>Log√≠stica Global</span>
            </div>
            <div class="user-info">
                {% if user.is_authenticated %}
                <div>
                    <div style="font-weight: 600;">{{ user.get_full_name|default:user.username }}</div>
                    <div style="font-size: 0.85rem; color: var(--text-secondary);">
                        {% if user.perfilusuario.tipo_usuario %}{{ user.perfilusuario.tipo_usuario }}{% else %}Usuario{% endif %}
                    </div>
                </div>
                <div class="avatar" onclick="window.location.href='{% url 'logout' %}'" title="Cerrar sesi√≥n">
                    {{ user.username|slice:":2"|upper }}
                </div>
                {% else %}
                <a href="{% url 'login' %}" class="btn">Iniciar Sesi√≥n</a>
                {% endif %}
            </div>
        </div>

        <div class="nav-menu">
            <div class="nav-item" onclick="window.location.href='{% url 'dashboard' %}'">üìä Dashboard</div>
            <div class="nav-item active" onclick="window.location.href='{% url 'despachos' %}'">üì¶ Despachos</div>
            <div class="nav-item" onclick="window.location.href='{% url 'rutas' %}'">üó∫Ô∏è Rutas</div>
            <div class="nav-item" onclick="window.location.href='{% url 'vehiculos' %}'">üöõ Veh√≠culos</div>
            <div class="nav-item" onclick="window.location.href='{% url 'aeronaves' %}'">‚úàÔ∏è Aeronaves</div>
            <div class="nav-item" onclick="window.location.href='{% url 'conductores' %}'">üë®‚Äçüíº Conductores</div>
            <div class="nav-item" onclick="window.location.href='{% url 'pilotos' %}'">üë®‚Äç‚úàÔ∏è Pilotos</div>
            <div class="nav-item" onclick="window.location.href='{% url 'clientes' %}'">üë• Clientes</div>
            <div class="nav-item" onclick="window.location.href='{% url 'cargas' %}'">üì¶ Cargas</div>
            <div class="nav-item" onclick="window.location.href='{% url 'seguros' %}'">üõ°Ô∏è Seguros</div>
            <div class="nav-item" onclick="window.location.href='{% url 'reportes' %}'">üìà Reportes</div>
            <div class="nav-item" onclick="window.location.href='{% url 'api' %}'">üîó API</div>
        </div>

        <!-- BLOQUE DE PERMISOS PARA CLIENTES -->
        {% if user.is_authenticated and user.perfilusuario.tipo_usuario == 'CLIENTE' %}
        <style>
            #new-despacho-btn,
            .btn[onclick*="crear"],
            .btn[onclick*="editar"],
            .btn[onclick*="eliminar"],
            .action-btn.delete,
            .btn-danger {
                display: none !important;
            }
            
            .table-container {
                display: none !important;
            }
        </style>
        
        <div class="content-card" style="text-align: center; padding: 4rem 2rem;">
            <div style="font-size: 4rem; margin-bottom: 1rem;">üîí</div>
            <h2 style="margin-bottom: 1rem; color: var(--warning);">Acceso Restringido</h2>
            <p style="color: var(--text-secondary); margin-bottom: 2rem; font-size: 1.1rem;">
                Como cliente, no tienes permisos para visualizar la informaci√≥n de despachos.
                <br>Puedes acceder a la informaci√≥n de veh√≠culos, rutas y aeronaves disponibles.
            </p>
            <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
                <button class="btn" onclick="window.location.href='{% url 'vehiculos' %}'">üöõ Ver Veh√≠culos</button>
                <button class="btn" onclick="window.location.href='{% url 'rutas' %}'">üó∫Ô∏è Ver Rutas</button>
                <button class="btn" onclick="window.location.href='{% url 'aeronaves' %}'">‚úàÔ∏è Ver Aeronaves</button>
            </div>
        </div>
        {% else %}
        <!-- CONTENIDO PARA ADMIN, CONDUCTORES Y PILOTOS -->

        <!-- Mensajes del sistema -->
        {% if messages %}
            {% for message in messages %}
            <div class="alert alert-{{ message.tags }}">
                {{ message }}
            </div>
            {% endfor %}
        {% endif %}

        <div class="page-title">
            <span>üì¶</span>
            <span>
                {% if user.perfilusuario.tipo_usuario == 'CONDUCTOR' %}
                Mis Despachos Asignados
                {% elif user.perfilusuario.tipo_usuario == 'PILOTO' %}
                Mis Vuelos Asignados
                {% else %}
                Gesti√≥n de Despachos
                {% endif %}
            </span>
        </div>

        <div class="filters">
            <div class="filter-group">
                <select class="filter-select" id="filter-status">
                    <option value="">Todos los estados</option>
                    <option value="PENDIENTE">Pendiente</option>
                    <option value="EN_RUTA">En Ruta</option>
                    <option value="ENTREGADO">Entregado</option>
                    <option value="CANCELADO">Cancelado</option>
                </select>
                <select class="filter-select" id="filter-type">
                    <option value="">Todos los tipos</option>
                    <option value="terrestre">Terrestre</option>
                    <option value="aereo">A√©reo</option>
                </select>
            </div>
            <input type="text" class="search-input" id="search-input" placeholder="Buscar despacho...">
            
            <!-- Solo mostrar bot√≥n de nuevo despacho para ADMIN -->
            {% if user.perfilusuario.tipo_usuario == 'ADMIN' %}
            <button class="btn" id="new-despacho-btn" onclick="window.location.href='{% url 'despacho_crear' %}'">‚ûï Nuevo Despacho</button>
            {% endif %}
        </div>

        <div class="table-container">
            <div class="table-header">
                <div class="table-title">
                    {% if user.perfilusuario.tipo_usuario == 'CONDUCTOR' %}
                    Despachos Terrestres Asignados
                    {% elif user.perfilusuario.tipo_usuario == 'PILOTO' %}
                    Vuelos Asignados
                    {% else %}
                    Lista de Despachos
                    {% endif %}
                </div>
                <div style="color: var(--text-secondary); font-size: 0.9rem;">
                    Total: {{ total_despachos }} despachos
                </div>
            </div>
            <table class="table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Cliente</th>
                        <th>Ruta</th>
                        <th>Tipo</th>
                        <th>Estado</th>
                        <th>Costo</th>
                        <th>Fecha</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    {% for despacho in despachos %}
                    <tr>
                        <td>DESP-{{ despacho.id }}</td>
                        <td>{{ despacho.cliente.razon_social|truncatechars:20 }}</td>
                        <td>{{ despacho.ruta.origen }} - {{ despacho.ruta.destino }}</td>
                        <td>
                            <span class="badge {% if despacho.ruta.tipo_transporte == 'TERRESTRE' %}terrestre{% else %}aereo{% endif %}">
                                {{ despacho.ruta.tipo_transporte }}
                            </span>
                        </td>
                        <td>
                            <span class="badge 
                                {% if despacho.estado == 'ENTREGADO' %}entregado
                                {% elif despacho.estado == 'EN_RUTA' %}transito
                                {% elif despacho.estado == 'PENDIENTE' %}pendiente
                                {% else %}cancelado{% endif %}">
                                {{ despacho.estado }}
                            </span>
                        </td>
                        <td>${{ despacho.costo_envio }}</td>
                        <td>{{ despacho.fecha_despacho|date:"d/m/Y" }}</td>
                        <td>
                            <button class="action-btn" onclick="window.location.href='{% url 'despacho_detail' despacho.pk %}'">Ver</button>
                            {% if user.perfilusuario.tipo_usuario == 'ADMIN' %}
                            <button class="action-btn" onclick="window.location.href='{% url 'despacho_editar' despacho.pk %}'">Editar</button>
                            <button class="action-btn delete" onclick="confirmDelete({{ despacho.pk }})">Eliminar</button>
                            {% endif %}
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="8" class="loading">
                            {% if user.perfilusuario.tipo_usuario == 'CONDUCTOR' %}
                            No tienes despachos asignados
                            {% elif user.perfilusuario.tipo_usuario == 'PILOTO' %}
                            No tienes vuelos asignados
                            {% else %}
                            No hay despachos registrados
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% endif %}
    </div>

    <script>
        function confirmDelete(despachoId) {
            if (confirm('¬øEst√° seguro de que desea eliminar este despacho?')) {
                window.location.href = `/despachos/${despachoId}/eliminar/`;
            }
        }

        function filterDespachos() {
            const statusFilter = document.getElementById('filter-status').value;
            const typeFilter = document.getElementById('filter-type').value;
            const searchText = document.getElementById('search-input').value.toLowerCase();
            
            const rows = document.querySelectorAll('.table tbody tr');
            let visibleCount = 0;
            
            rows.forEach(row => {
                if (row.querySelector('.loading')) return;
                
                const status = row.querySelector('td:nth-child(5) .badge').textContent.trim();
                const type = row.querySelector('td:nth-child(4) .badge').textContent.trim().toLowerCase();
                const rowText = row.textContent.toLowerCase();
                
                const matchesStatus = !statusFilter || status === statusFilter;
                const matchesType = !typeFilter || 
                    (typeFilter === 'terrestre' && type === 'terrestre') ||
                    (typeFilter === 'aereo' && type === 'a√©reo');
                const matchesSearch = !searchText || rowText.includes(searchText);
                
                if (matchesStatus && matchesType && matchesSearch) {
                    row.style.display = '';
                    visibleCount++;
                } else {
                    row.style.display = 'none';
                }
            });
            
            document.querySelector('.table-header div:last-child').textContent = `Total: ${visibleCount} despachos`;
        }

        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('filter-status').addEventListener('change', filterDespachos);
            document.getElementById('filter-type').addEventListener('change', filterDespachos);
            document.getElementById('search-input').addEventListener('input', filterDespachos);
        });

        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            
            let backgroundColor = 'linear-gradient(135deg, #6366f1, #06b6d4)';
            let icon = '‚úì';
            
            if (type === 'error') {
                backgroundColor = 'linear-gradient(135deg, #ef4444, #dc2626)';
                icon = '‚ùå';
            }
            
            notification.innerHTML = `<span style="margin-right: 8px;">${icon}</span>${message}`;
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${backgroundColor};
                color: white;
                padding: 1rem 2rem;
                border-radius: 12px;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
                z-index: 1000;
                animation: slideInRight 0.4s ease-out;
                font-weight: 600;
                display: flex;
                align-items: center;
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOutRight 0.4s ease-out';
                setTimeout(() => notification.remove(), 400);
            }, 4000);
        }

        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideInRight {
                from {
                    transform: translateX(400px);
                    opacity: 0;
                }
                to {
                    transform: translateX(0);
                    opacity: 1;
                }
            }
            @keyframes slideOutRight {
                from {
                    transform: translateX(0);
                    opacity: 1;
                }
                to {
                    transform: translateX(400px);
                    opacity: 0;
                }
            }
            
            .content-card {
                background: linear-gradient(135deg, rgba(30, 41, 59, 0.8), rgba(30, 41, 59, 0.4));
                backdrop-filter: blur(10px);
                border-radius: 20px;
                border: 1px solid var(--border);
                padding: 2rem;
                margin-bottom: 2rem;
            }
            
            .alert {
                padding: 1rem;
                border-radius: 12px;
                margin-bottom: 1.5rem;
                border-left: 4px solid;
            }
            
            .alert-success {
                background: rgba(16, 185, 129, 0.2);
                border-color: var(--success);
                color: var(--success);
            }
            
            .alert-error {
                background: rgba(239, 68, 68, 0.2);
                border-color: var(--danger);
                color: var(--danger);
            }
            
            .alert-warning {
                background: rgba(245, 158, 11, 0.2);
                border-color: var(--warning);
                color: var(--warning);
            }
        `;
        document.head.appendChild(style);

        console.log('üì¶ M√≥dulo de Despachos cargado exitosamente');
    </script>
</body>
</html>
============================================================


===== despacho_confirm_delete.html =====
{% extends 'base.html' %}

{% block title %}Eliminar Despacho - Log√≠stica Global{% endblock %}

{% block content %}
<div class="page-title">
    <span>üóëÔ∏è</span>
    <span>Eliminar Despacho</span>
</div>

<div class="content-card">
    <div style="text-align: center; margin-bottom: 2rem;">
        <div style="font-size: 4rem; margin-bottom: 1rem;">‚ö†Ô∏è</div>
        <h2 style="margin-bottom: 1rem;">¬øEst√°s seguro de que deseas eliminar este despacho?</h2>
        <p style="color: var(--text-secondary); margin-bottom: 2rem;">
            Despacho: D-{{ despacho.id|stringformat:"04d" }}<br>
            Cliente: {{ despacho.cliente.razon_social }}<br>
            Ruta: {{ despacho.ruta.origen }} - {{ despacho.ruta.destino }}<br>
            Esta acci√≥n no se puede deshacer.
        </p>
    </div>

    <form method="post" style="text-align: center;">
        {% csrf_token %}
        <div class="action-buttons" style="justify-content: center;">
            <button type="submit" class="btn btn-danger">S√≠, eliminar</button>
            <a href="{% url 'despacho_detail' despacho.pk %}" class="btn btn-secondary">Cancelar</a>
        </div>
    </form>
</div>
{% endblock %}
============================================================


===== despacho_detail.html =====
{% extends 'base.html' %}

{% block title %}Despacho {{ despacho.id }} - Log√≠stica Global{% endblock %}

{% block content %}
<div class="page-title">
    <span>üì¶</span>
    <span>Despacho D-{{ despacho.id|stringformat:"04d" }}</span>
</div>

<div class="content-card">
    <div class="detail-grid">
        <div class="detail-item">
            <div class="detail-label">ID Despacho</div>
            <div class="detail-value">D-{{ despacho.id|stringformat:"04d" }}</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Cliente</div>
            <div class="detail-value">{{ despacho.cliente.razon_social }}</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Ruta</div>
            <div class="detail-value">{{ despacho.ruta.origen }} - {{ despacho.ruta.destino }}</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Tipo de Transporte</div>
            <div class="detail-value">{{ despacho.ruta.get_tipo_transporte_display }}</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Carga</div>
            <div class="detail-value">{{ despacho.carga.descripcion }}</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Estado</div>
            <div class="detail-value">
                <span class="badge {% if despacho.estado == 'ENTREGADO' %}active
                                 {% elif despacho.estado == 'PENDIENTE' %}pending
                                 {% elif despacho.estado == 'EN_RUTA' %}info
                                 {% else %}alert{% endif %}">
                    {{ despacho.get_estado_display }}
                </span>
            </div>
        </div>

        {% if despacho.vehiculo %}
        <div class="detail-item">
            <div class="detail-label">Veh√≠culo</div>
            <div class="detail-value">{{ despacho.vehiculo.patente }} - {{ despacho.vehiculo.modelo }}</div>
        </div>
        {% endif %}

        {% if despacho.aeronave %}
        <div class="detail-item">
            <div class="detail-label">Aeronave</div>
            <div class="detail-value">{{ despacho.aeronave.matricula }} - {{ despacho.aeronave.modelo }}</div>
        </div>
        {% endif %}

        {% if despacho.conductor %}
        <div class="detail-item">
            <div class="detail-label">Conductor</div>
            <div class="detail-value">{{ despacho.conductor.nombre }}</div>
        </div>
        {% endif %}

        {% if despacho.piloto %}
        <div class="detail-item">
            <div class="detail-label">Piloto</div>
            <div class="detail-value">{{ despacho.piloto.nombre }}</div>
        </div>
        {% endif %}

        <div class="detail-item">
            <div class="detail-label">Costo de Env√≠o</div>
            <div class="detail-value">${{ despacho.costo_envio }}</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Fecha de Despacho</div>
            <div class="detail-value">{{ despacho.fecha_despacho|date:"d/m/Y H:i" }}</div>
        </div>
    </div>

    <div class="action-buttons">
        <a href="{% url 'despacho_editar' despacho.pk %}" class="btn">Editar</a>
        <a href="{% url 'despacho_eliminar' despacho.pk %}" class="btn btn-danger">Eliminar</a>
        <a href="{% url 'despachos' %}" class="btn btn-secondary">Volver a la lista</a>
    </div>
</div>
{% endblock %}
============================================================


===== despacho_form.html =====
{% extends 'base.html' %}

{% block title %}{% if despacho %}Editar{% else %}Nuevo{% endif %} Despacho - Log√≠stica Global{% endblock %}

{% block content %}
<div class="page-title">
    <span>üì¶</span>
    <span>{% if despacho %}Editar Despacho{% else %}Nuevo Despacho{% endif %}</span>
</div>

<div class="content-card">
    <form method="post">
        {% csrf_token %}
        
        <!-- Informaci√≥n del Cliente y Carga -->
        <h3 style="margin-bottom: 1.5rem; color: var(--primary); display: flex; align-items: center; gap: 0.5rem;">
            <span>üë•</span>
            <span>Informaci√≥n del Cliente y Carga</span>
        </h3>
        
        <div class="form-group">
            <label class="form-label">Cliente *</label>
            <select class="form-select" name="cliente" required>
                <option value="">Seleccionar cliente</option>
                {% for cliente in clientes %}
                <option value="{{ cliente.id }}" {% if despacho.cliente.id == cliente.id %}selected{% endif %}>
                    {{ cliente.razon_social|default:cliente.nombre }}
                </option>
                {% endfor %}
            </select>
        </div>

        <div class="form-group">
            <label class="form-label">Carga *</label>
            <select class="form-select" name="carga" required>
                <option value="">Seleccionar carga</option>
                {% for carga in cargas %}
                <option value="{{ carga.id }}" {% if despacho.carga.id == carga.id %}selected{% endif %}>
                    {{ carga.descripcion }} - {{ carga.peso_kg }}kg
                </option>
                {% endfor %}
            </select>
        </div>

        <!-- Ruta y Estado -->
        <h3 style="margin-bottom: 1.5rem; color: var(--primary); display: flex; align-items: center; gap: 0.5rem; margin-top: 2rem;">
            <span>üó∫Ô∏è</span>
            <span>Ruta y Transporte</span>
        </h3>
        
        <div class="form-group">
            <label class="form-label">Ruta *</label>
            <select class="form-select" name="ruta" required>
                <option value="">Seleccionar ruta</option>
                {% for ruta in rutas %}
                <option value="{{ ruta.id }}" {% if despacho.ruta.id == ruta.id %}selected{% endif %}>
                    {{ ruta.origen }} - {{ ruta.destino }} ({{ ruta.tipo_transporte }})
                </option>
                {% endfor %}
            </select>
        </div>

        <div class="form-group">
            <label class="form-label">Estado *</label>
            <select class="form-select" name="estado" required>
                <option value="PENDIENTE" {% if despacho.estado == 'PENDIENTE' %}selected{% endif %}>Pendiente</option>
                <option value="EN_RUTA" {% if despacho.estado == 'EN_RUTA' %}selected{% endif %}>En Ruta</option>
                <option value="ENTREGADO" {% if despacho.estado == 'ENTREGADO' %}selected{% endif %}>Entregado</option>
                <option value="CANCELADO" {% if despacho.estado == 'CANCELADO' %}selected{% endif %}>Cancelado</option>
            </select>
        </div>

        <!-- Informaci√≥n de Costos -->
        <h3 style="margin-bottom: 1.5rem; color: var(--primary); display: flex; align-items: center; gap: 0.5rem; margin-top: 2rem;">
            <span>üí∞</span>
            <span>Informaci√≥n de Costos</span>
        </h3>
        
        <div class="form-group">
            <label class="form-label">Costo de Env√≠o ($) *</label>
            <input type="number" class="form-input" name="costo_envio" 
                   value="{{ despacho.costo_envio|default:'' }}" step="0.01" min="0" 
                   placeholder="0.00" required>
        </div>

        <!-- Asignaci√≥n de Recursos -->
        <h3 style="margin-bottom: 1.5rem; color: var(--primary); display: flex; align-items: center; gap: 0.5rem; margin-top: 2rem;">
            <span>üöö</span>
            <span>Asignaci√≥n de Recursos (Opcional)</span>
        </h3>
        
        <div class="form-group">
            <label class="form-label">Veh√≠culo</label>
            <select class="form-select" name="vehiculo">
                <option value="">Sin asignar</option>
                {% for vehiculo in vehiculos %}
                <option value="{{ vehiculo.id }}" {% if despacho.vehiculo.id == vehiculo.id %}selected{% endif %}>
                    {{ vehiculo.patente }} - {{ vehiculo.modelo }}
                </option>
                {% endfor %}
            </select>
        </div>

        <div class="form-group">
            <label class="form-label">Aeronave</label>
            <select class="form-select" name="aeronave">
                <option value="">Sin asignar</option>
                {% for aeronave in aeronaves %}
                <option value="{{ aeronave.id }}" {% if despacho.aeronave.id == aeronave.id %}selected{% endif %}>
                    {{ aeronave.matricula }} - {{ aeronave.modelo }}
                </option>
                {% endfor %}
            </select>
        </div>

        <div class="form-group">
            <label class="form-label">Conductor</label>
            <select class="form-select" name="conductor">
                <option value="">Sin asignar</option>
                {% for conductor in conductores %}
                <option value="{{ conductor.id }}" {% if despacho.conductor.id == conductor.id %}selected{% endif %}>
                    {{ conductor.nombre }} ({{ conductor.licencia }})
                </option>
                {% endfor %}
            </select>
        </div>

        <div class="form-group">
            <label class="form-label">Piloto</label>
            <select class="form-select" name="piloto">
                <option value="">Sin asignar</option>
                {% for piloto in pilotos %}
                <option value="{{ piloto.id }}" {% if despacho.piloto.id == piloto.id %}selected{% endif %}>
                    {{ piloto.nombre }} ({{ piloto.certificacion }})
                </option>
                {% endfor %}
            </select>
        </div>

        <!-- Botones de acci√≥n -->
        <div class="action-buttons">
            <button type="submit" class="btn btn-success">
                {% if despacho %}Actualizar{% else %}Crear{% endif %} Despacho
            </button>
            <a href="{% url 'despachos' %}" class="btn btn-secondary">Cancelar</a>
        </div>
    </form>
</div>

<style>
.form-group {
    margin-bottom: 1.5rem;
}

.form-label {
    display: block;
    margin-bottom: 0.5rem;
    font-weight: 600;
    color: var(--text-primary);
}

.form-input, .form-select {
    width: 100%;
    padding: 0.8rem 1rem;
    background: rgba(30, 41, 59, 0.6);
    border: 1px solid var(--border);
    border-radius: 12px;
    color: var(--text-primary);
    font-size: 0.95rem;
}

.form-input:focus, .form-select:focus {
    outline: none;
    border-color: var(--primary);
}

.action-buttons {
    display: flex;
    gap: 1rem;
    margin-top: 2rem;
    padding-top: 1.5rem;
    border-top: 1px solid var(--border);
}
</style>
{% endblock %}
============================================================


===== editar_usuario.html =====
{% extends 'base.html' %}

{% block title %}Editar Usuario - Log√≠stica Global{% endblock %}

{% block content %}
<div class="page-title">
    <span>üë§</span>
    <span>Editar Usuario: {{ usuario_editar.username }}</span>
</div>

<div class="content-card">
    <form method="post">
        {% csrf_token %}
        
        <!-- Informaci√≥n B√°sica -->
        <div style="margin-bottom: 2.5rem;">
            <h3 style="margin-bottom: 1.5rem; color: var(--primary); display: flex; align-items: center; gap: 0.5rem;">
                <span>üìù</span>
                <span>Informaci√≥n B√°sica</span>
            </h3>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">
                <div class="form-group">
                    <label class="form-label">Nombre de Usuario</label>
                    <input type="text" class="form-input" value="{{ usuario_editar.username }}" readonly>
                    <small style="color: var(--text-secondary);">No se puede modificar</small>
                </div>
                <div class="form-group">
                    <label class="form-label">Tipo de Usuario *</label>
                    <select class="form-select" name="tipo_usuario" required>
                        {% for value, label in tipos_usuario %}
                        <option value="{{ value }}" {% if perfil.tipo_usuario == value %}selected{% endif %}>
                            {{ label }}
                        </option>
                        {% endfor %}
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Nombre</label>
                    <input type="text" class="form-input" name="first_name" value="{{ usuario_editar.first_name }}">
                </div>
                <div class="form-group">
                    <label class="form-label">Apellido</label>
                    <input type="text" class="form-input" name="last_name" value="{{ usuario_editar.last_name }}">
                </div>
                <div class="form-group">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-input" name="email" value="{{ usuario_editar.email }}">
                </div>
                <div class="form-group">
                    <label class="form-label">Tel√©fono</label>
                    <input type="text" class="form-input" name="telefono" value="{{ perfil.telefono }}">
                </div>
            </div>
        </div>

        <!-- Asignaciones Espec√≠ficas -->
        <div style="margin-bottom: 2.5rem;">
            <h3 style="margin-bottom: 1.5rem; color: var(--primary); display: flex; align-items: center; gap: 0.5rem;">
                <span>üîó</span>
                <span>Asignaciones Espec√≠ficas</span>
            </h3>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">
                <div class="form-group">
                    <label class="form-label">Conductor Asignado</label>
                    <select class="form-select" name="conductor_asignado">
                        <option value="">Sin asignar</option>
                        {% for conductor in conductores %}
                        <option value="{{ conductor.id }}" 
                            {% if perfil.conductor_asignado and perfil.conductor_asignado.id == conductor.id %}selected{% endif %}>
                            {{ conductor.nombre }} ({{ conductor.licencia }})
                        </option>
                        {% endfor %}
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Piloto Asignado</label>
                    <select class="form-select" name="piloto_asignado">
                        <option value="">Sin asignar</option>
                        {% for piloto in pilotos %}
                        <option value="{{ piloto.id }}" 
                            {% if perfil.piloto_asignado and perfil.piloto_asignado.id == piloto.id %}selected{% endif %}>
                            {{ piloto.nombre }} ({{ piloto.certificacion }})
                        </option>
                        {% endfor %}
                    </select>
                </div>
            </div>
        </div>

        <!-- Estado -->
        <div style="margin-bottom: 2.5rem;">
            <h3 style="margin-bottom: 1.5rem; color: var(--primary); display: flex; align-items: center; gap: 0.5rem;">
                <span>üîÑ</span>
                <span>Estado</span>
            </h3>
            <div class="form-group">
                <label class="form-label" style="display: flex; align-items: center; gap: 0.5rem;">
                    <input type="checkbox" name="is_active" {% if usuario_editar.is_active %}checked{% endif %}>
                    <span>Usuario Activo</span>
                </label>
            </div>
        </div>

        <!-- Botones de acci√≥n -->
        <div class="action-buttons">
            <button type="submit" class="btn btn-success">Actualizar Usuario</button>
            <a href="{% url 'gestion_usuarios' %}" class="btn btn-secondary">Cancelar</a>
        </div>
    </form>
</div>

<style>
.form-group {
    margin-bottom: 1.5rem;
}

.form-label {
    display: block;
    margin-bottom: 0.5rem;
    font-weight: 600;
    color: var(--text-primary);
}

.form-input, .form-select {
    width: 100%;
    padding: 0.8rem 1rem;
    background: rgba(30, 41, 59, 0.6);
    border: 1px solid var(--border);
    border-radius: 12px;
    color: var(--text-primary);
    font-size: 0.95rem;
}

.form-input:focus, .form-select:focus {
    outline: none;
    border-color: var(--primary);
}

.action-buttons {
    display: flex;
    gap: 1rem;
    margin-top: 2rem;
    padding-top: 1.5rem;
    border-top: 1px solid var(--border);
}

@media (max-width: 768px) {
    .content-card > div > div {
        grid-template-columns: 1fr !important;
    }
}
</style>
{% endblock %}
============================================================


===== gestion_usuarios.html =====
{% extends 'base.html' %}

{% block title %}Gesti√≥n de Usuarios - Log√≠stica Global{% endblock %}

{% block content %}
<div class="page-title">
    <span>üë•</span>
    <span>Gesti√≥n de Usuarios</span>
</div>

<div class="filters">
    <input type="text" class="search-input" id="search-input" placeholder="Buscar usuarios..." value="{{ search_query }}">
    <button class="btn" onclick="filterUsers()">üîç Buscar</button>
</div>

<div class="table-container">
    <div class="table-header">
        <div class="table-title">Lista de Usuarios</div>
        <div style="color: var(--text-secondary); font-size: 0.9rem;">
            Total: {{ usuarios_con_perfiles|length }} usuarios
        </div>
    </div>
    <table class="table">
        <thead>
            <tr>
                <th>Usuario</th>
                <th>Nombre Completo</th>
                <th>Email</th>
                <th>Tipo Usuario</th>
                <th>Asignaciones</th>
                <th>Estado</th>
                <th>Fecha Registro</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody>
            {% for item in usuarios_con_perfiles %}
            <tr>
                <td>
                    <strong>{{ item.usuario.username }}</strong>
                    {% if item.usuario.is_superuser %}
                    <span class="badge warning" title="Superusuario">üëë</span>
                    {% endif %}
                </td>
                <td>{{ item.usuario.get_full_name|default:"-" }}</td>
                <td>{{ item.usuario.email }}</td>
                <td>
                    <span class="badge 
                        {% if item.perfil.tipo_usuario == 'ADMIN' %}info
                        {% elif item.perfil.tipo_usuario == 'CLIENTE' %}active
                        {% elif item.perfil.tipo_usuario == 'CONDUCTOR' %}warning
                        {% elif item.perfil.tipo_usuario == 'PILOTO' %}info{% endif %}">
                        {{ item.perfil.get_tipo_usuario_display }}
                    </span>
                </td>
                <td>
                    {% if item.perfil.conductor_asignado %}
                    üöõ {{ item.perfil.conductor_asignado.nombre }}
                    {% endif %}
                    {% if item.perfil.piloto_asignado %}
                    ‚úàÔ∏è {{ item.perfil.piloto_asignado.nombre }}
                    {% endif %}
                    {% if not item.perfil.conductor_asignado and not item.perfil.piloto_asignado %}
                    -
                    {% endif %}
                </td>
                <td>
                    <span class="badge {% if item.usuario.is_active %}active{% else %}alert{% endif %}">
                        {{ item.usuario.is_active|yesno:"Activo,Inactivo" }}
                    </span>
                </td>
                <td>{{ item.usuario.date_joined|date:"d/m/Y" }}</td>
                <td>
                    <button class="action-btn" onclick="window.location.href='{% url 'editar_usuario' item.usuario.id %}'">
                        Editar
                    </button>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="8" class="loading">No se encontraron usuarios</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<script>
function filterUsers() {
    const searchValue = document.getElementById('search-input').value;
    window.location.href = `?search=${encodeURIComponent(searchValue)}`;
}

document.getElementById('search-input').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        filterUsers();
    }
});
</script>
{% endblock %}
============================================================


===== login.html =====
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Iniciar Sesi√≥n - Log√≠stica Global</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #06b6d4;
            --accent: #f59e0b;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --info: #3b82f6;
            --bg-dark: #0f172a;
            --bg-card: #1e293b;
            --bg-hover: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --border: #334155;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--bg-dark) 0%, #1e293b 100%);
            color: var(--text-primary);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .bg-animation {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 0;
            overflow: hidden;
        }

        .bg-animation span {
            position: absolute;
            display: block;
            width: 20px;
            height: 20px;
            background: rgba(99, 102, 241, 0.1);
            animation: float 25s infinite;
            border-radius: 50%;
        }

        .bg-animation span:nth-child(1) { left: 25%; animation-delay: 0s; }
        .bg-animation span:nth-child(2) { left: 10%; animation-delay: 2s; animation-duration: 30s; }
        .bg-animation span:nth-child(3) { left: 70%; animation-delay: 4s; }
        .bg-animation span:nth-child(4) { left: 40%; animation-delay: 0s; animation-duration: 18s; }
        .bg-animation span:nth-child(5) { left: 65%; animation-delay: 0s; }
        .bg-animation span:nth-child(6) { left: 75%; animation-delay: 3s; }
        .bg-animation span:nth-child(7) { left: 35%; animation-delay: 7s; }
        .bg-animation span:nth-child(8) { left: 50%; animation-delay: 15s; animation-duration: 45s; }
        .bg-animation span:nth-child(9) { left: 20%; animation-delay: 2s; animation-duration: 35s; }
        .bg-animation span:nth-child(10) { left: 85%; animation-delay: 0s; animation-duration: 11s; }

        @keyframes float {
            0% {
                transform: translateY(100vh) scale(0);
                opacity: 0;
            }
            50% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100vh) scale(1);
                opacity: 0;
            }
        }

        .login-container {
            position: relative;
            z-index: 1;
            width: 100%;
            max-width: 400px;
            padding: 2rem;
        }

        .login-card {
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.9), rgba(30, 41, 59, 0.7));
            backdrop-filter: blur(10px);
            padding: 3rem;
            border-radius: 20px;
            border: 1px solid var(--border);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            animation: slideUp 0.6s ease-out;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 2rem;
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .logo-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
        }

        .login-title {
            text-align: center;
            margin-bottom: 2rem;
            font-size: 1.8rem;
            font-weight: 700;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .form-input {
            width: 100%;
            padding: 0.8rem 1rem;
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 0.95rem;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary);
        }

        .btn {
            width: 100%;
            padding: 0.8rem 1.5rem;
            background: var(--primary);
            border: none;
            border-radius: 12px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 1rem;
        }

        .btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(99, 102, 241, 0.4);
        }

        .btn-secondary {
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background: var(--bg-hover);
        }

        .form-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 1.5rem;
        }

        .alert {
            padding: 1rem;
            border-radius: 12px;
            margin-bottom: 1.5rem;
            border-left: 4px solid;
        }

        .alert-success {
            background: rgba(16, 185, 129, 0.2);
            border-color: var(--success);
            color: var(--success);
        }

        .alert-error {
            background: rgba(239, 68, 68, 0.2);
            border-color: var(--danger);
            color: var(--danger);
        }

        .alert-warning {
            background: rgba(245, 158, 11, 0.2);
            border-color: var(--warning);
            color: var(--warning);
        }

        .tabs {
            display: flex;
            margin-bottom: 2rem;
            border-bottom: 1px solid var(--border);
        }

        .tab {
            flex: 1;
            padding: 1rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 2px solid transparent;
        }

        .tab.active {
            border-bottom-color: var(--primary);
            color: var(--primary);
            font-weight: 600;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        @media (max-width: 768px) {
            .login-container {
                padding: 1rem;
            }

            .login-card {
                padding: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="bg-animation">
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
    </div>

    <div class="login-container">
        <div class="login-card">
            <div class="logo">
                <div class="logo-icon">üöö</div>
                <span>Log√≠stica Global</span>
            </div>

            <div class="tabs">
                <div class="tab active" onclick="showTab('login')">Iniciar Sesi√≥n</div>
                <div class="tab" onclick="showTab('register')">Registrarse</div>
            </div>

            <!-- Mensajes del sistema -->
            {% if messages %}
                {% for message in messages %}
                <div class="alert alert-{{ message.tags }}">
                    {{ message }}
                </div>
                {% endfor %}
            {% endif %}

            <!-- Formulario de Login -->
            <div id="login-tab" class="tab-content active">
                <div class="login-title">Iniciar Sesi√≥n</div>
                <form method="post" action="{% url 'login' %}">
                    {% csrf_token %}
                    <input type="hidden" name="form_type" value="login">
                    
                    <div class="form-group">
                        <label class="form-label">Usuario</label>
                        <input type="text" class="form-input" name="username" required placeholder="Ingresa tu usuario">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Contrase√±a</label>
                        <input type="password" class="form-input" name="password" required placeholder="Ingresa tu contrase√±a">
                    </div>
                    
                    <button type="submit" class="btn">Iniciar Sesi√≥n</button>
                </form>
            </div>

            <!-- Formulario de Registro -->
            <div id="register-tab" class="tab-content">
                <div class="login-title">Crear Cuenta</div>
                <form method="post" action="{% url 'register' %}">
                    {% csrf_token %}
                    <input type="hidden" name="form_type" value="register">
                    
                    <div class="form-group">
                        <label class="form-label">Nombre</label>
                        <input type="text" class="form-input" name="first_name" required placeholder="Tu nombre">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Apellido</label>
                        <input type="text" class="form-input" name="last_name" required placeholder="Tu apellido">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Usuario</label>
                        <input type="text" class="form-input" name="username" required placeholder="Elige un usuario">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Email</label>
                        <input type="email" class="form-input" name="email" required placeholder="tu@email.com">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Contrase√±a</label>
                        <input type="password" class="form-input" name="password1" required placeholder="Crea una contrase√±a">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Confirmar Contrase√±a</label>
                        <input type="password" class="form-input" name="password2" required placeholder="Repite tu contrase√±a">
                    </div>
                    
                    <button type="submit" class="btn">Crear Cuenta</button>
                </form>
            </div>

            <div class="form-actions">
                <a href="#" style="color: var(--text-secondary); text-decoration: none; font-size: 0.9rem;">
                    ¬øOlvidaste tu contrase√±a?
                </a>
            </div>
        </div>
    </div>

    <script>
        function showTab(tabName) {
            // Ocultar todos los tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Mostrar tab seleccionado
            document.querySelector(`.tab[onclick="showTab('${tabName}')"]`).classList.add('active');
            document.getElementById(`${tabName}-tab`).classList.add('active');
        }

        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            
            let backgroundColor = 'linear-gradient(135deg, #6366f1, #06b6d4)';
            let icon = '‚úì';
            
            if (type === 'error') {
                backgroundColor = 'linear-gradient(135deg, #ef4444, #dc2626)';
                icon = '‚ùå';
            }
            
            notification.innerHTML = `<span style="margin-right: 8px;">${icon}</span>${message}`;
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${backgroundColor};
                color: white;
                padding: 1rem 2rem;
                border-radius: 12px;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
                z-index: 1000;
                animation: slideInRight 0.4s ease-out;
                font-weight: 600;
                display: flex;
                align-items: center;
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOutRight 0.4s ease-out';
                setTimeout(() => notification.remove(), 400);
            }, 4000);
        }

        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideInRight {
                from {
                    transform: translateX(400px);
                    opacity: 0;
                }
                to {
                    transform: translateX(0);
                    opacity: 1;
                }
            }
            @keyframes slideOutRight {
                from {
                    transform: translateX(0);
                    opacity: 1;
                }
                to {
                    transform: translateX(400px);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(style);

        // Mostrar mensajes de error espec√≠ficos
        document.addEventListener('DOMContentLoaded', function() {
            const urlParams = new URLSearchParams(window.location.search);
            const error = urlParams.get('error');
            
            if (error) {
                showNotification(error, 'error');
            }
            
            console.log('üîê Sistema de autenticaci√≥n cargado');
        });
    </script>
</body>
</html>
============================================================


===== pilotos.html =====
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pilotos - Sistema de Gesti√≥n de Transporte</title>
    <style>
        /* MANTENER TODOS LOS ESTILOS ORIGINALES EXACTAMENTE IGUAL */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #06b6d4;
            --accent: #f59e0b;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --info: #3b82f6;
            --bg-dark: #0f172a;
            --bg-card: #1e293b;
            --bg-hover: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --border: #334155;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--bg-dark) 0%, #1e293b 100%);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .bg-animation {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 0;
            overflow: hidden;
        }

        .bg-animation span {
            position: absolute;
            display: block;
            width: 20px;
            height: 20px;
            background: rgba(99, 102, 241, 0.1);
            animation: float 25s infinite;
            border-radius: 50%;
        }

        .bg-animation span:nth-child(1) { left: 25%; animation-delay: 0s; }
        .bg-animation span:nth-child(2) { left: 10%; animation-delay: 2s; animation-duration: 30s; }
        .bg-animation span:nth-child(3) { left: 70%; animation-delay: 4s; }
        .bg-animation span:nth-child(4) { left: 40%; animation-delay: 0s; animation-duration: 18s; }
        .bg-animation span:nth-child(5) { left: 65%; animation-delay: 0s; }
        .bg-animation span:nth-child(6) { left: 75%; animation-delay: 3s; }
        .bg-animation span:nth-child(7) { left: 35%; animation-delay: 7s; }
        .bg-animation span:nth-child(8) { left: 50%; animation-delay: 15s; animation-duration: 45s; }
        .bg-animation span:nth-child(9) { left: 20%; animation-delay: 2s; animation-duration: 35s; }
        .bg-animation span:nth-child(10) { left: 85%; animation-delay: 0s; animation-duration: 11s; }

        @keyframes float {
            0% {
                transform: translateY(100vh) scale(0);
                opacity: 0;
            }
            50% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100vh) scale(1);
                opacity: 0;
            }
        }

        .container {
            position: relative;
            z-index: 1;
            max-width: 1600px;
            margin: 0 auto;
            padding: 2.5rem 3rem;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 3rem;
            background: rgba(30, 41, 59, 0.6);
            backdrop-filter: blur(10px);
            padding: 1.5rem 2.5rem;
            border-radius: 20px;
            border: 1px solid var(--border);
            animation: slideDown 0.6s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 1rem;
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .logo-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            animation: rotate3d 3s infinite ease-in-out;
        }

        @keyframes rotate3d {
            0%, 100% { transform: rotateY(0deg); }
            50% { transform: rotateY(180deg); }
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .avatar {
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, var(--accent), var(--danger));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .avatar:hover {
            transform: scale(1.1) rotate(5deg);
        }

        .nav-menu {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .nav-item {
            padding: 0.8rem 1.5rem;
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .nav-item:hover, .nav-item.active {
            background: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(99, 102, 241, 0.4);
        }

        .page-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .filters {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .filter-group {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .filter-select, .search-input {
            padding: 0.8rem 1.2rem;
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 0.95rem;
            min-width: 180px;
        }

        .search-input {
            flex: 1;
            min-width: 250px;
        }

        .btn {
            padding: 0.8rem 1.5rem;
            background: var(--primary);
            border: none;
            border-radius: 12px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(99, 102, 241, 0.4);
        }

        .btn-secondary {
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background: var(--bg-hover);
        }

        .table-container {
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.8), rgba(30, 41, 59, 0.4));
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 1px solid var(--border);
            overflow: hidden;
            margin-bottom: 2rem;
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem 2rem;
            border-bottom: 1px solid var(--border);
        }

        .table-title {
            font-size: 1.3rem;
            font-weight: 600;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
        }

        .table th {
            text-align: left;
            padding: 1.2rem 1.5rem;
            background: rgba(51, 65, 85, 0.3);
            font-weight: 600;
            color: var(--text-secondary);
            border-bottom: 1px solid var(--border);
        }

        .table td {
            padding: 1.2rem 1.5rem;
            border-bottom: 1px solid var(--border);
        }

        .table tr:last-child td {
            border-bottom: none;
        }

        .table tr:hover {
            background: rgba(51, 65, 85, 0.2);
        }

        .badge {
            padding: 0.4rem 1rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .badge.active {
            background: rgba(16, 185, 129, 0.2);
            color: var(--success);
        }

        .badge.inactive {
            background: rgba(239, 68, 68, 0.2);
            color: var(--danger);
        }

        .badge.vacation {
            background: rgba(245, 158, 11, 0.2);
            color: var(--warning);
        }

        .loading {
            text-align: center;
            padding: 2rem;
            color: var(--text-secondary);
        }

        .error {
            text-align: center;
            padding: 2rem;
            color: var(--danger);
            background: rgba(239, 68, 68, 0.1);
            border-radius: 12px;
            margin: 1rem 0;
        }

        .pagination {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem 2rem;
            border-top: 1px solid var(--border);
        }

        .pagination-info {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .pagination-controls {
            display: flex;
            gap: 0.5rem;
        }

        .pagination-btn {
            padding: 0.6rem 1rem;
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .pagination-btn:hover {
            background: var(--primary);
        }

        .pagination-btn.active {
            background: var(--primary);
        }

        .action-btn {
            padding: 0.4rem 0.8rem;
            background: rgba(99, 102, 241, 0.2);
            border: 1px solid var(--primary);
            border-radius: 8px;
            color: var(--primary);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.85rem;
            margin-right: 0.5rem;
        }

        .action-btn:hover {
            background: var(--primary);
            color: white;
        }

        .action-btn.delete {
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid var(--danger);
            color: var(--danger);
        }

        .action-btn.delete:hover {
            background: var(--danger);
            color: white;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--bg-card);
            padding: 2rem;
            border-radius: 20px;
            border: 1px solid var(--border);
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .close-modal {
            position: absolute;
            top: 1rem;
            right: 1rem;
            cursor: pointer;
            font-size: 1.5rem;
            color: var(--text-secondary);
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .form-input, .form-select {
            width: 100%;
            padding: 0.8rem 1rem;
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 0.95rem;
        }

        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: var(--primary);
        }

        .form-row {
            display: flex;
            gap: 1rem;
        }

        .form-row .form-group {
            flex: 1;
        }

        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }

            .header {
                flex-direction: column;
                gap: 1rem;
            }

            .filters {
                flex-direction: column;
            }

            .filter-group {
                width: 100%;
            }

            .filter-select, .search-input {
                min-width: 100%;
            }

            .table-container {
                overflow-x: auto;
            }

            .table {
                min-width: 800px;
            }

            .form-row {
                flex-direction: column;
                gap: 0;
            }
        }
    </style>
</head>
<body>
    <div class="bg-animation">
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
    </div>

    <div class="container">
        <div class="header">
            <div class="logo">
                <div class="logo-icon">üöö</div>
                <span>Log√≠stica Global</span>
            </div>
            <div class="user-info">
                {% if user.is_authenticated %}
                <div>
                    <div style="font-weight: 600;">{{ user.get_full_name|default:user.username }}</div>
                    <div style="font-size: 0.85rem; color: var(--text-secondary);">
                        {% if user.is_staff %}Administrador{% else %}Usuario{% endif %}
                    </div>
                </div>
                <div class="avatar" onclick="window.location.href='{% url 'logout' %}'" title="Cerrar sesi√≥n">
                    {{ user.username|slice:":2"|upper }}
                </div>
                {% else %}
                <a href="{% url 'login' %}" class="btn">Iniciar Sesi√≥n</a>
                {% endif %}
            </div>
        </div>

        <div class="nav-menu">
            <div class="nav-item" onclick="window.location.href='{% url 'dashboard' %}'">üìä Dashboard</div>
            <div class="nav-item" onclick="window.location.href='{% url 'despachos' %}'">üì¶ Despachos</div>
            <div class="nav-item" onclick="window.location.href='{% url 'rutas' %}'">üó∫Ô∏è Rutas</div>
            <div class="nav-item" onclick="window.location.href='{% url 'vehiculos' %}'">üöõ Veh√≠culos</div>
            <div class="nav-item" onclick="window.location.href='{% url 'aeronaves' %}'">‚úàÔ∏è Aeronaves</div>
            <div class="nav-item" onclick="window.location.href='{% url 'conductores' %}'">üë®‚Äçüíº Conductores</div>
            <div class="nav-item active" onclick="window.location.href='{% url 'pilotos' %}'">üë®‚Äç‚úàÔ∏è Pilotos</div>
            <div class="nav-item" onclick="window.location.href='{% url 'clientes' %}'">üë• Clientes</div>
            <div class="nav-item" onclick="window.location.href='{% url 'cargas' %}'">üì¶ Cargas</div>
            <div class="nav-item" onclick="window.location.href='{% url 'seguros' %}'">üõ°Ô∏è Seguros</div>
            <div class="nav-item" onclick="window.location.href='{% url 'reportes' %}'">üìà Reportes</div>
            <div class="nav-item" onclick="window.location.href='{% url 'api' %}'">üîó API</div>
        </div>

        <div class="page-title">
            <span>üë®‚Äç‚úàÔ∏è</span>
            <span>Gesti√≥n de Pilotos</span>
        </div>

        <div class="filters">
            <div class="filter-group">
                <select class="filter-select" id="filter-status">
                    <option value="">Todos los estados</option>
                    <option value="active">Activo</option>
                    <option value="inactive">Inactivo</option>
                    <option value="vacation">Vacaciones</option>
                </select>
            </div>
            <input type="text" class="search-input" id="search-input" placeholder="Buscar piloto...">
            <button class="btn" id="new-pilot-btn">‚ûï Nuevo Piloto</button>
        </div>

        <div class="table-container">
            <div class="table-header">
                <div class="table-title">Lista de Pilotos</div>
                <div id="pilot-count" style="color: var(--text-secondary); font-size: 0.9rem;">Cargando...</div>
            </div>
            <table class="table">
                <thead>
                    <tr>
                        <th>Nombre</th>
                        <th>RUT</th>
                        <th>Certificaci√≥n</th>
                        <th>Horas de Vuelo</th>
                        <th>Tel√©fono</th>
                        <th>Email</th>
                        <th>Aeronave Asignada</th>
                        <th>Estado</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody id="pilots-table-body">
                    <tr>
                        <td colspan="9" class="loading">Cargando datos de pilotos desde la base de datos...</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Modal para crear nuevo piloto -->
    <div id="newPilotModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal('newPilotModal')">&times;</span>
            <h3>Nuevo Piloto</h3>
            <form id="newPilotForm">
                <div class="form-group">
                    <label class="form-label">Nombre Completo</label>
                    <input type="text" class="form-input" name="nombre" required>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">RUT</label>
                        <input type="text" class="form-input" name="rut" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Certificaci√≥n</label>
                        <input type="text" class="form-input" name="certificacion" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Tel√©fono</label>
                        <input type="text" class="form-input" name="telefono" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Email</label>
                        <input type="email" class="form-input" name="email" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Horas de Vuelo</label>
                    <input type="number" class="form-input" name="horas_vuelo" value="0" min="0">
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        <input type="checkbox" name="activo" checked> Activo
                    </label>
                </div>
                
                <div style="margin-top: 2rem; display: flex; gap: 1rem; justify-content: flex-end;">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('newPilotModal')">Cancelar</button>
                    <button type="submit" class="btn">Crear Piloto</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Variable global para almacenar los pilotos
        let pilotsData = [];

        // Funci√≥n para cargar pilotos desde la base de datos
        async function loadPilotsFromDatabase() {
            try {
                showLoadingState();
                
                const response = await fetch('/api/pilotos/');
                
                if (!response.ok) {
                    throw new Error('Error al cargar los pilotos');
                }
                
                pilotsData = await response.json();
                renderPilotsTable(pilotsData);
                showNotification('Datos de pilotos cargados correctamente');
                
            } catch (error) {
                console.error('Error:', error);
                showErrorState('Error al cargar los pilotos: ' + error.message);
            }
        }

        // Funci√≥n para mostrar estado de carga
        function showLoadingState() {
            const tableBody = document.getElementById('pilots-table-body');
            tableBody.innerHTML = `
                <tr>
                    <td colspan="9" class="loading">Cargando datos de pilotos desde la base de datos...</td>
                </tr>
            `;
            document.getElementById('pilot-count').textContent = 'Cargando...';
        }

        // Funci√≥n para mostrar estado de error
        function showErrorState(message) {
            const tableBody = document.getElementById('pilots-table-body');
            tableBody.innerHTML = `
                <tr>
                    <td colspan="9">
                        <div class="error">
                            ${message}
                            <br>
                            <button class="btn" onclick="loadPilotsFromDatabase()" style="margin-top: 1rem;">
                                Reintentar
                            </button>
                        </div>
                    </td>
                </tr>
            `;
            document.getElementById('pilot-count').textContent = 'Error';
        }

        // Funci√≥n para renderizar la tabla de pilotos
        function renderPilotsTable(pilots) {
            const tableBody = document.getElementById('pilots-table-body');
            const pilotCount = document.getElementById('pilot-count');
            
            if (pilots.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="9" class="loading">No se encontraron pilotos en la base de datos</td>
                    </tr>
                `;
                pilotCount.textContent = 'Total: 0 pilotos';
                return;
            }
            
            tableBody.innerHTML = '';
            pilotCount.textContent = `Total: ${pilots.length} pilotos`;
            
            pilots.forEach(pilot => {
                const row = document.createElement('tr');
                
                // USAR CAMPOS REALES DE LA BASE DE DATOS
                let statusClass = '';
                let statusText = '';
                
                if (pilot.activo) {
                    statusClass = 'active';
                    statusText = 'Activo';
                } else {
                    statusClass = 'inactive';
                    statusText = 'Inactivo';
                }

                // Aeronave asignada
                const aircraftAssigned = pilot.aeronave_asignada ? 
                    (pilot.aeronave_asignada_matricula || pilot.aeronave_asignada.matricula || 'Asignada') : 
                    'Sin asignar';
                
                row.innerHTML = `
                    <td>${pilot.nombre || 'N/A'}</td>
                    <td>${pilot.rut || 'N/A'}</td>
                    <td>${pilot.certificacion || 'N/A'}</td>
                    <td>${pilot.horas_vuelo || '0'} horas</td>
                    <td>${pilot.telefono || 'N/A'}</td>
                    <td>${pilot.email || 'N/A'}</td>
                    <td>${aircraftAssigned}</td>
                    <td><span class="badge ${statusClass}">${statusText}</span></td>
                    <td>
                        <button class="action-btn" onclick="viewPilot(${pilot.id})">Ver</button>
                        <button class="action-btn" onclick="window.location.href='/pilotos/${pilot.id}/editar/'">Editar</button>
                        <button class="action-btn delete" onclick="deletePilot(${pilot.id})">Eliminar</button>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
        }

        // Funci√≥n para filtrar pilotos
        function filterPilots() {
            const statusFilter = document.getElementById('filter-status').value;
            const searchText = document.getElementById('search-input').value.toLowerCase();
            
            const filteredPilots = pilotsData.filter(pilot => {
                // Filtro por estado (usando campo 'activo' real)
                const matchesStatus = !statusFilter || 
                    (statusFilter === 'active' && pilot.activo) ||
                    (statusFilter === 'inactive' && !pilot.activo) ||
                    (statusFilter === 'vacation' && !pilot.activo);
                
                // Filtro por b√∫squeda
                const matchesSearch = !searchText || 
                    (pilot.nombre && pilot.nombre.toLowerCase().includes(searchText)) ||
                    (pilot.rut && pilot.rut.toLowerCase().includes(searchText)) ||
                    (pilot.certificacion && pilot.certificacion.toLowerCase().includes(searchText)) ||
                    (pilot.email && pilot.email.toLowerCase().includes(searchText));
                
                return matchesStatus && matchesSearch;
            });
            
            renderPilotsTable(filteredPilots);
        }

        // Funciones de acci√≥n para los pilotos
        async function viewPilot(pilotId) {
            try {
                const response = await fetch(`/api/pilotos/${pilotId}/`);
                const pilotDetails = await response.json();
                
                showNotification(`Viendo detalles del piloto ${pilotId}`);
                console.log('Detalles del piloto:', pilotDetails);
                
            } catch (error) {
                console.error('Error al obtener detalles:', error);
                showNotification('Error al cargar detalles del piloto');
            }
        }

        async function deletePilot(pilotId) {
            if (confirm('¬øEst√° seguro de que desea eliminar este piloto?')) {
                try {
                    const response = await fetch(`/api/pilotos/${pilotId}/`, {
                        method: 'DELETE',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-CSRFToken': getCSRFToken()
                        }
                    });
                    
                    if (response.ok) {
                        await loadPilotsFromDatabase();
                        showNotification('Piloto eliminado correctamente');
                    } else {
                        throw new Error('Error al eliminar el piloto');
                    }
                } catch (error) {
                    console.error('Error:', error);
                    showNotification('Error al eliminar el piloto');
                }
            }
        }

        // Funciones para el modal de nuevo piloto
        function showNewPilotModal() {
            showModal('newPilotModal');
        }

        async function createPilot(formData) {
            try {
                const response = await fetch('/api/pilotos/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': getCSRFToken()
                    },
                    body: JSON.stringify(formData)
                });
                
                if (response.ok) {
                    const newPilot = await response.json();
                    showNotification('Piloto creado exitosamente');
                    closeModal('newPilotModal');
                    await loadPilotsFromDatabase();
                    return newPilot;
                } else {
                    const errorData = await response.json();
                    throw new Error(errorData.detail || 'Error al crear el piloto');
                }
            } catch (error) {
                console.error('Error:', error);
                showNotification('Error al crear el piloto: ' + error.message);
                throw error;
            }
        }

        function handlePilotFormSubmit(e) {
            e.preventDefault();
            
            const formData = {
                nombre: document.querySelector('input[name="nombre"]').value,
                rut: document.querySelector('input[name="rut"]').value,
                certificacion: document.querySelector('input[name="certificacion"]').value,
                telefono: document.querySelector('input[name="telefono"]').value,
                email: document.querySelector('input[name="email"]').value,
                horas_vuelo: parseInt(document.querySelector('input[name="horas_vuelo"]').value),
                activo: document.querySelector('input[name="activo"]').checked
            };
            
            createPilot(formData);
        }

        // Funciones auxiliares para modals
        function showModal(modalId) {
            document.getElementById(modalId).style.display = 'block';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
            // Resetear formulario
            if (modalId === 'newPilotModal') {
                document.getElementById('newPilotForm').reset();
            }
        }

        // Funci√≥n auxiliar para obtener el token CSRF
        function getCSRFToken() {
            const name = 'csrftoken';
            let cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                const cookies = document.cookie.split(';');
                for (let i = 0; i < cookies.length; i++) {
                    const cookie = cookies[i].trim();
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }

        // Funci√≥n para mostrar notificaciones
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.textContent = `‚úì ${message}`;
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: linear-gradient(135deg, #6366f1, #06b6d4);
                color: white;
                padding: 1rem 2rem;
                border-radius: 12px;
                box-shadow: 0 10px 30px rgba(99, 102, 241, 0.4);
                z-index: 1000;
                animation: slideInRight 0.4s ease-out;
                font-weight: 600;
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOutRight 0.4s ease-out';
                setTimeout(() => notification.remove(), 400);
            }, 3000);
        }

        // Inicializaci√≥n cuando se carga la p√°gina
        document.addEventListener('DOMContentLoaded', function() {
            loadPilotsFromDatabase();
            
            document.getElementById('filter-status').addEventListener('change', filterPilots);
            document.getElementById('search-input').addEventListener('input', filterPilots);
            
            document.getElementById('new-pilot-btn').addEventListener('click', showNewPilotModal);
            
            document.getElementById('newPilotForm').addEventListener('submit', handlePilotFormSubmit);
            
            console.log('üë®‚Äç‚úàÔ∏è M√≥dulo de Pilotos cargado exitosamente');
        });

        // Estilos para las animaciones de notificaciones
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideInRight {
                from {
                    transform: translateX(400px);
                    opacity: 0;
                }
                to {
                    transform: translateX(0);
                    opacity: 1;
                }
            }
            @keyframes slideOutRight {
                from {
                    transform: translateX(0);
                    opacity: 1;
                }
                to {
                    transform: translateX(400px);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(style);

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            });
        }
    </script>
</body>
</html>
============================================================


===== piloto_confirm_delete.html =====
{% extends 'base.html' %}

{% block title %}Eliminar Piloto - Log√≠stica Global{% endblock %}

{% block content %}
<div class="page-title">
    <span>üóëÔ∏è</span>
    <span>Eliminar Piloto</span>
</div>

<div class="content-card">
    <div style="text-align: center; margin-bottom: 2rem;">
        <div style="font-size: 4rem; margin-bottom: 1rem;">‚ö†Ô∏è</div>
        <h2 style="margin-bottom: 1rem;">¬øEst√°s seguro de que deseas eliminar este piloto?</h2>
        <p style="color: var(--text-secondary); margin-bottom: 2rem;">
            Piloto: {{ piloto.nombre }}<br>
            Certificaci√≥n: {{ piloto.certificacion }}<br>
            Esta acci√≥n no se puede deshacer.
        </p>
    </div>

    <form method="post" style="text-align: center;">
        {% csrf_token %}
        <div class="action-buttons" style="justify-content: center;">
            <button type="submit" class="btn btn-danger">S√≠, eliminar</button>
            <a href="{% url 'pilotos' %}" class="btn btn-secondary">Cancelar</a>
        </div>
    </form>
</div>
{% endblock %}
============================================================


===== piloto_detail.html =====
{% extends 'base.html' %}

{% block title %}Piloto {{ piloto.nombre }} - Log√≠stica Global{% endblock %}

{% block content %}
<div class="page-title">
    <span>üë®‚Äç‚úàÔ∏è</span>
    <span>Piloto {{ piloto.nombre }}</span>
</div>

<div class="content-card">
    <div class="detail-grid">
        <div class="detail-item">
            <div class="detail-label">ID</div>
            <div class="detail-value">{{ piloto.id }}</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Nombre</div>
            <div class="detail-value">{{ piloto.nombre }}</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">RUT</div>
            <div class="detail-value">{{ piloto.rut }}</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Certificaci√≥n</div>
            <div class="detail-value">{{ piloto.certificacion }}</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Tel√©fono</div>
            <div class="detail-value">{{ piloto.telefono }}</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Email</div>
            <div class="detail-value">{{ piloto.email }}</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Horas de Vuelo</div>
            <div class="detail-value">{{ piloto.horas_vuelo }} horas</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Estado</div>
            <div class="detail-value">
                <span class="badge {% if piloto.activo %}active{% else %}alert{% endif %}">
                    {% if piloto.activo %}Activo{% else %}Inactivo{% endif %}
                </span>
            </div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Aeronave Asignada</div>
            <div class="detail-value">
                {% if piloto.aeronave_set.exists %}
                    {{ piloto.aeronave_set.first.matricula }}
                {% else %}
                    <span style="color: var(--text-secondary);">Sin asignar</span>
                {% endif %}
            </div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Despachos Asignados</div>
            <div class="detail-value">{{ piloto.despacho_set.count }}</div>
        </div>
    </div>

    <div class="action-buttons">
        <a href="{% url 'piloto_edit' piloto.pk %}" class="btn">Editar</a>
        <a href="{% url 'piloto_delete' piloto.pk %}" class="btn btn-danger">Eliminar</a>
        <a href="{% url 'pilotos' %}" class="btn btn-secondary">Volver a la lista</a>
    </div>
</div>
{% endblock %}
============================================================


===== piloto_editar.html =====
{% extends 'base.html' %}

{% block title %}Editar Piloto - Log√≠stica Global{% endblock %}

{% block content %}
<div class="page-title">
    <span>üë®‚Äç‚úàÔ∏è</span>
    <span>Editar Piloto</span>
</div>

<div class="content-card">
    <form method="post">
        {% csrf_token %}
        
        <div class="form-row">
            <div class="form-group">
                <label class="form-label">Nombre</label>
                <input type="text" class="form-input" name="nombre" value="{{ piloto.nombre }}" required>
            </div>
            <div class="form-group">
                <label class="form-label">RUT</label>
                <input type="text" class="form-input" name="rut" value="{{ piloto.rut }}" required>
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label class="form-label">Certificaci√≥n</label>
                <input type="text" class="form-input" name="certificacion" value="{{ piloto.certificacion }}" required>
            </div>
            <div class="form-group">
                <label class="form-label">Tel√©fono</label>
                <input type="tel" class="form-input" name="telefono" value="{{ piloto.telefono }}" required>
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label class="form-label">Email</label>
                <input type="email" class="form-input" name="email" value="{{ piloto.email }}" required>
            </div>
            <div class="form-group">
                <label class="form-label">Horas de Vuelo</label>
                <input type="number" class="form-input" name="horas_vuelo" value="{{ piloto.horas_vuelo }}" min="0">
            </div>
        </div>

        <div class="form-group">
            <label class="form-label">
                <input type="checkbox" name="activo" {% if piloto.activo %}checked{% endif %}> Activo
            </label>
        </div>

        <div class="action-buttons">
            <button type="submit" class="btn btn-success">Actualizar Piloto</button>
            <a href="{% url 'pilotos' %}" class="btn btn-secondary">Cancelar</a>
        </div>
    </form>
</div>
{% endblock %}
============================================================


===== piloto_form.html =====
{% extends 'base.html' %}

{% block title %}Nuevo Piloto - Log√≠stica Global{% endblock %}

{% block content %}
<div class="page-title">
    <span>üë®‚Äç‚úàÔ∏è</span>
    <span>Nuevo Piloto</span>
</div>

<div class="content-card">
    <form method="post">
        {% csrf_token %}
        
        <div class="form-group">
            <label class="form-label">Nombre *</label>
            <input type="text" class="form-input" name="nombre" required>
        </div>
        
        <div class="form-group">
            <label class="form-label">RUT *</label>
            <input type="text" class="form-input" name="rut" required>
        </div>
        
        <div class="form-group">
            <label class="form-label">Certificaci√≥n *</label>
            <input type="text" class="form-input" name="certificacion" required>
        </div>
        
        <div class="form-group">
            <label class="form-label">Tel√©fono *</label>
            <input type="text" class="form-input" name="telefono" required>
        </div>
        
        <div class="form-group">
            <label class="form-label">Email *</label>
            <input type="email" class="form-input" name="email" required>
        </div>
        
        <div class="form-group">
            <label class="form-label">Horas de Vuelo</label>
            <input type="number" class="form-input" name="horas_vuelo" value="0" min="0">
        </div>
        
        <div class="form-group">
            <label class="form-label">
                <input type="checkbox" name="activo" checked> Activo
            </label>
        </div>
        
        <div class="action-buttons">
            <button type="submit" class="btn">Crear Piloto</button>
            <a href="{% url 'pilotos' %}" class="btn btn-secondary">Cancelar</a>
        </div>
    </form>
</div>
{% endblock %}
============================================================


===== reportes.html =====
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reportes - Sistema de Gesti√≥n de Transporte</title>
    <style>
        /* Todos los estilos del dashboard original */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #06b6d4;
            --accent: #f59e0b;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --info: #3b82f6;
            --bg-dark: #0f172a;
            --bg-card: #1e293b;
            --bg-hover: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --border: #334155;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--bg-dark) 0%, #1e293b 100%);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .bg-animation {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 0;
            overflow: hidden;
        }

        .bg-animation span {
            position: absolute;
            display: block;
            width: 20px;
            height: 20px;
            background: rgba(99, 102, 241, 0.1);
            animation: float 25s infinite;
            border-radius: 50%;
        }

        .bg-animation span:nth-child(1) { left: 25%; animation-delay: 0s; }
        .bg-animation span:nth-child(2) { left: 10%; animation-delay: 2s; animation-duration: 30s; }
        .bg-animation span:nth-child(3) { left: 70%; animation-delay: 4s; }
        .bg-animation span:nth-child(4) { left: 40%; animation-delay: 0s; animation-duration: 18s; }
        .bg-animation span:nth-child(5) { left: 65%; animation-delay: 0s; }
        .bg-animation span:nth-child(6) { left: 75%; animation-delay: 3s; }
        .bg-animation span:nth-child(7) { left: 35%; animation-delay: 7s; }
        .bg-animation span:nth-child(8) { left: 50%; animation-delay: 15s; animation-duration: 45s; }
        .bg-animation span:nth-child(9) { left: 20%; animation-delay: 2s; animation-duration: 35s; }
        .bg-animation span:nth-child(10) { left: 85%; animation-delay: 0s; animation-duration: 11s; }

        @keyframes float {
            0% {
                transform: translateY(100vh) scale(0);
                opacity: 0;
            }
            50% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100vh) scale(1);
                opacity: 0;
            }
        }

        .container {
            position: relative;
            z-index: 1;
            max-width: 1600px;
            margin: 0 auto;
            padding: 2.5rem 3rem;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 3rem;
            background: rgba(30, 41, 59, 0.6);
            backdrop-filter: blur(10px);
            padding: 1.5rem 2.5rem;
            border-radius: 20px;
            border: 1px solid var(--border);
            animation: slideDown 0.6s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 1rem;
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .logo-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            animation: rotate3d 3s infinite ease-in-out;
        }

        @keyframes rotate3d {
            0%, 100% { transform: rotateY(0deg); }
            50% { transform: rotateY(180deg); }
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .avatar {
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, var(--accent), var(--danger));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .avatar:hover {
            transform: scale(1.1) rotate(5deg);
        }

        .nav-menu {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .nav-item {
            padding: 0.8rem 1.5rem;
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .nav-item:hover, .nav-item.active {
            background: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(99, 102, 241, 0.4);
        }

        .page-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .reports-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .report-card {
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.8), rgba(30, 41, 59, 0.4));
            backdrop-filter: blur(10px);
            border-radius: 15px;
            border: 1px solid var(--border);
            padding: 1.5rem;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .report-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary);
        }

        .report-icon {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }

        .report-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .report-description {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }

        .btn {
            padding: 0.8rem 1.5rem;
            background: var(--primary);
            border: none;
            border-radius: 12px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(99, 102, 241, 0.4);
        }

        .btn-secondary {
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background: var(--bg-hover);
        }

        .btn-success {
            background: var(--success);
        }

        .btn-success:hover {
            background: #059669;
        }

        .content-card {
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.8), rgba(30, 41, 59, 0.4));
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 1px solid var(--border);
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .card-header h3 {
            font-size: 1.3rem;
            font-weight: 600;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-item {
            text-align: center;
            padding: 1.5rem;
            background: rgba(51, 65, 85, 0.3);
            border-radius: 12px;
            border: 1px solid var(--border);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .chart-container {
            background: rgba(51, 65, 85, 0.3);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            min-height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary);
        }

        .alert {
            padding: 1rem;
            border-radius: 12px;
            margin-bottom: 1.5rem;
            border-left: 4px solid;
        }

        .alert-success {
            background: rgba(16, 185, 129, 0.2);
            border-color: var(--success);
            color: var(--success);
        }

        .alert-error {
            background: rgba(239, 68, 68, 0.2);
            border-color: var(--danger);
            color: var(--danger);
        }

        .alert-warning {
            background: rgba(245, 158, 11, 0.2);
            border-color: var(--warning);
            color: var(--warning);
        }

        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }

            .header {
                flex-direction: column;
                gap: 1rem;
            }

            .reports-grid {
                grid-template-columns: 1fr;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="bg-animation">
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
    </div>

    <div class="container">
        <div class="header">
            <div class="logo">
                <div class="logo-icon">üöö</div>
                <span>Log√≠stica Global</span>
            </div>
            <div class="user-info">
                {% if user.is_authenticated %}
                <div>
                    <div style="font-weight: 600;">{{ user.get_full_name|default:user.username }}</div>
                    <div style="font-size: 0.85rem; color: var(--text-secondary);">
                        {% if user.perfilusuario.tipo_usuario %}{{ user.perfilusuario.tipo_usuario }}{% else %}Usuario{% endif %}
                    </div>
                </div>
                <div class="avatar" onclick="window.location.href='{% url 'logout' %}'" title="Cerrar sesi√≥n">
                    {{ user.username|slice:":2"|upper }}
                </div>
                {% else %}
                <a href="{% url 'login' %}" class="btn">Iniciar Sesi√≥n</a>
                {% endif %}
            </div>
        </div>

        <div class="nav-menu">
            <div class="nav-item" onclick="window.location.href='{% url 'dashboard' %}'">üìä Dashboard</div>
            <div class="nav-item" onclick="window.location.href='{% url 'despachos' %}'">üì¶ Despachos</div>
            <div class="nav-item" onclick="window.location.href='{% url 'rutas' %}'">üó∫Ô∏è Rutas</div>
            <div class="nav-item" onclick="window.location.href='{% url 'vehiculos' %}'">üöõ Veh√≠culos</div>
            <div class="nav-item" onclick="window.location.href='{% url 'aeronaves' %}'">‚úàÔ∏è Aeronaves</div>
            <div class="nav-item" onclick="window.location.href='{% url 'conductores' %}'">üë®‚Äçüíº Conductores</div>
            <div class="nav-item" onclick="window.location.href='{% url 'pilotos' %}'">üë®‚Äç‚úàÔ∏è Pilotos</div>
            <div class="nav-item" onclick="window.location.href='{% url 'clientes' %}'">üë• Clientes</div>
            <div class="nav-item" onclick="window.location.href='{% url 'cargas' %}'">üì¶ Cargas</div>
            <div class="nav-item" onclick="window.location.href='{% url 'seguros' %}'">üõ°Ô∏è Seguros</div>
            <div class="nav-item active" onclick="window.location.href='{% url 'reportes' %}'">üìà Reportes</div>
            <div class="nav-item" onclick="window.location.href='{% url 'api' %}'">üîó API</div>
        </div>

        <!-- BLOQUE DE PERMISOS PARA NO-ADMIN -->
        {% if user.is_authenticated and user.perfilusuario.tipo_usuario != 'ADMIN' %}
        <style>
            .reports-grid,
            .content-card,
            .stats-grid {
                display: none !important;
            }
        </style>
        
        <div class="content-card" style="text-align: center; padding: 4rem 2rem;">
            <div style="font-size: 4rem; margin-bottom: 1rem;">üîí</div>
            <h2 style="margin-bottom: 1rem; color: var(--warning);">Acceso Restringido</h2>
            <p style="color: var(--text-secondary); margin-bottom: 2rem; font-size: 1.1rem;">
                Los reportes y estad√≠sticas del sistema est√°n disponibles exclusivamente para administradores.
                <br>Contacta con el administrador del sistema si necesitas acceso a esta informaci√≥n.
            </p>
            <button class="btn" onclick="window.location.href='{% url 'dashboard' %}'">Volver al Dashboard</button>
        </div>
        {% else %}
        <!-- CONTENIDO PARA ADMINISTRADORES -->

        <!-- Mensajes del sistema -->
        {% if messages %}
            {% for message in messages %}
            <div class="alert alert-{{ message.tags }}">
                {{ message }}
            </div>
            {% endfor %}
        {% endif %}

        <div class="page-title">
            <span>üìà</span>
            <span>Reportes y Estad√≠sticas</span>
        </div>

        <div class="reports-grid">
            <div class="report-card" onclick="generateReport('despachos')">
                <div class="report-icon" style="background: linear-gradient(135deg, var(--primary), var(--secondary));">
                    üì¶
                </div>
                <div class="report-title">Reporte de Despachos</div>
                <div class="report-description">
                    An√°lisis completo de despachos por estado, tipo de transporte y per√≠odo.
                </div>
                <button class="btn">Generar Reporte</button>
            </div>

            <div class="report-card" onclick="generateReport('financiero')">
                <div class="report-icon" style="background: linear-gradient(135deg, var(--success), var(--accent));">
                    üí∞
                </div>
                <div class="report-title">Reporte Financiero</div>
                <div class="report-description">
                    Ingresos, costos y m√©tricas financieras del sistema.
                </div>
                <button class="btn">Generar Reporte</button>
            </div>

            <div class="report-card" onclick="generateReport('flota')">
                <div class="report-icon" style="background: linear-gradient(135deg, var(--info), var(--secondary));">
                    üöõ
                </div>
                <div class="report-title">Estado de Flota</div>
                <div class="report-description">
                    Veh√≠culos y aeronaves: mantenimiento, utilizaci√≥n y disponibilidad.
                </div>
                <button class="btn">Generar Reporte</button>
            </div>

            <div class="report-card" onclick="generateReport('clientes')">
                <div class="report-icon" style="background: linear-gradient(135deg, var(--warning), var(--danger));">
                    üë•
                </div>
                <div class="report-title">An√°lisis de Clientes</div>
                <div class="report-description">
                    Comportamiento, volumen y rentabilidad por cliente.
                </div>
                <button class="btn">Generar Reporte</button>
            </div>
        </div>

        <div class="content-card">
            <div class="card-header">
                <h3>üìä Resumen General</h3>
                <button class="btn btn-success" onclick="window.location.href='{% url 'generar_reporte_pdf' %}'">
                    üìÑ Exportar PDF
                </button>
            </div>

            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-value">{{ total_despachos }}</div>
                    <div class="stat-label">Total Despachos</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">{{ despachos_pendientes }}</div>
                    <div class="stat-label">Pendientes</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">{{ despachos_en_ruta }}</div>
                    <div class="stat-label">En Ruta</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">{{ despachos_entregados }}</div>
                    <div class="stat-label">Entregados</div>
                </div>
            </div>

            <div class="chart-container">
                <div style="text-align: center;">
                    <div style="font-size: 3rem; margin-bottom: 1rem;">üìà</div>
                    <div>Gr√°fico de Despachos por Estado</div>
                    <div style="font-size: 0.8rem; margin-top: 0.5rem; color: var(--text-secondary);">
                        (En una implementaci√≥n real aqu√≠ ir√≠an gr√°ficos con Chart.js o similar)
                    </div>
                </div>
            </div>
        </div>

        <div class="content-card">
            <div class="card-header">
                <h3>üì¶ Distribuci√≥n de Cargas</h3>
            </div>
            <div class="chart-container">
                <div style="text-align: center;">
                    <div style="font-size: 3rem; margin-bottom: 1rem;">üìä</div>
                    <div>Gr√°fico de Cargas por Tipo</div>
                    <div style="font-size: 0.8rem; margin-top: 0.5rem; color: var(--text-secondary);">
                        (Visualizaci√≥n de tipos de carga m√°s frecuentes)
                    </div>
                </div>
            </div>
        </div>
        {% endif %}
    </div>

    <script>
        function generateReport(type) {
            showNotification(`Generando reporte de ${type}...`, 'info');
            
            // Simular generaci√≥n de reporte
            setTimeout(() => {
                showNotification(`Reporte de ${type} generado exitosamente`, 'success');
                
                // En una implementaci√≥n real, aqu√≠ se descargar√≠a el reporte
                if (type === 'despachos') {
                    window.open('{% url "generar_reporte_pdf" %}', '_blank');
                }
            }, 2000);
        }

        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            
            let backgroundColor = 'linear-gradient(135deg, #6366f1, #06b6d4)';
            let icon = '‚úì';
            
            if (type === 'error') {
                backgroundColor = 'linear-gradient(135deg, #ef4444, #dc2626)';
                icon = '‚ùå';
            } else if (type === 'warning') {
                backgroundColor = 'linear-gradient(135deg, #f59e0b, #d97706)';
                icon = '‚ö†Ô∏è';
            } else if (type === 'info') {
                backgroundColor = 'linear-gradient(135deg, #3b82f6, #1d4ed8)';
                icon = '‚ÑπÔ∏è';
            }
            
            notification.innerHTML = `<span style="margin-right: 8px;">${icon}</span>${message}`;
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${backgroundColor};
                color: white;
                padding: 1rem 2rem;
                border-radius: 12px;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
                z-index: 1000;
                animation: slideInRight 0.4s ease-out;
                font-weight: 600;
                display: flex;
                align-items: center;
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOutRight 0.4s ease-out';
                setTimeout(() => notification.remove(), 400);
            }, 4000);
        }

        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideInRight {
                from {
                    transform: translateX(400px);
                    opacity: 0;
                }
                to {
                    transform: translateX(0);
                    opacity: 1;
                }
            }
            @keyframes slideOutRight {
                from {
                    transform: translateX(0);
                    opacity: 1;
                }
                to {
                    transform: translateX(400px);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(style);

        console.log('üìà M√≥dulo de Reportes cargado exitosamente');
    </script>
</body>
</html>
============================================================


===== rutas.html =====
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rutas - Sistema de Gesti√≥n de Transporte</title>
    <style>
        /* MANTENER TODOS LOS ESTILOS ORIGINALES EXACTAMENTE IGUAL */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #06b6d4;
            --accent: #f59e0b;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --info: #3b82f6;
            --bg-dark: #0f172a;
            --bg-card: #1e293b;
            --bg-hover: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --border: #334155;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--bg-dark) 0%, #1e293b 100%);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .bg-animation {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 0;
            overflow: hidden;
        }

        .bg-animation span {
            position: absolute;
            display: block;
            width: 20px;
            height: 20px;
            background: rgba(99, 102, 241, 0.1);
            animation: float 25s infinite;
            border-radius: 50%;
        }

        .bg-animation span:nth-child(1) { left: 25%; animation-delay: 0s; }
        .bg-animation span:nth-child(2) { left: 10%; animation-delay: 2s; animation-duration: 30s; }
        .bg-animation span:nth-child(3) { left: 70%; animation-delay: 4s; }
        .bg-animation span:nth-child(4) { left: 40%; animation-delay: 0s; animation-duration: 18s; }
        .bg-animation span:nth-child(5) { left: 65%; animation-delay: 0s; }
        .bg-animation span:nth-child(6) { left: 75%; animation-delay: 3s; }
        .bg-animation span:nth-child(7) { left: 35%; animation-delay: 7s; }
        .bg-animation span:nth-child(8) { left: 50%; animation-delay: 15s; animation-duration: 45s; }
        .bg-animation span:nth-child(9) { left: 20%; animation-delay: 2s; animation-duration: 35s; }
        .bg-animation span:nth-child(10) { left: 85%; animation-delay: 0s; animation-duration: 11s; }

        @keyframes float {
            0% {
                transform: translateY(100vh) scale(0);
                opacity: 0;
            }
            50% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100vh) scale(1);
                opacity: 0;
            }
        }

        .container {
            position: relative;
            z-index: 1;
            max-width: 1600px;
            margin: 0 auto;
            padding: 2.5rem 3rem;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 3rem;
            background: rgba(30, 41, 59, 0.6);
            backdrop-filter: blur(10px);
            padding: 1.5rem 2.5rem;
            border-radius: 20px;
            border: 1px solid var(--border);
            animation: slideDown 0.6s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 1rem;
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .logo-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            animation: rotate3d 3s infinite ease-in-out;
        }

        @keyframes rotate3d {
            0%, 100% { transform: rotateY(0deg); }
            50% { transform: rotateY(180deg); }
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .avatar {
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, var(--accent), var(--danger));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .avatar:hover {
            transform: scale(1.1) rotate(5deg);
        }

        .nav-menu {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .nav-item {
            padding: 0.8rem 1.5rem;
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .nav-item:hover, .nav-item.active {
            background: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(99, 102, 241, 0.4);
        }

        .page-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .filters {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .filter-group {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .filter-select, .search-input {
            padding: 0.8rem 1.2rem;
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 0.95rem;
            min-width: 180px;
        }

        .search-input {
            flex: 1;
            min-width: 250px;
        }

        .btn {
            padding: 0.8rem 1.5rem;
            background: var(--primary);
            border: none;
            border-radius: 12px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(99, 102, 241, 0.4);
        }

        .btn-secondary {
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background: var(--bg-hover);
        }

        .table-container {
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.8), rgba(30, 41, 59, 0.4));
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 1px solid var(--border);
            overflow: hidden;
            margin-bottom: 2rem;
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem 2rem;
            border-bottom: 1px solid var(--border);
        }

        .table-title {
            font-size: 1.3rem;
            font-weight: 600;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
        }

        .table th {
            text-align: left;
            padding: 1.2rem 1.5rem;
            background: rgba(51, 65, 85, 0.3);
            font-weight: 600;
            color: var(--text-secondary);
            border-bottom: 1px solid var(--border);
        }

        .table td {
            padding: 1.2rem 1.5rem;
            border-bottom: 1px solid var(--border);
        }

        .table tr:last-child td {
            border-bottom: none;
        }

        .table tr:hover {
            background: rgba(51, 65, 85, 0.2);
        }

        .badge {
            padding: 0.4rem 1rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .badge.terrestre {
            background: rgba(59, 130, 246, 0.2);
            color: var(--info);
        }

        .badge.aereo {
            background: rgba(139, 92, 246, 0.2);
            color: #a78bfa;
        }

        .badge.activa {
            background: rgba(16, 185, 129, 0.2);
            color: var(--success);
        }

        .badge.inactiva {
            background: rgba(148, 163, 184, 0.2);
            color: var(--text-secondary);
        }

        .loading {
            text-align: center;
            padding: 2rem;
            color: var(--text-secondary);
        }

        .error {
            text-align: center;
            padding: 2rem;
            color: var(--danger);
            background: rgba(239, 68, 68, 0.1);
            border-radius: 12px;
            margin: 1rem 0;
        }

        .pagination {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem 2rem;
            border-top: 1px solid var(--border);
        }

        .pagination-info {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .pagination-controls {
            display: flex;
            gap: 0.5rem;
        }

        .pagination-btn {
            padding: 0.6rem 1rem;
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .pagination-btn:hover {
            background: var(--primary);
        }

        .pagination-btn.active {
            background: var(--primary);
        }

        .action-btn {
            padding: 0.4rem 0.8rem;
            background: rgba(99, 102, 241, 0.2);
            border: 1px solid var(--primary);
            border-radius: 8px;
            color: var(--primary);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.85rem;
            margin-right: 0.5rem;
        }

        .action-btn:hover {
            background: var(--primary);
            color: white;
        }

        .action-btn.delete {
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid var(--danger);
            color: var(--danger);
        }

        .action-btn.delete:hover {
            background: var(--danger);
            color: white;
        }

        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }

            .header {
                flex-direction: column;
                gap: 1rem;
            }

            .filters {
                flex-direction: column;
            }

            .filter-group {
                width: 100%;
            }

            .filter-select, .search-input {
                min-width: 100%;
            }

            .table-container {
                overflow-x: auto;
            }

            .table {
                min-width: 800px;
            }
        }
    </style>
</head>
<body>
    <div class="bg-animation">
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
    </div>

    <div class="container">
        <div class="header">
            <div class="logo">
                <div class="logo-icon">üó∫Ô∏è</div>
                <span>Log√≠stica Global</span>
            </div>
            <div class="user-info">
                {% if user.is_authenticated %}
                <div>
                    <div style="font-weight: 600;">{{ user.get_full_name|default:user.username }}</div>
                    <div style="font-size: 0.85rem; color: var(--text-secondary);">
                        {% if user.perfilusuario.tipo_usuario == 'ADMIN' %}Administrador
                        {% elif user.perfilusuario.tipo_usuario == 'CLIENTE' %}Cliente
                        {% elif user.perfilusuario.tipo_usuario == 'CONDUCTOR' %}Conductor
                        {% elif user.perfilusuario.tipo_usuario == 'PILOTO' %}Piloto
                        {% else %}Usuario{% endif %}
                    </div>
                </div>
                <div class="avatar" onclick="window.location.href='{% url 'logout' %}'" title="Cerrar sesi√≥n">
                    {{ user.username|slice:":2"|upper }}
                </div>
                {% else %}
                <a href="{% url 'login' %}" class="btn">Iniciar Sesi√≥n</a>
                {% endif %}
            </div>
        </div>

        <div class="nav-menu">
            <div class="nav-item" onclick="window.location.href='{% url 'dashboard' %}'">üìä Dashboard</div>
            <div class="nav-item" onclick="window.location.href='{% url 'despachos' %}'">üì¶ Despachos</div>
            <div class="nav-item active" onclick="window.location.href='{% url 'rutas' %}'">üó∫Ô∏è Rutas</div>
            <div class="nav-item" onclick="window.location.href='{% url 'vehiculos' %}'">üöõ Veh√≠culos</div>
            <div class="nav-item" onclick="window.location.href='{% url 'aeronaves' %}'">‚úàÔ∏è Aeronaves</div>
            <div class="nav-item" onclick="window.location.href='{% url 'conductores' %}'">üë®‚Äçüíº Conductores</div>
            <div class="nav-item" onclick="window.location.href='{% url 'pilotos' %}'">üë®‚Äç‚úàÔ∏è Pilotos</div>
            <div class="nav-item" onclick="window.location.href='{% url 'clientes' %}'">üë• Clientes</div>
            <div class="nav-item" onclick="window.location.href='{% url 'cargas' %}'">üì¶ Cargas</div>
            <div class="nav-item" onclick="window.location.href='{% url 'seguros' %}'">üõ°Ô∏è Seguros</div>
            {% if user.is_superuser or user.perfilusuario.tipo_usuario == 'ADMIN' %}
            <div class="nav-item" onclick="window.location.href='{% url 'reportes' %}'">üìà Reportes</div>
            {% endif %}
            <div class="nav-item" onclick="window.location.href='{% url 'api' %}'">üîó API</div>
        </div>

        <!-- BLOQUE DE PERMISOS PARA NO-ADMIN -->
        {% if user.is_authenticated and user.perfilusuario.tipo_usuario != 'ADMIN' %}
        <style>
            #new-route-btn,
            .btn[onclick*="crear"],
            .btn[onclick*="editar"],
            .btn[onclick*="eliminar"],
            .action-btn.delete,
            .btn-danger {
                display: none !important;
            }
        </style>
        
        <div style="background: rgba(59, 130, 246, 0.2); border: 1px solid #3b82f6; border-radius: 12px; padding: 1rem; margin-bottom: 1.5rem;">
            <div style="display: flex; align-items: center; gap: 0.5rem; color: #3b82f6;">
                <span>üîí</span>
                <div>
                    <strong>Modo Solo Lectura</strong>
                    <div style="font-size: 0.9rem; opacity: 0.9;">
                        Como {{ user.perfilusuario.tipo_usuario|title }}, solo puedes visualizar informaci√≥n de rutas.
                    </div>
                </div>
            </div>
        </div>
        {% endif %}

        <!-- Mensajes del sistema -->
        {% if messages %}
            {% for message in messages %}
            <div class="alert alert-{{ message.tags }}">
                {{ message }}
            </div>
            {% endfor %}
        {% endif %}

        <div class="page-title">
            <span>üó∫Ô∏è</span>
            <span>Gesti√≥n de Rutas</span>
        </div>

        <div class="filters">
            <div class="filter-group">
                <select class="filter-select" id="filter-type">
                    <option value="">Todos los tipos</option>
                    <option value="TERRESTRE">Terrestre</option>
                    <option value="AEREO">A√©reo</option>
                </select>
            </div>
            <input type="text" class="search-input" id="search-input" placeholder="Buscar ruta...">
            <button class="btn" id="new-route-btn">‚ûï Nueva Ruta</button>
        </div>

        <div class="table-container">
            <div class="table-header">
                <div class="table-title">Lista de Rutas</div>
                <div id="route-count" style="color: var(--text-secondary); font-size: 0.9rem;">Cargando...</div>
            </div>
            <table class="table">
                <thead>
                    <tr>
                        <th>ID Ruta</th>
                        <th>Origen - Destino</th>
                        <th>Tipo</th>
                        <th>Distancia</th>
                        <th>Tiempo Estimado</th>
                        <th>Estado</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody id="routes-table-body">
                    <tr>
                        <td colspan="7" class="loading">Cargando datos de rutas desde la base de datos...</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <script>
        // Variable global para almacenar las rutas
        let routesData = [];

        // ‚úÖ FUNCI√ìN MEJORADA PARA CARGAR RUTAS REALES
        async function loadRoutesFromDatabase() {
            try {
                showLoadingState();
                
                console.log('üîç Cargando rutas desde la nueva API...');
                
                // Usar la nueva API espec√≠fica
                const response = await fetch('/api/v1/rutas/', {
                    method: 'GET',
                    headers: {
                        'Accept': 'application/json',
                        'Content-Type': 'application/json'
                    }
                });
                
                console.log('üì° Respuesta de la API:', response.status, response.statusText);
                
                if (!response.ok) {
                    throw new Error(`Error HTTP: ${response.status}`);
                }
                
                const data = await response.json();
                console.log('‚úÖ Datos REALES cargados:', data);
                
                if (data && data.length > 0) {
                    routesData = data;
                    renderRoutesTable(routesData);
                    showNotification(`${data.length} rutas cargadas correctamente desde la base de datos`, 'success');
                } else {
                    showNotification('No hay rutas creadas en la base de datos', 'info');
                    routesData = [];
                    renderRoutesTable(routesData);
                }
                
            } catch (error) {
                console.error('‚ùå Error al cargar rutas:', error);
                showErrorState('Error al cargar las rutas: ' + error.message);
            }
        }

        // Funci√≥n para mostrar estado de carga
        function showLoadingState() {
            const tableBody = document.getElementById('routes-table-body');
            tableBody.innerHTML = `
                <tr>
                    <td colspan="7" class="loading">Cargando datos de rutas desde la base de datos...</td>
                </tr>
            `;
            document.getElementById('route-count').textContent = 'Cargando...';
        }

        // Funci√≥n para mostrar estado de error
        function showErrorState(message) {
            const tableBody = document.getElementById('routes-table-body');
            tableBody.innerHTML = `
                <tr>
                    <td colspan="7">
                        <div class="error">
                            ${message}
                            <br>
                            <button class="btn" onclick="loadRoutesFromDatabase()" style="margin-top: 1rem;">
                                Reintentar
                            </button>
                        </div>
                    </td>
                </tr>
            `;
            document.getElementById('route-count').textContent = 'Error';
        }

        // Funci√≥n para calcular tiempo estimado
        function calculateEstimatedTime(distance, transportType) {
            if (transportType === 'AEREO') {
                const hours = Math.ceil(distance / 800); // Velocidad promedio 800 km/h
                return `${hours}h`;
            } else {
                const hours = Math.ceil(distance / 80); // Velocidad promedio 80 km/h
                return `${hours}h`;
            }
        }

        // Funci√≥n para renderizar la tabla de rutas
        function renderRoutesTable(routes) {
            const tableBody = document.getElementById('routes-table-body');
            const routeCount = document.getElementById('route-count');
            
            if (routes.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="7" class="loading">No se encontraron rutas en la base de datos</td>
                    </tr>
                `;
                routeCount.textContent = 'Total: 0 rutas';
                return;
            }
            
            tableBody.innerHTML = '';
            routeCount.textContent = `Total: ${routes.length} rutas`;
            
            routes.forEach(route => {
                const row = document.createElement('tr');
                
                // Tipo de transporte
                const typeClass = route.tipo_transporte === 'AEREO' ? 'aereo' : 'terrestre';
                const typeText = route.tipo_transporte === 'AEREO' ? 'A√©reo' : 'Terrestre';
                const typeIcon = route.tipo_transporte === 'AEREO' ? '‚úàÔ∏è' : 'üöõ';
                
                // Estado (siempre activo para rutas)
                const statusClass = 'activa';
                const statusText = 'Activa';
                
                // Tiempo estimado
                const estimatedTime = calculateEstimatedTime(route.distancia_km, route.tipo_transporte);
                
                row.innerHTML = `
                    <td>RUT-${route.id}</td>
                    <td>${route.origen} - ${route.destino}</td>
                    <td>
                        <span class="badge ${typeClass}">
                            ${typeIcon} ${typeText}
                        </span>
                    </td>
                    <td>${route.distancia_km} km</td>
                    <td>${estimatedTime}</td>
                    <td><span class="badge ${statusClass}">${statusText}</span></td>
                    <td>
                        <button class="action-btn" onclick="viewRoute(${route.id})">Ver</button>
                        {% if user.is_authenticated and user.perfilusuario.tipo_usuario == 'ADMIN' %}
                        <button class="action-btn" onclick="editRoute(${route.id})">Editar</button>
                        <button class="action-btn delete" onclick="deleteRoute(${route.id})">Eliminar</button>
                        {% endif %}
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
        }

        // Funci√≥n para filtrar rutas
        function filterRoutes() {
            const typeFilter = document.getElementById('filter-type').value;
            const searchText = document.getElementById('search-input').value.toLowerCase();
            
            const filteredRoutes = routesData.filter(route => {
                // Filtro por tipo
                const matchesType = !typeFilter || route.tipo_transporte === typeFilter;
                
                // Filtro por b√∫squeda
                const matchesSearch = !searchText || 
                    route.origen.toLowerCase().includes(searchText) ||
                    route.destino.toLowerCase().includes(searchText);
                
                return matchesType && matchesSearch;
            });
            
            renderRoutesTable(filteredRoutes);
        }

        // Funciones de acci√≥n para las rutas
        function viewRoute(routeId) {
            showNotification(`Viendo detalles de la ruta ${routeId}`, 'info');
            // En una implementaci√≥n real, redirigir√≠a a la p√°gina de detalles
            // window.location.href = `/rutas/${routeId}/`;
        }

        function editRoute(routeId) {
            showNotification(`Editando la ruta ${routeId}`, 'info');
            window.location.href = `/rutas/${routeId}/editar/`;
        }

        function deleteRoute(routeId) {
            if (confirm(`¬øEst√° seguro de que desea eliminar la ruta ${routeId}? Esta acci√≥n no se puede deshacer.`)) {
                showNotification('Eliminando ruta...', 'warning');
                // En una implementaci√≥n real, enviar√≠a una solicitud DELETE
            }
        }

        // Funci√≥n para mostrar notificaciones
        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            
            let backgroundColor = 'linear-gradient(135deg, #10b981, #059669)';
            let icon = '‚úì';
            
            if (type === 'error') {
                backgroundColor = 'linear-gradient(135deg, #ef4444, #dc2626)';
                icon = '‚ùå';
            } else if (type === 'warning') {
                backgroundColor = 'linear-gradient(135deg, #f59e0b, #d97706)';
                icon = '‚ö†Ô∏è';
            } else if (type === 'info') {
                backgroundColor = 'linear-gradient(135deg, #3b82f6, #1d4ed8)';
                icon = '‚ÑπÔ∏è';
            }
            
            notification.innerHTML = `<span style="margin-right: 8px;">${icon}</span>${message}`;
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${backgroundColor};
                color: white;
                padding: 1rem 2rem;
                border-radius: 12px;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
                z-index: 1000;
                animation: slideInRight 0.4s ease-out;
                font-weight: 600;
                display: flex;
                align-items: center;
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOutRight 0.4s ease-out';
                setTimeout(() => notification.remove(), 400);
            }, 4000);
        }

        // Inicializaci√≥n cuando se carga la p√°gina
        document.addEventListener('DOMContentLoaded', function() {
            loadRoutesFromDatabase();
            
            document.getElementById('filter-type').addEventListener('change', filterRoutes);
            document.getElementById('search-input').addEventListener('input', filterRoutes);
            
            // Configurar bot√≥n de nueva ruta solo para admin
            const newRouteBtn = document.getElementById('new-route-btn');
            newRouteBtn.addEventListener('click', function() {
                {% if user.is_authenticated and user.perfilusuario.tipo_usuario == 'ADMIN' %}
                window.location.href = '{% url 'ruta_create' %}';
                {% else %}
                showNotification('Solo los administradores pueden crear nuevas rutas', 'warning');
                {% endif %}
            });
            
            console.log('üó∫Ô∏è M√≥dulo de Rutas cargado exitosamente');
        });

        // Estilos para las animaciones de notificaciones
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideInRight {
                from {
                    transform: translateX(400px);
                    opacity: 0;
                }
                to {
                    transform: translateX(0);
                    opacity: 1;
                }
            }
            @keyframes slideOutRight {
                from {
                    transform: translateX(0);
                    opacity: 1;
                }
                to {
                    transform: translateX(400px);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
============================================================


===== ruta_confirm_delete.html =====
{% extends 'base.html' %}

{% block title %}Eliminar Ruta - Log√≠stica Global{% endblock %}

{% block content %}
<div class="page-title">
    <span>üóëÔ∏è</span>
    <span>Eliminar Ruta</span>
</div>

<div class="content-card">
    <div style="text-align: center; margin-bottom: 2rem;">
        <div style="font-size: 4rem; margin-bottom: 1rem;">‚ö†Ô∏è</div>
        <h2 style="margin-bottom: 1rem;">¬øEst√°s seguro de que deseas eliminar esta ruta?</h2>
        <p style="color: var(--text-secondary); margin-bottom: 2rem;">
            Ruta: {{ object.origen }} - {{ object.destino }}<br>
            Tipo: {{ object.get_tipo_transporte_display }}<br>
            Esta acci√≥n no se puede deshacer.
        </p>
    </div>

    <form method="post" style="text-align: center;">
        {% csrf_token %}
        <div class="action-buttons" style="justify-content: center;">
            <button type="submit" class="btn btn-danger">S√≠, eliminar</button>
            <a href="{% url 'ruta_detail' object.pk %}" class="btn btn-secondary">Cancelar</a>
        </div>
    </form>
</div>
{% endblock %} COnfirm_delete 
============================================================


===== ruta_detail.html =====
{% extends 'base.html' %}

{% block title %}Ruta {{ ruta.id }} - Log√≠stica Global{% endblock %}

{% block content %}
<div class="page-title">
    <span>üó∫Ô∏è</span>
    <span>Ruta {{ ruta.origen }} - {{ ruta.destino }}</span>
</div>

<div class="content-card">
    <div class="detail-grid">
        <div class="detail-item">
            <div class="detail-label">ID</div>
            <div class="detail-value">{{ ruta.id }}</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Origen</div>
            <div class="detail-value">{{ ruta.origen }}</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Destino</div>
            <div class="detail-value">{{ ruta.destino }}</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Tipo de Transporte</div>
            <div class="detail-value">
                <span class="badge {% if ruta.tipo_transporte == 'TERRESTRE' %}info{% else %}warning{% endif %}">
                    {{ ruta.get_tipo_transporte_display }}
                </span>
            </div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Distancia</div>
            <div class="detail-value">{{ ruta.distancia_km }} km</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Despachos Asociados</div>
            <div class="detail-value">{{ ruta.despacho_set.count }}</div>
        </div>
    </div>

    <div class="action-buttons">
        <a href="{% url 'ruta_edit' ruta.pk %}" class="btn">Editar</a>
        <a href="{% url 'ruta_delete' ruta.pk %}" class="btn btn-danger">Eliminar</a>
        <a href="{% url 'rutas' %}" class="btn btn-secondary">Volver a la lista</a>
    </div>
</div>
{% endblock %}
============================================================


===== ruta_form.html =====
{% extends 'base.html' %}

{% block title %}{% if form.instance.pk %}Editar{% else %}Crear{% endif %} Ruta - Log√≠stica Global{% endblock %}

{% block content %}
<div class="page-title">
    <span>üó∫Ô∏è</span>
    <span>{% if form.instance.pk %}Editar Ruta{% else %}Nueva Ruta{% endif %}</span>
</div>

<div class="content-card">
    <form method="post">
        {% csrf_token %}
        
        <div class="form-row">
            <div class="form-group">
                <label class="form-label" for="id_origen">Origen</label>
                {{ form.origen }}
            </div>
            <div class="form-group">
                <label class="form-label" for="id_destino">Destino</label>
                {{ form.destino }}
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label class="form-label" for="id_tipo_transporte">Tipo de Transporte</label>
                {{ form.tipo_transporte }}
            </div>
            <div class="form-group">
                <label class="form-label" for="id_distancia_km">Distancia (km)</label>
                {{ form.distancia_km }}
            </div>
        </div>

        <div class="action-buttons">
            <button type="submit" class="btn btn-success">
                {% if form.instance.pk %}Actualizar{% else %}Crear{% endif %} Ruta
            </button>
            <a href="{% url 'rutas' %}" class="btn btn-secondary">Cancelar</a>
        </div>
    </form>
</div>
{% endblock %}

============================================================


===== seguros.html =====
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Seguros - Sistema de Gesti√≥n de Transporte</title>
    <style>
        /* MANTENER TODOS LOS ESTILOS ORIGINALES EXACTAMENTE IGUAL */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #06b6d4;
            --accent: #f59e0b;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --info: #3b82f6;
            --bg-dark: #0f172a;
            --bg-card: #1e293b;
            --bg-hover: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --border: #334155;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--bg-dark) 0%, #1e293b 100%);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .bg-animation {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 0;
            overflow: hidden;
        }

        .bg-animation span {
            position: absolute;
            display: block;
            width: 20px;
            height: 20px;
            background: rgba(99, 102, 241, 0.1);
            animation: float 25s infinite;
            border-radius: 50%;
        }

        .bg-animation span:nth-child(1) { left: 25%; animation-delay: 0s; }
        .bg-animation span:nth-child(2) { left: 10%; animation-delay: 2s; animation-duration: 30s; }
        .bg-animation span:nth-child(3) { left: 70%; animation-delay: 4s; }
        .bg-animation span:nth-child(4) { left: 40%; animation-delay: 0s; animation-duration: 18s; }
        .bg-animation span:nth-child(5) { left: 65%; animation-delay: 0s; }
        .bg-animation span:nth-child(6) { left: 75%; animation-delay: 3s; }
        .bg-animation span:nth-child(7) { left: 35%; animation-delay: 7s; }
        .bg-animation span:nth-child(8) { left: 50%; animation-delay: 15s; animation-duration: 45s; }
        .bg-animation span:nth-child(9) { left: 20%; animation-delay: 2s; animation-duration: 35s; }
        .bg-animation span:nth-child(10) { left: 85%; animation-delay: 0s; animation-duration: 11s; }

        @keyframes float {
            0% {
                transform: translateY(100vh) scale(0);
                opacity: 0;
            }
            50% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100vh) scale(1);
                opacity: 0;
            }
        }

        .container {
            position: relative;
            z-index: 1;
            max-width: 1600px;
            margin: 0 auto;
            padding: 2.5rem 3rem;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 3rem;
            background: rgba(30, 41, 59, 0.6);
            backdrop-filter: blur(10px);
            padding: 1.5rem 2.5rem;
            border-radius: 20px;
            border: 1px solid var(--border);
            animation: slideDown 0.6s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 1rem;
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .logo-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            animation: rotate3d 3s infinite ease-in-out;
        }

        @keyframes rotate3d {
            0%, 100% { transform: rotateY(0deg); }
            50% { transform: rotateY(180deg); }
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .avatar {
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, var(--accent), var(--danger));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .avatar:hover {
            transform: scale(1.1) rotate(5deg);
        }

        .nav-menu {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .nav-item {
            padding: 0.8rem 1.5rem;
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .nav-item:hover, .nav-item.active {
            background: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(99, 102, 241, 0.4);
        }

        .page-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .filters {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .filter-group {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .filter-select, .search-input {
            padding: 0.8rem 1.2rem;
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 0.95rem;
            min-width: 180px;
        }

        .search-input {
            flex: 1;
            min-width: 250px;
        }

        .btn {
            padding: 0.8rem 1.5rem;
            background: var(--primary);
            border: none;
            border-radius: 12px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(99, 102, 241, 0.4);
        }

        .btn-secondary {
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background: var(--bg-hover);
        }

        .table-container {
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.8), rgba(30, 41, 59, 0.4));
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 1px solid var(--border);
            overflow: hidden;
            margin-bottom: 2rem;
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem 2rem;
            border-bottom: 1px solid var(--border);
        }

        .table-title {
            font-size: 1.3rem;
            font-weight: 600;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
        }

        .table th {
            text-align: left;
            padding: 1.2rem 1.5rem;
            background: rgba(51, 65, 85, 0.3);
            font-weight: 600;
            color: var(--text-secondary);
            border-bottom: 1px solid var(--border);
        }

        .table td {
            padding: 1.2rem 1.5rem;
            border-bottom: 1px solid var(--border);
        }

        .table tr:last-child td {
            border-bottom: none;
        }

        .table tr:hover {
            background: rgba(51, 65, 85, 0.2);
        }

        .badge {
            padding: 0.4rem 1rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .badge.active {
            background: rgba(16, 185, 129, 0.2);
            color: var(--success);
        }

        .badge.expired {
            background: rgba(239, 68, 68, 0.2);
            color: var(--danger);
        }

        .badge.warning {
            background: rgba(245, 158, 11, 0.2);
            color: var(--warning);
        }

        .badge.vehiculo {
            background: rgba(59, 130, 246, 0.2);
            color: var(--info);
        }

        .badge.aeronave {
            background: rgba(139, 92, 246, 0.2);
            color: #a78bfa;
        }

        .badge.carga {
            background: rgba(245, 158, 11, 0.2);
            color: var(--warning);
        }

        .loading {
            text-align: center;
            padding: 2rem;
            color: var(--text-secondary);
        }

        .error {
            text-align: center;
            padding: 2rem;
            color: var(--danger);
            background: rgba(239, 68, 68, 0.1);
            border-radius: 12px;
            margin: 1rem 0;
        }

        .pagination {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem 2rem;
            border-top: 1px solid var(--border);
        }

        .pagination-info {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .pagination-controls {
            display: flex;
            gap: 0.5rem;
        }

        .pagination-btn {
            padding: 0.6rem 1rem;
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .pagination-btn:hover {
            background: var(--primary);
        }

        .pagination-btn.active {
            background: var(--primary);
        }

        .action-btn {
            padding: 0.4rem 0.8rem;
            background: rgba(99, 102, 241, 0.2);
            border: 1px solid var(--primary);
            border-radius: 8px;
            color: var(--primary);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.85rem;
            margin-right: 0.5rem;
        }

        .action-btn:hover {
            background: var(--primary);
            color: white;
        }

        .action-btn.delete {
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid var(--danger);
            color: var(--danger);
        }

        .action-btn.delete:hover {
            background: var(--danger);
            color: white;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--bg-card);
            padding: 2rem;
            border-radius: 20px;
            border: 1px solid var(--border);
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .close-modal {
            position: absolute;
            top: 1rem;
            right: 1rem;
            cursor: pointer;
            font-size: 1.5rem;
            color: var(--text-secondary);
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .form-input, .form-select {
            width: 100%;
            padding: 0.8rem 1rem;
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 0.95rem;
        }

        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: var(--primary);
        }

        .form-row {
            display: flex;
            gap: 1rem;
        }

        .form-row .form-group {
            flex: 1;
        }

        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }

            .header {
                flex-direction: column;
                gap: 1rem;
            }

            .filters {
                flex-direction: column;
            }

            .filter-group {
                width: 100%;
            }

            .filter-select, .search-input {
                min-width: 100%;
            }

            .table-container {
                overflow-x: auto;
            }

            .table {
                min-width: 800px;
            }

            .form-row {
                flex-direction: column;
                gap: 0;
            }
        }
    </style>
</head>
<body>
    <div class="bg-animation">
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
    </div>

    <div class="container">
        <div class="header">
            <div class="logo">
                <div class="logo-icon">üöö</div>
                <span>Log√≠stica Global</span>
            </div>
            <div class="user-info">
                {% if user.is_authenticated %}
                <div>
                    <div style="font-weight: 600;">{{ user.get_full_name|default:user.username }}</div>
                    <div style="font-size: 0.85rem; color: var(--text-secondary);">
                        {% if user.is_staff %}Administrador{% else %}Usuario{% endif %}
                    </div>
                </div>
                <div class="avatar" onclick="window.location.href='{% url 'logout' %}'" title="Cerrar sesi√≥n">
                    {{ user.username|slice:":2"|upper }}
                </div>
                {% else %}
                <a href="{% url 'login' %}" class="btn">Iniciar Sesi√≥n</a>
                {% endif %}
            </div>
        </div>

        <div class="nav-menu">
            <div class="nav-item" onclick="window.location.href='{% url 'dashboard' %}'">üìä Dashboard</div>
            <div class="nav-item" onclick="window.location.href='{% url 'despachos' %}'">üì¶ Despachos</div>
            <div class="nav-item" onclick="window.location.href='{% url 'rutas' %}'">üó∫Ô∏è Rutas</div>
            <div class="nav-item" onclick="window.location.href='{% url 'vehiculos' %}'">üöõ Veh√≠culos</div>
            <div class="nav-item" onclick="window.location.href='{% url 'aeronaves' %}'">‚úàÔ∏è Aeronaves</div>
            <div class="nav-item" onclick="window.location.href='{% url 'conductores' %}'">üë®‚Äçüíº Conductores</div>
            <div class="nav-item" onclick="window.location.href='{% url 'pilotos' %}'">üë®‚Äç‚úàÔ∏è Pilotos</div>
            <div class="nav-item" onclick="window.location.href='{% url 'clientes' %}'">üë• Clientes</div>
            <div class="nav-item" onclick="window.location.href='{% url 'cargas' %}'">üì¶ Cargas</div>
            <div class="nav-item active" onclick="window.location.href='{% url 'seguros' %}'">üõ°Ô∏è Seguros</div>
            <div class="nav-item" onclick="window.location.href='{% url 'reportes' %}'">üìà Reportes</div>
            <div class="nav-item" onclick="window.location.href='{% url 'api' %}'">üîó API</div>
        </div>

        <div class="page-title">
            <span>üõ°Ô∏è</span>
            <span>Gesti√≥n de Seguros</span>
        </div>

        <div class="filters">
            <div class="filter-group">
                <select class="filter-select" id="filter-status">
                    <option value="">Todos los estados</option>
                    <option value="active">Vigente</option>
                    <option value="warning">Por Vencer</option>
                    <option value="expired">Vencido</option>
                </select>
                <select class="filter-select" id="filter-type">
                    <option value="">Todos los tipos</option>
                    <option value="vehiculo">Veh√≠culo</option>
                    <option value="aeronave">Aeronave</option>
                    <option value="carga">Carga</option>
                </select>
            </div>
            <input type="text" class="search-input" id="search-input" placeholder="Buscar seguro...">
            <button class="btn" id="new-insurance-btn">‚ûï Nuevo Seguro</button>
        </div>

        <div class="table-container">
            <div class="table-header">
                <div class="table-title">Lista de Seguros</div>
                <div id="insurance-count" style="color: var(--text-secondary); font-size: 0.9rem;">Cargando...</div>
            </div>
            <table class="table">
                <thead>
                    <tr>
                        <th>N¬∞ P√≥liza</th>
                        <th>Tipo de Seguro</th>
                        <th>Aseguradora</th>
                        <th>Cobertura</th>
                        <th>Vigencia Desde</th>
                        <th>Vigencia Hasta</th>
                        <th>Estado</th>
                        <th>Asegurado</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody id="insurances-table-body">
                    <tr>
                        <td colspan="9" class="loading">Cargando datos de seguros desde la base de datos...</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Modal para crear nuevo seguro -->
    <div id="newInsuranceModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal('newInsuranceModal')">&times;</span>
            <h3>Nuevo Seguro</h3>
            <form id="newInsuranceForm">
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">N√∫mero de P√≥liza</label>
                        <input type="text" class="form-input" name="numero_poliza" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Tipo de Seguro</label>
                        <select class="form-select" name="tipo_seguro" required>
                            <option value="">Seleccionar tipo</option>
                            <option value="Veh√≠culo">Veh√≠culo</option>
                            <option value="Aeronave">Aeronave</option>
                            <option value="Carga">Carga</option>
                            <option value="Responsabilidad Civil">Responsabilidad Civil</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Aseguradora</label>
                    <input type="text" class="form-input" name="aseguradora" required>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Cobertura ($)</label>
                        <input type="number" class="form-input" name="cobertura" step="0.01" required min="0">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Estado</label>
                        <select class="form-select" name="estado" required>
                            <option value="Vigente">Vigente</option>
                            <option value="Por Vencer">Por Vencer</option>
                            <option value="Vencido">Vencido</option>
                            <option value="Cancelado">Cancelado</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Vigencia Desde</label>
                        <input type="date" class="form-input" name="vigencia_desde" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Vigencia Hasta</label>
                        <input type="date" class="form-input" name="vigencia_hasta" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Veh√≠culo Asegurado</label>
                        <select class="form-select" name="vehiculo" id="vehiculo-select">
                            <option value="">No aplica</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Aeronave Asegurada</label>
                        <select class="form-select" name="aeronave" id="aeronave-select">
                            <option value="">No aplica</option>
                        </select>
                    </div>
                </div>
                
                <div style="margin-top: 2rem; display: flex; gap: 1rem; justify-content: flex-end;">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('newInsuranceModal')">Cancelar</button>
                    <button type="submit" class="btn">Crear Seguro</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Variable global para almacenar los seguros
        let insurancesData = [];

        // Funci√≥n para cargar seguros desde la base de datos
        async function loadInsurancesFromDatabase() {
            try {
                showLoadingState();
                
                const response = await fetch('/api/seguros/');
                
                if (!response.ok) {
                    throw new Error('Error al cargar los seguros');
                }
                
                insurancesData = await response.json();
                renderInsurancesTable(insurancesData);
                showNotification('Datos de seguros cargados correctamente');
                
            } catch (error) {
                console.error('Error:', error);
                showErrorState('Error al cargar los seguros: ' + error.message);
            }
        }

        // Funci√≥n para mostrar estado de carga
        function showLoadingState() {
            const tableBody = document.getElementById('insurances-table-body');
            tableBody.innerHTML = `
                <tr>
                    <td colspan="9" class="loading">Cargando datos de seguros desde la base de datos...</td>
                </tr>
            `;
            document.getElementById('insurance-count').textContent = 'Cargando...';
        }

        // Funci√≥n para mostrar estado de error
        function showErrorState(message) {
            const tableBody = document.getElementById('insurances-table-body');
            tableBody.innerHTML = `
                <tr>
                    <td colspan="9">
                        <div class="error">
                            ${message}
                            <br>
                            <button class="btn" onclick="loadInsurancesFromDatabase()" style="margin-top: 1rem;">
                                Reintentar
                            </button>
                        </div>
                    </td>
                </tr>
            `;
            document.getElementById('insurance-count').textContent = 'Error';
        }

        // Funci√≥n para determinar estado del seguro
        function getInsuranceStatus(vigenciaHasta) {
            if (!vigenciaHasta) return 'expired';
            
            const today = new Date();
            const endDate = new Date(vigenciaHasta);
            const daysDiff = Math.ceil((endDate - today) / (1000 * 60 * 60 * 24));
            
            if (daysDiff < 0) return 'expired';
            if (daysDiff <= 30) return 'warning';
            return 'active';
        }

        // Funci√≥n para formatear moneda
        function formatCurrency(amount) {
            if (!amount) return 'N/A';
            return new Intl.NumberFormat('es-CL', {
                style: 'currency',
                currency: 'CLP'
            }).format(amount);
        }

        // Funci√≥n para formatear fecha
        function formatDate(dateString) {
            if (!dateString) return 'N/A';
            const date = new Date(dateString);
            return date.toLocaleDateString('es-ES');
        }

        // Funci√≥n para renderizar la tabla de seguros
        function renderInsurancesTable(insurances) {
            const tableBody = document.getElementById('insurances-table-body');
            const insuranceCount = document.getElementById('insurance-count');
            
            if (insurances.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="9" class="loading">No se encontraron seguros en la base de datos</td>
                    </tr>
                `;
                insuranceCount.textContent = 'Total: 0 seguros';
                return;
            }
            
            tableBody.innerHTML = '';
            insuranceCount.textContent = `Total: ${insurances.length} seguros`;
            
            insurances.forEach(insurance => {
                const row = document.createElement('tr');
                
                // Determinar estado del seguro
                const status = getInsuranceStatus(insurance.vigencia_hasta);
                
                let statusClass = '';
                let statusText = '';
                
                switch (status) {
                    case 'active':
                        statusClass = 'active';
                        statusText = 'Vigente';
                        break;
                    case 'warning':
                        statusClass = 'warning';
                        statusText = 'Por Vencer';
                        break;
                    case 'expired':
                        statusClass = 'expired';
                        statusText = 'Vencido';
                        break;
                    default:
                        statusClass = 'active';
                        statusText = insurance.estado || 'Vigente';
                }

                // Tipo de seguro
                let typeClass = '';
                let typeText = insurance.tipo_seguro || 'N/A';
                
                if (typeText.toLowerCase().includes('veh√≠culo') || typeText.toLowerCase().includes('vehiculo')) {
                    typeClass = 'vehiculo';
                } else if (typeText.toLowerCase().includes('aeronave')) {
                    typeClass = 'aeronave';
                } else if (typeText.toLowerCase().includes('carga')) {
                    typeClass = 'carga';
                } else {
                    typeClass = 'vehiculo';
                }

                // Asegurado
                let insuredItem = 'N/A';
                if (insurance.vehiculo) {
                    insuredItem = insurance.vehiculo_patente || insurance.vehiculo.patente || 'Veh√≠culo';
                } else if (insurance.aeronave) {
                    insuredItem = insurance.aeronave_matricula || insurance.aeronave.matricula || 'Aeronave';
                }
                
                row.innerHTML = `
                    <td>${insurance.numero_poliza || 'N/A'}</td>
                    <td><span class="badge ${typeClass}">${typeText}</span></td>
                    <td>${insurance.aseguradora || 'N/A'}</td>
                    <td>${formatCurrency(insurance.cobertura)}</td>
                    <td>${formatDate(insurance.vigencia_desde)}</td>
                    <td>${formatDate(insurance.vigencia_hasta)}</td>
                    <td><span class="badge ${statusClass}">${statusText}</span></td>
                    <td>${insuredItem}</td>
                    <td>
                        <button class="action-btn" onclick="viewInsurance(${insurance.id})">Ver</button>
                        <button class="action-btn" onclick="window.location.href='/seguros/${insurance.id}/editar/'">Editar</button>
                        <button class="action-btn delete" onclick="deleteInsurance(${insurance.id})">Eliminar</button>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
        }

        // Funci√≥n para filtrar seguros
        function filterInsurances() {
            const statusFilter = document.getElementById('filter-status').value;
            const typeFilter = document.getElementById('filter-type').value;
            const searchText = document.getElementById('search-input').value.toLowerCase();
            
            const filteredInsurances = insurancesData.filter(insurance => {
                // Filtro por estado
                const status = getInsuranceStatus(insurance.vigencia_hasta);
                const matchesStatus = !statusFilter || 
                    (statusFilter === 'active' && status === 'active') ||
                    (statusFilter === 'warning' && status === 'warning') ||
                    (statusFilter === 'expired' && status === 'expired');
                
                // Filtro por tipo
                const matchesType = !typeFilter || 
                    (typeFilter === 'vehiculo' && insurance.tipo_seguro && insurance.tipo_seguro.toLowerCase().includes('veh√≠culo')) ||
                    (typeFilter === 'aeronave' && insurance.tipo_seguro && insurance.tipo_seguro.toLowerCase().includes('aeronave')) ||
                    (typeFilter === 'carga' && insurance.tipo_seguro && insurance.tipo_seguro.toLowerCase().includes('carga'));
                
                // Filtro por b√∫squeda
                const matchesSearch = !searchText || 
                    (insurance.numero_poliza && insurance.numero_poliza.toLowerCase().includes(searchText)) ||
                    (insurance.aseguradora && insurance.aseguradora.toLowerCase().includes(searchText)) ||
                    (insurance.tipo_seguro && insurance.tipo_seguro.toLowerCase().includes(searchText));
                
                return matchesStatus && matchesType && matchesSearch;
            });
            
            renderInsurancesTable(filteredInsurances);
        }

        // Funciones de acci√≥n para los seguros
        async function viewInsurance(insuranceId) {
            try {
                const response = await fetch(`/api/seguros/${insuranceId}/`);
                const insuranceDetails = await response.json();
                
                showNotification(`Viendo detalles del seguro ${insuranceId}`);
                console.log('Detalles del seguro:', insuranceDetails);
                
            } catch (error) {
                console.error('Error al obtener detalles:', error);
                showNotification('Error al cargar detalles del seguro');
            }
        }

        async function deleteInsurance(insuranceId) {
            if (confirm('¬øEst√° seguro de que desea eliminar este seguro?')) {
                try {
                    const response = await fetch(`/api/seguros/${insuranceId}/`, {
                        method: 'DELETE',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-CSRFToken': getCSRFToken()
                        }
                    });
                    
                    if (response.ok) {
                        await loadInsurancesFromDatabase();
                        showNotification('Seguro eliminado correctamente');
                    } else {
                        throw new Error('Error al eliminar el seguro');
                    }
                } catch (error) {
                    console.error('Error:', error);
                    showNotification('Error al eliminar el seguro');
                }
            }
        }

        // Funciones para el modal de nuevo seguro
        async function showNewInsuranceModal() {
            await loadVehiclesForSelect();
            await loadAircraftForSelect();
            showModal('newInsuranceModal');
        }

        async function loadVehiclesForSelect() {
            try {
                const response = await fetch('/api/vehiculos/');
                if (response.ok) {
                    const vehicles = await response.json();
                    const select = document.getElementById('vehiculo-select');
                    
                    // Limpiar opciones excepto la primera
                    while (select.children.length > 1) {
                        select.removeChild(select.lastChild);
                    }
                    
                    // Agregar veh√≠culos activos
                    vehicles.forEach(vehicle => {
                        if (vehicle.activo) {
                            const option = document.createElement('option');
                            option.value = vehicle.id;
                            option.textContent = `${vehicle.patente} - ${vehicle.modelo}`;
                            select.appendChild(option);
                        }
                    });
                }
            } catch (error) {
                console.error('Error al cargar veh√≠culos:', error);
            }
        }

        async function loadAircraftForSelect() {
            try {
                const response = await fetch('/api/aeronaves/');
                if (response.ok) {
                    const aircrafts = await response.json();
                    const select = document.getElementById('aeronave-select');
                    
                    // Limpiar opciones excepto la primera
                    while (select.children.length > 1) {
                        select.removeChild(select.lastChild);
                    }
                    
                    // Agregar aeronaves activas
                    aircrafts.forEach(aircraft => {
                        if (aircraft.activo) {
                            const option = document.createElement('option');
                            option.value = aircraft.id;
                            option.textContent = `${aircraft.matricula} - ${aircraft.modelo}`;
                            select.appendChild(option);
                        }
                    });
                }
            } catch (error) {
                console.error('Error al cargar aeronaves:', error);
            }
        }

        async function createInsurance(formData) {
            try {
                const response = await fetch('/api/seguros/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': getCSRFToken()
                    },
                    body: JSON.stringify(formData)
                });
                
                if (response.ok) {
                    const newInsurance = await response.json();
                    showNotification('Seguro creado exitosamente');
                    closeModal('newInsuranceModal');
                    await loadInsurancesFromDatabase();
                    return newInsurance;
                } else {
                    const errorData = await response.json();
                    throw new Error(errorData.detail || 'Error al crear el seguro');
                }
            } catch (error) {
                console.error('Error:', error);
                showNotification('Error al crear el seguro: ' + error.message);
                throw error;
            }
        }

        function handleInsuranceFormSubmit(e) {
            e.preventDefault();
            
            const formData = {
                numero_poliza: document.querySelector('input[name="numero_poliza"]').value,
                tipo_seguro: document.querySelector('select[name="tipo_seguro"]').value,
                aseguradora: document.querySelector('input[name="aseguradora"]').value,
                cobertura: parseFloat(document.querySelector('input[name="cobertura"]').value),
                estado: document.querySelector('select[name="estado"]').value,
                vigencia_desde: document.querySelector('input[name="vigencia_desde"]').value,
                vigencia_hasta: document.querySelector('input[name="vigencia_hasta"]').value,
                vehiculo: document.querySelector('select[name="vehiculo"]').value || null,
                aeronave: document.querySelector('select[name="aeronave"]').value || null
            };
            
            createInsurance(formData);
        }

        // Funciones auxiliares para modals
        function showModal(modalId) {
            document.getElementById(modalId).style.display = 'block';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
            // Resetear formulario
            if (modalId === 'newInsuranceModal') {
                document.getElementById('newInsuranceForm').reset();
            }
        }

        // Funci√≥n auxiliar para obtener el token CSRF
        function getCSRFToken() {
            const name = 'csrftoken';
            let cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                const cookies = document.cookie.split(';');
                for (let i = 0; i < cookies.length; i++) {
                    const cookie = cookies[i].trim();
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }

        // Funci√≥n para mostrar notificaciones
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.textContent = `‚úì ${message}`;
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: linear-gradient(135deg, #6366f1, #06b6d4);
                color: white;
                padding: 1rem 2rem;
                border-radius: 12px;
                box-shadow: 0 10px 30px rgba(99, 102, 241, 0.4);
                z-index: 1000;
                animation: slideInRight 0.4s ease-out;
                font-weight: 600;
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOutRight 0.4s ease-out';
                setTimeout(() => notification.remove(), 400);
            }, 3000);
        }

        // Inicializaci√≥n cuando se carga la p√°gina
        document.addEventListener('DOMContentLoaded', function() {
            loadInsurancesFromDatabase();
            
            document.getElementById('filter-status').addEventListener('change', filterInsurances);
            document.getElementById('filter-type').addEventListener('change', filterInsurances);
            document.getElementById('search-input').addEventListener('input', filterInsurances);
            
            document.getElementById('new-insurance-btn').addEventListener('click', showNewInsuranceModal);
            
            document.getElementById('newInsuranceForm').addEventListener('submit', handleInsuranceFormSubmit);
            
            console.log('üõ°Ô∏è M√≥dulo de Seguros cargado exitosamente');
        });

        // Estilos para las animaciones de notificaciones
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideInRight {
                from {
                    transform: translateX(400px);
                    opacity: 0;
                }
                to {
                    transform: translateX(0);
                    opacity: 1;
                }
            }
            @keyframes slideOutRight {
                from {
                    transform: translateX(0);
                    opacity: 1;
                }
                to {
                    transform: translateX(400px);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(style);

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            });
        }
    </script>
</body>
</html>
============================================================


===== seguro_confirm_delete.html =====
{% extends 'base.html' %}

{% block title %}Eliminar Seguro - Log√≠stica Global{% endblock %}

{% block content %}
<div class="page-title">
    <span>üóëÔ∏è</span>
    <span>Eliminar Seguro</span>
</div>

<div class="content-card">
    <div style="text-align: center; margin-bottom: 2rem;">
        <div style="font-size: 4rem; margin-bottom: 1rem;">‚ö†Ô∏è</div>
        <h2 style="margin-bottom: 1rem;">¬øEst√°s seguro de que deseas eliminar este seguro?</h2>
        <p style="color: var(--text-secondary); margin-bottom: 2rem;">
            P√≥liza: {{ seguro.numero_poliza }}<br>
            Aseguradora: {{ seguro.aseguradora }}<br>
            Esta acci√≥n no se puede deshacer.
        </p>
    </div>

    <form method="post" style="text-align: center;">
        {% csrf_token %}
        <div class="action-buttons" style="justify-content: center;">
            <button type="submit" class="btn btn-danger">S√≠, eliminar</button>
            <a href="{% url 'seguros' %}" class="btn btn-secondary">Cancelar</a>
        </div>
    </form>
</div>
{% endblock %}
============================================================


===== seguro_detail.html =====
/div>
        
        <div class="detail-item">
            <div class="detail-label">Aseguradora</div>
            <div class="detail-value">{{ seguro.aseguradora }}</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Cobertura</div>
            <div class="detail-value">${{ seguro.cobertura }}</div>
        </div>
        
        <div class="detail-item">
          {% extends 'base.html' %}

{% block title %}Seguro {{ seguro.numero_poliza }} - Log√≠stica Global{% endblock %}

{% block content %}
<div class="page-title">
    <span>üõ°Ô∏è</span>
    <span>Seguro {{ seguro.numero_poliza }}</span>
</div>

<div class="content-card">
    <div class="detail-grid">
        <div class="detail-item">
            <div class="detail-label">N√∫mero de P√≥liza</div>
            <div class="detail-value">{{ seguro.numero_poliza }}</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Tipo de Seguro</div>
            <div class="detail-value">{{ seguro.tipo_seguro }}</div>
        <  <div class="detail-label">Vigencia Desde</div>
            <div class="detail-value">{{ seguro.vigencia_desde|date:"d/m/Y" }}</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Vigencia Hasta</div>
            <div class="detail-value">{{ seguro.vigencia_hasta|date:"d/m/Y" }}</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Estado</div>
            <div class="detail-value">
                <span class="badge 
                    {% if seguro.estado == 'Vigente' %}active
                    {% elif seguro.estado == 'Por Vencer' %}warning
                    {% else %}alert{% endif %}">
                    {{ seguro.estado }}
                </span>
            </div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Veh√≠culo Asegurado</div>
            <div class="detail-value">
                {% if seguro.vehiculo %}
                    {{ seguro.vehiculo.patente }} - {{ seguro.vehiculo.modelo }}
                {% else %}
                    <span style="color: var(--text-secondary);">No aplica</span>
                {% endif %}
            </div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Aeronave Asegurada</div>
            <div class="detail-value">
                {% if seguro.aeronave %}
                    {{ seguro.aeronave.matricula }} - {{ seguro.aeronave.modelo }}
                {% else %}
                    <span style="color: var(--text-secondary);">No aplica</span>
                {% endif %}
            </div>
        </div>
    </div>

    <div class="action-buttons">
        <a href="{% url 'seguro_edit' seguro.pk %}" class="btn">Editar</a>
        <a href="{% url 'seguro_delete' seguro.pk %}" class="btn btn-danger">Eliminar</a>
        <a href="{% url 'seguros' %}" class="btn btn-secondary">Volver a la lista</a>
    </div>
</div>
{% endblock %}
============================================================


===== seguro_editar.html =====
{% extends 'base.html' %}

{% block title %}Editar Seguro - Log√≠stica Global{% endblock %}

{% block content %}
<div class="page-title">
    <span>üõ°Ô∏è</span>
    <span>Editar Seguro</span>
</div>

<div class="content-card">
    <form method="post">
        {% csrf_token %}
        
        <div class="form-row">
            <div class="form-group">
                <label class="form-label">N√∫mero de P√≥liza</label>
                <input type="text" class="form-input" name="numero_poliza" value="{{ seguro.numero_poliza }}" required>
            </div>
            <div class="form-group">
                <label class="form-label">Tipo de Seguro</label>
                <input type="text" class="form-input" name="tipo_seguro" value="{{ seguro.tipo_seguro }}" required>
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label class="form-label">Aseguradora</label>
                <input type="text" class="form-input" name="aseguradora" value="{{ seguro.aseguradora }}" required>
            </div>
            <div class="form-group">
                <label class="form-label">Cobertura</label>
                <input type="number" class="form-input" name="cobertura" value="{{ seguro.cobertura }}" step="0.01" required min="0">
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label class="form-label">Vigencia Desde</label>
                <input type="date" class="form-input" name="vigencia_desde" value="{{ seguro.vigencia_desde|date:'Y-m-d' }}" required>
            </div>
            <div class="form-group">
                <label class="form-label">Vigencia Hasta</label>
                <input type="date" class="form-input" name="vigencia_hasta" value="{{ seguro.vigencia_hasta|date:'Y-m-d' }}" required>
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label class="form-label">Veh√≠culo</label>
                <select class="form-select" name="vehiculo">
                    <option value="">No aplica</option>
                    {% for vehiculo in vehiculos %}
                    <option value="{{ vehiculo.id }}" {% if seguro.vehiculo and seguro.vehiculo.id == vehiculo.id %}selected{% endif %}>
                        {{ vehiculo.patente }} - {{ vehiculo.modelo }}
                    </option>
                    {% endfor %}
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Aeronave</label>
                <select class="form-select" name="aeronave">
                    <option value="">No aplica</option>
                    {% for aeronave in aeronaves %}
                    <option value="{{ aeronave.id }}" {% if seguro.aeronave and seguro.aeronave.id == aeronave.id %}selected{% endif %}>
                        {{ aeronave.matricula }} - {{ aeronave.modelo }}
                    </option>
                    {% endfor %}
                </select>
            </div>
        </div>

        <div class="form-group">
            <label class="form-label">Estado</label>
            <select class="form-select" name="estado" required>
                <option value="Vigente" {% if seguro.estado == 'Vigente' %}selected{% endif %}>Vigente</option>
                <option value="Vencido" {% if seguro.estado == 'Vencido' %}selected{% endif %}>Vencido</option>
                <option value="Cancelado" {% if seguro.estado == 'Cancelado' %}selected{% endif %}>Cancelado</option>
                <option value="En Proceso" {% if seguro.estado == 'En Proceso' %}selected{% endif %}>En Proceso</option>
            </select>
        </div>

        <div class="action-buttons">
            <button type="submit" class="btn btn-success">Actualizar Seguro</button>
            <a href="{% url 'seguros' %}" class="btn btn-secondary">Cancelar</a>
        </div>
    </form>
</div>
{% endblock %}
============================================================


===== seguro_form.html =====
{% extends 'base.html' %}

{% block title %}Nuevo Seguro - Log√≠stica Global{% endblock %}

{% block content %}
<div class="page-title">
    <span>üõ°Ô∏è</span>
    <span>Nuevo Seguro</span>
</div>

<div class="content-card">
    <form method="post">
        {% csrf_token %}
        
        <div class="form-group">
            <label class="form-label">N√∫mero de P√≥liza *</label>
            <input type="text" class="form-input" name="numero_poliza" required>
        </div>
        
        <div class="form-group">
            <label class="form-label">Tipo de Seguro *</label>
            <input type="text" class="form-input" name="tipo_seguro" required>
        </div>
        
        <div class="form-group">
            <label class="form-label">Aseguradora *</label>
            <input type="text" class="form-input" name="aseguradora" required>
        </div>
        
        <div class="form-group">
            <label class="form-label">Cobertura *</label>
            <input type="number" class="form-input" name="cobertura" step="0.01" required min="0">
        </div>
        
        <div class="form-group">
            <label class="form-label">Vigencia Desde *</label>
            <input type="date" class="form-input" name="vigencia_desde" required>
        </div>
        
        <div class="form-group">
            <label class="form-label">Vigencia Hasta *</label>
            <input type="date" class="form-input" name="vigencia_hasta" required>
        </div>
        
        <div class="form-group">
            <label class="form-label">Estado *</label>
            <select class="form-select" name="estado" required>
                <option value="Vigente">Vigente</option>
                <option value="Vencido">Vencido</option>
                <option value="Cancelado">Cancelado</option>
            </select>
        </div>
        
        <div class="form-group">
            <label class="form-label">Veh√≠culo Asegurado</label>
            <select class="form-select" name="vehiculo">
                <option value="">Sin veh√≠culo</option>
                {% for vehiculo in vehiculos %}
                <option value="{{ vehiculo.id }}">{{ vehiculo.patente }} - {{ vehiculo.modelo }}</option>
                {% endfor %}
            </select>
        </div>
        
        <div class="form-group">
            <label class="form-label">Aeronave Asegurada</label>
            <select class="form-select" name="aeronave">
                <option value="">Sin aeronave</option>
                {% for aeronave in aeronaves %}
                <option value="{{ aeronave.id }}">{{ aeronave.matricula }} - {{ aeronave.modelo }}</option>
                {% endfor %}
            </select>
        </div>
        
        <div class="action-buttons">
            <button type="submit" class="btn">Crear Seguro</button>
            <a href="{% url 'seguros' %}" class="btn btn-secondary">Cancelar</a>
        </div>
    </form>
</div>
{% endblock %}
============================================================


===== vehiculos.html =====
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Veh√≠culos - Sistema de Gesti√≥n de Transporte</title>
    <style>
        /* MANTENER TODOS LOS ESTILOS ORIGINALES EXACTAMENTE IGUAL */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #06b6d4;
            --accent: #f59e0b;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --info: #3b82f6;
            --bg-dark: #0f172a;
            --bg-card: #1e293b;
            --bg-hover: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --border: #334155;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--bg-dark) 0%, #1e293b 100%);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .bg-animation {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 0;
            overflow: hidden;
        }

        .bg-animation span {
            position: absolute;
            display: block;
            width: 20px;
            height: 20px;
            background: rgba(99, 102, 241, 0.1);
            animation: float 25s infinite;
            border-radius: 50%;
        }

        .bg-animation span:nth-child(1) { left: 25%; animation-delay: 0s; }
        .bg-animation span:nth-child(2) { left: 10%; animation-delay: 2s; animation-duration: 30s; }
        .bg-animation span:nth-child(3) { left: 70%; animation-delay: 4s; }
        .bg-animation span:nth-child(4) { left: 40%; animation-delay: 0s; animation-duration: 18s; }
        .bg-animation span:nth-child(5) { left: 65%; animation-delay: 0s; }
        .bg-animation span:nth-child(6) { left: 75%; animation-delay: 3s; }
        .bg-animation span:nth-child(7) { left: 35%; animation-delay: 7s; }
        .bg-animation span:nth-child(8) { left: 50%; animation-delay: 15s; animation-duration: 45s; }
        .bg-animation span:nth-child(9) { left: 20%; animation-delay: 2s; animation-duration: 35s; }
        .bg-animation span:nth-child(10) { left: 85%; animation-delay: 0s; animation-duration: 11s; }

        @keyframes float {
            0% {
                transform: translateY(100vh) scale(0);
                opacity: 0;
            }
            50% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100vh) scale(1);
                opacity: 0;
            }
        }

        .container {
            position: relative;
            z-index: 1;
            max-width: 1600px;
            margin: 0 auto;
            padding: 2.5rem 3rem;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 3rem;
            background: rgba(30, 41, 59, 0.6);
            backdrop-filter: blur(10px);
            padding: 1.5rem 2.5rem;
            border-radius: 20px;
            border: 1px solid var(--border);
            animation: slideDown 0.6s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 1rem;
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .logo-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            animation: rotate3d 3s infinite ease-in-out;
        }

        @keyframes rotate3d {
            0%, 100% { transform: rotateY(0deg); }
            50% { transform: rotateY(180deg); }
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .avatar {
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, var(--accent), var(--danger));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .avatar:hover {
            transform: scale(1.1) rotate(5deg);
        }

        .nav-menu {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .nav-item {
            padding: 0.8rem 1.5rem;
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .nav-item:hover, .nav-item.active {
            background: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(99, 102, 241, 0.4);
        }

        .page-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .filters {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .filter-group {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .filter-select, .search-input {
            padding: 0.8rem 1.2rem;
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 0.95rem;
            min-width: 180px;
        }

        .search-input {
            flex: 1;
            min-width: 250px;
        }

        .btn {
            padding: 0.8rem 1.5rem;
            background: var(--primary);
            border: none;
            border-radius: 12px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(99, 102, 241, 0.4);
        }

        .btn-secondary {
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background: var(--bg-hover);
        }

        .table-container {
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.8), rgba(30, 41, 59, 0.4));
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 1px solid var(--border);
            overflow: hidden;
            margin-bottom: 2rem;
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem 2rem;
            border-bottom: 1px solid var(--border);
        }

        .table-title {
            font-size: 1.3rem;
            font-weight: 600;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
        }

        .table th {
            text-align: left;
            padding: 1.2rem 1.5rem;
            background: rgba(51, 65, 85, 0.3);
            font-weight: 600;
            color: var(--text-secondary);
            border-bottom: 1px solid var(--border);
        }

        .table td {
            padding: 1.2rem 1.5rem;
            border-bottom: 1px solid var(--border);
        }

        .table tr:last-child td {
            border-bottom: none;
        }

        .table tr:hover {
            background: rgba(51, 65, 85, 0.2);
        }

        .badge {
            padding: 0.4rem 1rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .badge.active {
            background: rgba(16, 185, 129, 0.2);
            color: var(--success);
        }

        .badge.maintenance {
            background: rgba(245, 158, 11, 0.2);
            color: var(--warning);
        }

        .badge.inactive {
            background: rgba(239, 68, 68, 0.2);
            color: var(--danger);
        }

        .badge.camion {
            background: rgba(59, 130, 246, 0.2);
            color: var(--info);
        }

        .badge.furgon {
            background: rgba(139, 92, 246, 0.2);
            color: #a78bfa;
        }

        .badge.van {
            background: rgba(245, 158, 11, 0.2);
            color: var(--warning);
        }

        .loading {
            text-align: center;
            padding: 2rem;
            color: var(--text-secondary);
        }

        .error {
            text-align: center;
            padding: 2rem;
            color: var(--danger);
            background: rgba(239, 68, 68, 0.1);
            border-radius: 12px;
            margin: 1rem 0;
        }

        .pagination {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem 2rem;
            border-top: 1px solid var(--border);
        }

        .pagination-info {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .pagination-controls {
            display: flex;
            gap: 0.5rem;
        }

        .pagination-btn {
            padding: 0.6rem 1rem;
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .pagination-btn:hover {
            background: var(--primary);
        }

        .pagination-btn.active {
            background: var(--primary);
        }

        .action-btn {
            padding: 0.4rem 0.8rem;
            background: rgba(99, 102, 241, 0.2);
            border: 1px solid var(--primary);
            border-radius: 8px;
            color: var(--primary);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.85rem;
            margin-right: 0.5rem;
        }

        .action-btn:hover {
            background: var(--primary);
            color: white;
        }

        .action-btn.delete {
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid var(--danger);
            color: var(--danger);
        }

        .action-btn.delete:hover {
            background: var(--danger);
            color: white;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--bg-card);
            padding: 2rem;
            border-radius: 20px;
            border: 1px solid var(--border);
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .close-modal {
            position: absolute;
            top: 1rem;
            right: 1rem;
            cursor: pointer;
            font-size: 1.5rem;
            color: var(--text-secondary);
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .form-input, .form-select {
            width: 100%;
            padding: 0.8rem 1rem;
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--border);
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 0.95rem;
        }

        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: var(--primary);
        }

        .form-row {
            display: flex;
            gap: 1rem;
        }

        .form-row .form-group {
            flex: 1;
        }

        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }

            .header {
                flex-direction: column;
                gap: 1rem;
            }

            .filters {
                flex-direction: column;
            }

            .filter-group {
                width: 100%;
            }

            .filter-select, .search-input {
                min-width: 100%;
            }

            .table-container {
                overflow-x: auto;
            }

            .table {
                min-width: 800px;
            }

            .form-row {
                flex-direction: column;
                gap: 0;
            }
        }
    </style>
</head>
<body>
    <div class="bg-animation">
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
    </div>

    <div class="container">
        <div class="header">
            <div class="logo">
                <div class="logo-icon">üöõ</div>
                <span>Log√≠stica Global</span>
            </div>
            <div class="user-info">
                {% if user.is_authenticated %}
                <div>
                    <div style="font-weight: 600;">{{ user.get_full_name|default:user.username }}</div>
                    <div style="font-size: 0.85rem; color: var(--text-secondary);">
                        {% if user.is_staff %}Administrador{% else %}Usuario{% endif %}
                    </div>
                </div>
                <div class="avatar" onclick="window.location.href='{% url 'logout' %}'" title="Cerrar sesi√≥n">
                    {{ user.username|slice:":2"|upper }}
                </div>
                {% else %}
                <a href="{% url 'login' %}" class="btn">Iniciar Sesi√≥n</a>
                {% endif %}
            </div>
        </div>

        <div class="nav-menu">
            <div class="nav-item" onclick="window.location.href='{% url 'dashboard' %}'">üìä Dashboard</div>
            <div class="nav-item" onclick="window.location.href='{% url 'despachos' %}'">üì¶ Despachos</div>
            <div class="nav-item" onclick="window.location.href='{% url 'rutas' %}'">üó∫Ô∏è Rutas</div>
            <div class="nav-item active" onclick="window.location.href='{% url 'vehiculos' %}'">üöõ Veh√≠culos</div>
            <div class="nav-item" onclick="window.location.href='{% url 'aeronaves' %}'">‚úàÔ∏è Aeronaves</div>
            <div class="nav-item" onclick="window.location.href='{% url 'conductores' %}'">üë®‚Äçüíº Conductores</div>
            <div class="nav-item" onclick="window.location.href='{% url 'pilotos' %}'">üë®‚Äç‚úàÔ∏è Pilotos</div>
            <div class="nav-item" onclick="window.location.href='{% url 'clientes' %}'">üë• Clientes</div>
            <div class="nav-item" onclick="window.location.href='{% url 'cargas' %}'">üì¶ Cargas</div>
            <div class="nav-item" onclick="window.location.href='{% url 'seguros' %}'">üõ°Ô∏è Seguros</div>
            <div class="nav-item" onclick="window.location.href='{% url 'reportes' %}'">üìà Reportes</div>
            <div class="nav-item" onclick="window.location.href='{% url 'api' %}'">üîó API</div>
        </div>

        <!-- BLOQUE DE PERMISOS PARA NO-ADMIN -->
        {% if user.is_authenticated and user.perfilusuario.tipo_usuario != 'ADMIN' %}
        <style>
            #new-vehicle-btn,
            .btn[onclick*="crear"],
            .btn[onclick*="editar"],
            .btn[onclick*="eliminar"],
            .action-btn.delete,
            .btn-danger {
                display: none !important;
            }
        </style>
        
        <div style="background: rgba(59, 130, 246, 0.2); border: 1px solid #3b82f6; border-radius: 12px; padding: 1rem; margin-bottom: 1.5rem;">
            <div style="display: flex; align-items: center; gap: 0.5rem; color: #3b82f6;">
                <span>üîí</span>
                <div>
                    <strong>Modo Solo Lectura</strong>
                    <div style="font-size: 0.9rem; opacity: 0.9;">
                        Como {{ user.perfilusuario.tipo_usuario|title }}, solo puedes visualizar informaci√≥n de veh√≠culos.
                    </div>
                </div>
            </div>
        </div>
        {% endif %}

        <!-- Mensajes del sistema -->
        {% if messages %}
            {% for message in messages %}
            <div class="alert alert-{{ message.tags }}">
                {{ message }}
            </div>
            {% endfor %}
        {% endif %}

        <div class="page-title">
            <span>üöõ</span>
            <span>Gesti√≥n de Veh√≠culos</span>
        </div>

        <div class="filters">
            <div class="filter-group">
                <select class="filter-select" id="filter-status">
                    <option value="">Todos los estados</option>
                    <option value="active">Activo</option>
                    <option value="maintenance">En Mantenimiento</option>
                    <option value="inactive">Inactivo</option>
                </select>
                <select class="filter-select" id="filter-type">
                    <option value="">Todos los tipos</option>
                    <option value="camion">Cami√≥n</option>
                    <option value="furgon">Furg√≥n</option>
                    <option value="van">Van</option>
                </select>
            </div>
            <input type="text" class="search-input" id="search-input" placeholder="Buscar veh√≠culo...">
            <button class="btn" id="new-vehicle-btn" onclick="showNewVehicleModal()">‚ûï Nuevo Veh√≠culo</button>
        </div>

        <div class="table-container">
            <div class="table-header">
                <div class="table-title">Lista de Veh√≠culos</div>
                <div id="vehicle-count" style="color: var(--text-secondary); font-size: 0.9rem;">Cargando...</div>
            </div>
            <table class="table">
                <thead>
                    <tr>
                        <th>Patente</th>
                        <th>Modelo</th>
                        <th>Tipo</th>
                        <th>Capacidad</th>
                        <th>A√±o</th>
                        <th>Conductor Asignado</th>
                        <th>Estado</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody id="vehicle-table-body">
                    <tr>
                        <td colspan="8" class="loading">Cargando datos de veh√≠culos desde la base de datos...</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Modal para crear nuevo veh√≠culo -->
    <div id="newVehicleModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal('newVehicleModal')">&times;</span>
            <h3>Nuevo Veh√≠culo</h3>
            <form id="newVehicleForm">
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Patente</label>
                        <input type="text" class="form-input" name="patente" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Tipo de Veh√≠culo</label>
                        <select class="form-select" name="tipo_vehiculo" required>
                            <option value="">Seleccionar tipo</option>
                            <option value="Cami√≥n">Cami√≥n</option>
                            <option value="Furg√≥n">Furg√≥n</option>
                            <option value="Van">Van</option>
                            <option value="Trailer">Trailer</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Modelo</label>
                        <input type="text" class="form-input" name="modelo" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Capacidad (kg)</label>
                        <input type="number" class="form-input" name="capacidad_kg" required min="0">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">A√±o</label>
                        <input type="number" class="form-input" name="a√±o" required min="1900" max="2030">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Conductor Asignado</label>
                        <select class="form-select" name="conductor_asignado" id="conductor-select">
                            <option value="">Sin asignar</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        <input type="checkbox" name="activo" checked> Activo
                    </label>
                </div>
                
                <div style="margin-top: 2rem; display: flex; gap: 1rem; justify-content: flex-end;">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('newVehicleModal')">Cancelar</button>
                    <button type="submit" class="btn">Crear Veh√≠culo</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Variable global para almacenar los veh√≠culos
        let vehicleData = [];

        // Funci√≥n para cargar veh√≠culos desde la base de datos
        async function loadVehiclesFromDatabase() {
            try {
                showLoadingState();
                
                const response = await fetch('/api/vehiculos/', {
                    headers: {
                        'Accept': 'application/json',
                        'X-Requested-With': 'XMLHttpRequest'
                    }
                });

                if (!response.ok) {
                    throw new Error('Error al cargar los veh√≠culos');
                }
                
                vehicleData = await response.json();
                renderVehicleTable(vehicleData);
                showNotification('Datos de veh√≠culos cargados correctamente', 'success');
                
            } catch (error) {
                console.error('Error:', error);
                showErrorState('Error al cargar los veh√≠culos: ' + error.message);
            }
        }

        // Funci√≥n para mostrar estado de carga
        function showLoadingState() {
            const tableBody = document.getElementById('vehicle-table-body');
            tableBody.innerHTML = `
                <tr>
                    <td colspan="8" class="loading">Cargando datos de veh√≠culos desde la base de datos...</td>
                </tr>
            `;
            document.getElementById('vehicle-count').textContent = 'Cargando...';
        }

        // Funci√≥n para mostrar estado de error
        function showErrorState(message) {
            const tableBody = document.getElementById('vehicle-table-body');
            tableBody.innerHTML = `
                <tr>
                    <td colspan="8">
                        <div class="error">
                            ${message}
                            <br>
                            <button class="btn" onclick="loadVehiclesFromDatabase()" style="margin-top: 1rem;">
                                Reintentar
                            </button>
                        </div>
                    </td>
                </tr>
            `;
            document.getElementById('vehicle-count').textContent = 'Error';
        }

        // Funci√≥n para renderizar la tabla de veh√≠culos
        function renderVehicleTable(vehicles) {
            const tableBody = document.getElementById('vehicle-table-body');
            const vehicleCount = document.getElementById('vehicle-count');
            
            if (vehicles.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="8" class="loading">No se encontraron veh√≠culos en la base de datos</td>
                    </tr>
                `;
                vehicleCount.textContent = 'Total: 0 veh√≠culos';
                return;
            }
            
            tableBody.innerHTML = '';
            vehicleCount.textContent = `Total: ${vehicles.length} veh√≠culos`;
            
            vehicles.forEach(vehicle => {
                const row = document.createElement('tr');
                
                // Estado basado en el campo 'activo' (booleano)
                let statusClass = '';
                let statusText = '';
                
                if (vehicle.activo) {
                    statusClass = 'active';
                    statusText = 'Activo';
                } else {
                    statusClass = 'inactive';
                    statusText = 'Inactivo';
                }

                // Tipo basado en el campo 'tipo_vehiculo'
                let typeClass = '';
                let typeText = vehicle.tipo_vehiculo || 'N/A';
                
                // Mapear tipos a clases CSS existentes
                if (typeText.toLowerCase().includes('cami√≥n') || typeText.toLowerCase().includes('camion')) {
                    typeClass = 'camion';
                } else if (typeText.toLowerCase().includes('furg√≥n') || typeText.toLowerCase().includes('furgon')) {
                    typeClass = 'furgon';
                } else if (typeText.toLowerCase().includes('van')) {
                    typeClass = 'van';
                } else {
                    typeClass = 'camion'; // default
                }

                // Conductor asignado
                const driverName = vehicle.conductor_asignado ? 
                    (vehicle.conductor_asignado_nombre || vehicle.conductor_asignado.nombre || 'Asignado') : 
                    'Sin asignar';
                
                row.innerHTML = `
                    <td>${vehicle.patente || vehicle.id}</td>
                    <td>${vehicle.modelo || 'N/A'}</td>
                    <td><span class="badge ${typeClass}">${typeText}</span></td>
                    <td>${vehicle.capacidad_kg ? vehicle.capacidad_kg + ' kg' : 'N/A'}</td>
                    <td>${vehicle.a√±o || 'N/A'}</td>
                    <td>${driverName}</td>
                    <td><span class="badge ${statusClass}">${statusText}</span></td>
                    <td>
                        <button class="action-btn" onclick="viewVehicle('${vehicle.patente || vehicle.id}')">Ver</button>
                        <button class="action-btn" onclick="editVehicle(${vehicle.id})">Editar</button>
                        <button class="action-btn delete" onclick="deleteVehicle(${vehicle.id})">Eliminar</button>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
        }

        // Funci√≥n para filtrar veh√≠culos
        function filterVehicles() {
            const statusFilter = document.getElementById('filter-status').value;
            const typeFilter = document.getElementById('filter-type').value;
            const searchText = document.getElementById('search-input').value.toLowerCase();
            
            const filteredVehicles = vehicleData.filter(vehicle => {
                // Filtro por estado (usando campo 'activo' real)
                const matchesStatus = !statusFilter || 
                    (statusFilter === 'active' && vehicle.activo) ||
                    (statusFilter === 'inactive' && !vehicle.activo) ||
                    (statusFilter === 'maintenance' && !vehicle.activo);
                
                // Filtro por tipo (usando campo 'tipo_vehiculo' real)
                const matchesType = !typeFilter || 
                    (typeFilter === 'camion' && vehicle.tipo_vehiculo && vehicle.tipo_vehiculo.toLowerCase().includes('camion')) ||
                    (typeFilter === 'furgon' && vehicle.tipo_vehiculo && vehicle.tipo_vehiculo.toLowerCase().includes('furgon')) ||
                    (typeFilter === 'van' && vehicle.tipo_vehiculo && vehicle.tipo_vehiculo.toLowerCase().includes('van'));
                
                // Filtro por b√∫squeda
                const matchesSearch = !searchText || 
                    (vehicle.patente && vehicle.patente.toLowerCase().includes(searchText)) ||
                    (vehicle.modelo && vehicle.modelo.toLowerCase().includes(searchText)) ||
                    (vehicle.conductor_asignado_nombre && vehicle.conductor_asignado_nombre.toLowerCase().includes(searchText));
                
                return matchesStatus && matchesType && matchesSearch;
            });
            
            renderVehicleTable(filteredVehicles);
        }

        // Funciones de acci√≥n para los veh√≠culos
        async function viewVehicle(vehicleId) {
            try {
                const response = await fetch(`/api/vehiculos/${vehicleId}/`);
                const vehicleDetails = await response.json();
                
                showNotification(`Viendo detalles del veh√≠culo ${vehicleId}`, 'info');
                console.log('Detalles del veh√≠culo:', vehicleDetails);
                
            } catch (error) {
                console.error('Error al obtener detalles:', error);
                showNotification('Error al cargar detalles del veh√≠culo', 'error');
            }
        }

        async function editVehicle(vehicleId) {
            showNotification(`Editando el veh√≠culo ${vehicleId}`, 'info');
            // Redirigir a p√°gina de edici√≥n
            window.location.href = `/vehiculos/${vehicleId}/editar/`;
        }

        async function deleteVehicle(vehicleId) {
            if (confirm(`¬øEst√° seguro de que desea eliminar el veh√≠culo ${vehicleId}? Esta acci√≥n no se puede deshacer.`)) {
                try {
                    showNotification('Eliminando veh√≠culo...', 'warning');
                    
                    const response = await fetch(`/api/vehiculos/${vehicleId}/`, {
                        method: 'DELETE',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-CSRFToken': getCSRFToken()
                        }
                    });
                    
                    if (response.ok) {
                        await loadVehiclesFromDatabase();
                        showNotification('Veh√≠culo eliminado exitosamente', 'success');
                    } else {
                        throw new Error('Error al eliminar el veh√≠culo');
                    }
                    
                } catch (error) {
                    console.error('Error:', error);
                    showNotification('Error al eliminar el veh√≠culo', 'error');
                }
            }
        }

        // Funciones para el modal de nuevo veh√≠culo
        async function showNewVehicleModal() {
            await loadConductoresForSelect();
            showModal('newVehicleModal');
        }

        async function loadConductoresForSelect() {
            try {
                const response = await fetch('/api/conductores/');
                if (response.ok) {
                    const conductores = await response.json();
                    const select = document.getElementById('conductor-select');
                    
                    // Limpiar opciones excepto la primera
                    while (select.children.length > 1) {
                        select.removeChild(select.lastChild);
                    }
                    
                    // Agregar conductores activos
                    conductores.forEach(conductor => {
                        if (conductor.activo) {
                            const option = document.createElement('option');
                            option.value = conductor.id;
                            option.textContent = `${conductor.nombre} (${conductor.licencia})`;
                            select.appendChild(option);
                        }
                    });
                }
            } catch (error) {
                console.error('Error al cargar conductores:', error);
            }
        }

        async function createVehicle(formData) {
            try {
                const response = await fetch('/api/vehiculos/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': getCSRFToken()
                    },
                    body: JSON.stringify(formData)
                });
                
                if (response.ok) {
                    const newVehicle = await response.json();
                    showNotification('Veh√≠culo creado exitosamente', 'success');
                    closeModal('newVehicleModal');
                    await loadVehiclesFromDatabase();
                    return newVehicle;
                } else {
                    const errorData = await response.json();
                    throw new Error(errorData.detail || 'Error al crear el veh√≠culo');
                }
            } catch (error) {
                console.error('Error:', error);
                showNotification('Error al crear el veh√≠culo: ' + error.message, 'error');
                throw error;
            }
        }

        function handleVehicleFormSubmit(e) {
            e.preventDefault();
            
            const formData = {
                patente: document.querySelector('input[name="patente"]').value,
                tipo_vehiculo: document.querySelector('select[name="tipo_vehiculo"]').value,
                modelo: document.querySelector('input[name="modelo"]').value,
                capacidad_kg: parseInt(document.querySelector('input[name="capacidad_kg"]').value),
                a√±o: parseInt(document.querySelector('input[name="a√±o"]').value),
                activo: document.querySelector('input[name="activo"]').checked,
                conductor_asignado: document.querySelector('select[name="conductor_asignado"]').value || null
            };
            
            createVehicle(formData);
        }

        // Funciones auxiliares para modals
        function showModal(modalId) {
            document.getElementById(modalId).style.display = 'block';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
            // Resetear formulario
            if (modalId === 'newVehicleModal') {
                document.getElementById('newVehicleForm').reset();
            }
        }

        // Funci√≥n auxiliar para obtener el token CSRF
        function getCSRFToken() {
            const name = 'csrftoken';
            let cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                const cookies = document.cookie.split(';');
                for (let i = 0; i < cookies.length; i++) {
                    const cookie = cookies[i].trim();
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }

        // Funci√≥n para mostrar notificaciones
        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            
            let backgroundColor = 'linear-gradient(135deg, #10b981, #059669)';
            let icon = '‚úì';
            
            if (type === 'error') {
                backgroundColor = 'linear-gradient(135deg, #ef4444, #dc2626)';
                icon = '‚ùå';
            } else if (type === 'warning') {
                backgroundColor = 'linear-gradient(135deg, #f59e0b, #d97706)';
                icon = '‚ö†Ô∏è';
            } else if (type === 'info') {
                backgroundColor = 'linear-gradient(135deg, #3b82f6, #1d4ed8)';
                icon = '‚ÑπÔ∏è';
            }
            
            notification.innerHTML = `<span style="margin-right: 8px;">${icon}</span>${message}`;
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${backgroundColor};
                color: white;
                padding: 1rem 2rem;
                border-radius: 12px;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
                z-index: 1000;
                animation: slideInRight 0.4s ease-out;
                font-weight: 600;
                display: flex;
                align-items: center;
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOutRight 0.4s ease-out';
                setTimeout(() => notification.remove(), 400);
            }, 4000);
        }

        // Inicializaci√≥n cuando se carga la p√°gina
        document.addEventListener('DOMContentLoaded', function() {
            loadVehiclesFromDatabase();
            
            document.getElementById('filter-status').addEventListener('change', filterVehicles);
            document.getElementById('filter-type').addEventListener('change', filterVehicles);
            document.getElementById('search-input').addEventListener('input', filterVehicles);
            
            // Actualizado para abrir el modal
            document.getElementById('new-vehicle-btn').addEventListener('click', showNewVehicleModal);
            
            // Agregar event listener para el formulario
            document.getElementById('newVehicleForm').addEventListener('submit', handleVehicleFormSubmit);
            
            console.log('üöõ M√≥dulo de Veh√≠culos cargado exitosamente');
        });

        // Estilos para las animaciones de notificaciones
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideInRight {
                from {
                    transform: translateX(400px);
                    opacity: 0;
                }
                to {
                    transform: translateX(0);
                    opacity: 1;
                }
            }
            @keyframes slideOutRight {
                from {
                    transform: translateX(0);
                    opacity: 1;
                }
                to {
                    transform: translateX(400px);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(style);

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            });
        }
    </script>
</body>
</html>
============================================================


===== vehiculo_confirm_delete.html =====
{% extends 'base.html' %}

{% block title %}Eliminar Veh√≠culo - Log√≠stica Global{% endblock %}

{% block content %}
<div class="page-title">
    <span>üóëÔ∏è</span>
    <span>Eliminar Veh√≠culo</span>
</div>

<div class="content-card">
    <div style="text-align: center; margin-bottom: 2rem;">
        <div style="font-size: 4rem; margin-bottom: 1rem;">‚ö†Ô∏è</div>
        <h2 style="margin-bottom: 1rem;">¬øEst√°s seguro de que deseas eliminar este veh√≠culo?</h2>
        <p style="color: var(--text-secondary); margin-bottom: 2rem;">
            Veh√≠culo: {{ vehiculo.patente }} - {{ vehiculo.modelo }}<br>
            Tipo: {{ vehiculo.tipo_vehiculo }}<br>
            Esta acci√≥n no se puede deshacer.
        </p>
    </div>

    <form method="post" style="text-align: center;">
        {% csrf_token %}
        <div class="action-buttons" style="justify-content: center;">
            <button type="submit" class="btn btn-danger">S√≠, eliminar</button>
            <a href="{% url 'vehiculos' %}" class="btn btn-secondary">Cancelar</a>
        </div>
    </form>
</div>
{% endblock %}
============================================================


===== vehiculo_detail.html =====
{% extends 'base.html' %}

{% block title %}Veh√≠culo {{ vehiculo.patente }} - Log√≠stica Global{% endblock %}

{% block content %}
<div class="page-title">
    <span>üöõ</span>
    <span>Veh√≠culo {{ vehiculo.patente }}</span>
</div>

<div class="content-card">
    <div class="detail-grid">
        <div class="detail-item">
            <div class="detail-label">Patente</div>
            <div class="detail-value">{{ vehiculo.patente }}</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Tipo de Veh√≠culo</div>
            <div class="detail-value">{{ vehiculo.tipo_vehiculo }}</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Modelo</div>
            <div class="detail-value">{{ vehiculo.modelo }}</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Capacidad</div>
            <div class="detail-value">{{ vehiculo.capacidad_kg }} kg</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">A√±o</div>
            <div class="detail-value">{{ vehiculo.a√±o }}</div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Conductor Asignado</div>
            <div class="detail-value">
                {% if vehiculo.conductor_asignado %}
                    {{ vehiculo.conductor_asignado.nombre }}
                {% else %}
                    <span style="color: var(--text-secondary);">Sin asignar</span>
                {% endif %}
            </div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Estado</div>
            <div class="detail-value">
                <span class="badge {% if vehiculo.activo %}active{% else %}alert{% endif %}">
                    {% if vehiculo.activo %}Activo{% else %}Inactivo{% endif %}
                </span>
            </div>
        </div>
        
        <div class="detail-item">
            <div class="detail-label">Despachos Asignados</div>
            <div class="detail-value">{{ vehiculo.despacho_set.count }}</div>
        </div>
    </div>

    <div class="action-buttons">
        <a href="{% url 'vehiculo_edit' vehiculo.pk %}" class="btn">Editar</a>
        <a href="{% url 'vehiculo_delete' vehiculo.pk %}" class="btn btn-danger">Eliminar</a>
        <a href="{% url 'vehiculos' %}" class="btn btn-secondary">Volver a la lista</a>
    </div>
</div>
{% endblock %}
============================================================


===== vehiculo_editar.html =====
{% extends 'base.html' %}

{% block title %}Editar Veh√≠culo - Log√≠stica Global{% endblock %}

{% block content %}
<div class="page-title">
    <span>üöõ</span>
    <span>Editar Veh√≠culo</span>
</div>

<div class="content-card">
    <form method="post">
        {% csrf_token %}
        
        <div class="form-row">
            <div class="form-group">
                <label class="form-label">Patente</label>
                <input type="text" class="form-input" name="patente" value="{{ vehiculo.patente }}" required>
            </div>
            <div class="form-group">
                <label class="form-label">Tipo de Veh√≠culo</label>
                <input type="text" class="form-input" name="tipo_vehiculo" value="{{ vehiculo.tipo_vehiculo }}" required>
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label class="form-label">Modelo</label>
                <input type="text" class="form-input" name="modelo" value="{{ vehiculo.modelo }}" required>
            </div>
            <div class="form-group">
                <label class="form-label">Capacidad (kg)</label>
                <input type="number" class="form-input" name="capacidad_kg" value="{{ vehiculo.capacidad_kg }}" required min="0">
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label class="form-label">A√±o</label>
                <input type="number" class="form-input" name="a√±o" value="{{ vehiculo.a√±o }}" required>
            </div>
            <div class="form-group">
                <label class="form-label">Conductor Asignado</label>
                <select class="form-select" name="conductor_asignado">
                    <option value="">Sin asignar</option>
                    {% for conductor in conductores %}
                    <option value="{{ conductor.id }}" {% if vehiculo.conductor_asignado and vehiculo.conductor_asignado.id == conductor.id %}selected{% endif %}>
                        {{ conductor.nombre }} ({{ conductor.licencia }})
                    </option>
                    {% endfor %}
                </select>
            </div>
        </div>

        <div class="form-group">
            <label class="form-label">
                <input type="checkbox" name="activo" {% if vehiculo.activo %}checked{% endif %}> Activo
            </label>
        </div>

        <div class="action-buttons">
            <button type="submit" class="btn btn-success">Actualizar Veh√≠culo</button>
            <a href="{% url 'vehiculos' %}" class="btn btn-secondary">Cancelar</a>
        </div>
    </form>
</div>
{% endblock %}
============================================================


===== vehiculo_form.html =====
{% extends 'base.html' %}

{% block title %}Nuevo Veh√≠culo - Log√≠stica Global{% endblock %}

{% block content %}
<div class="page-title">
    <span>üöõ</span>
    <span>Nuevo Veh√≠culo</span>
</div>

<div class="content-card">
    <form method="post">
        {% csrf_token %}
        
        <div class="form-group">
            <label class="form-label">Patente *</label>
            <input type="text" class="form-input" name="patente" required>
        </div>
        
        <div class="form-group">
            <label class="form-label">Tipo de Veh√≠culo *</label>
            <select class="form-select" name="tipo_vehiculo" required>
                <option value="">Seleccionar tipo</option>
                <option value="Cami√≥n">Cami√≥n</option>
                <option value="Furg√≥n">Furg√≥n</option>
                <option value="Van">Van</option>
                <option value="Trailer">Trailer</option>
            </select>
        </div>
        
        <div class="form-group">
            <label class="form-label">Modelo *</label>
            <input type="text" class="form-input" name="modelo" required>
        </div>
        
        <div class="form-group">
            <label class="form-label">Capacidad (kg) *</label>
            <input type="number" class="form-input" name="capacidad_kg" required min="0">
        </div>
        
        <div class="form-group">
            <label class="form-label">A√±o *</label>
            <input type="number" class="form-input" name="a√±o" required min="1900" max="2030">
        </div>
        
        <div class="form-group">
            <label class="form-label">Conductor Asignado</label>
            <select class="form-select" name="conductor_asignado">
                <option value="">Sin asignar</option>
                {% for conductor in conductores %}
                <option value="{{ conductor.id }}">{{ conductor.nombre }} ({{ conductor.licencia }})</option>
                {% endfor %}
            </select>
        </div>
        
        <div class="form-group">
            <label class="form-label">
                <input type="checkbox" name="activo" checked> Activo
            </label>
        </div>
        
        <div class="action-buttons">
            <button type="submit" class="btn">Crear Veh√≠culo</button>
            <a href="{% url 'vehiculos' %}" class="btn btn-secondary">Cancelar</a>
        </div>
    </form>
</div>
{% endblock %}
============================================================
